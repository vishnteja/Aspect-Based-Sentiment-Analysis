cuda memory allocated: 4029440
n_trainable_params: 563003, n_nontrainable_params: 441200
> training arguments:
>>> model_name: gc_ian
>>> model_ver: 3
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x000001C6516B76A8>
>>> learning_rate: 0.005
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 100
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> embeddings: d
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 0
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 50
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./embeddings/glove.840B.300d.txt
>>> embedding_matrix_path: gen_data/embeddings/100_restaurant_domain_embedding_matrix.dat
>>> model_class: <class 'models.gc_ian.GC_IAN3'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.0411, acc: 0.4813
loss: 0.9886, acc: 0.5437
loss: 0.9765, acc: 0.5479
loss: 0.9604, acc: 0.5656
loss: 0.9386, acc: 0.5813
loss: 0.9248, acc: 0.5844
loss: 0.9149, acc: 0.5902
loss: 0.9112, acc: 0.5953
loss: 0.9035, acc: 0.6049
loss: 0.8939, acc: 0.6088
loss: 0.8909, acc: 0.6097
loss: 0.8913, acc: 0.6073
loss: 0.8815, acc: 0.6144
loss: 0.8794, acc: 0.6116
loss: 0.8736, acc: 0.6138
loss: 0.8636, acc: 0.6191
loss: 0.8579, acc: 0.6202
loss: 0.8519, acc: 0.6253
loss: 0.8524, acc: 0.6250
loss: 0.8477, acc: 0.6256
loss: 0.8454, acc: 0.6265
loss: 0.8421, acc: 0.6273
> val_acc: 0.7179, val_f1: 0.4738
>> saved: state_dict/gc_ian_restaurant_val_acc0.7179
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.7127, acc: 0.7344
loss: 0.7026, acc: 0.7143
loss: 0.7301, acc: 0.6823
loss: 0.7059, acc: 0.6949
loss: 0.7013, acc: 0.7017
loss: 0.7013, acc: 0.7049
loss: 0.7039, acc: 0.7080
loss: 0.7068, acc: 0.7052
loss: 0.7082, acc: 0.7031
loss: 0.7053, acc: 0.7035
loss: 0.7049, acc: 0.7037
loss: 0.7097, acc: 0.7001
loss: 0.7112, acc: 0.7021
loss: 0.7122, acc: 0.7006
loss: 0.7088, acc: 0.7036
loss: 0.7054, acc: 0.7058
loss: 0.7061, acc: 0.7066
loss: 0.7064, acc: 0.7062
loss: 0.7068, acc: 0.7086
loss: 0.6992, acc: 0.7130
loss: 0.6967, acc: 0.7142
loss: 0.6956, acc: 0.7152
loss: 0.6948, acc: 0.7165
> val_acc: 0.7455, val_f1: 0.5499
>> saved: state_dict/gc_ian_restaurant_val_acc0.7455
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.6302, acc: 0.7500
loss: 0.6210, acc: 0.7604
loss: 0.6255, acc: 0.7634
loss: 0.6348, acc: 0.7599
loss: 0.6193, acc: 0.7669
loss: 0.6179, acc: 0.7608
loss: 0.6160, acc: 0.7665
loss: 0.6135, acc: 0.7692
loss: 0.6227, acc: 0.7670
loss: 0.6262, acc: 0.7628
loss: 0.6299, acc: 0.7598
loss: 0.6260, acc: 0.7574
loss: 0.6233, acc: 0.7593
loss: 0.6284, acc: 0.7550
loss: 0.6328, acc: 0.7500
loss: 0.6307, acc: 0.7508
loss: 0.6311, acc: 0.7504
loss: 0.6303, acc: 0.7521
loss: 0.6304, acc: 0.7523
loss: 0.6283, acc: 0.7541
loss: 0.6266, acc: 0.7533
loss: 0.6292, acc: 0.7523
> val_acc: 0.7580, val_f1: 0.5676
>> saved: state_dict/gc_ian_restaurant_val_acc0.758
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.3722, acc: 0.9062
loss: 0.4769, acc: 0.8385
loss: 0.5116, acc: 0.8239
loss: 0.5349, acc: 0.8027
loss: 0.5467, acc: 0.7976
loss: 0.5578, acc: 0.7837
loss: 0.5659, acc: 0.7782
loss: 0.5804, acc: 0.7691
loss: 0.5764, acc: 0.7774
loss: 0.5737, acc: 0.7833
loss: 0.5744, acc: 0.7800
loss: 0.5773, acc: 0.7790
loss: 0.5815, acc: 0.7751
loss: 0.5797, acc: 0.7741
loss: 0.5742, acc: 0.7773
loss: 0.5761, acc: 0.7767
loss: 0.5778, acc: 0.7758
loss: 0.5783, acc: 0.7747
loss: 0.5803, acc: 0.7740
loss: 0.5797, acc: 0.7747
loss: 0.5836, acc: 0.7732
loss: 0.5826, acc: 0.7733
loss: 0.5805, acc: 0.7742
> val_acc: 0.7786, val_f1: 0.6196
>> saved: state_dict/gc_ian_restaurant_val_acc0.7786
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.4899, acc: 0.8333
loss: 0.4713, acc: 0.8477
loss: 0.5185, acc: 0.8077
loss: 0.5215, acc: 0.8090
loss: 0.5332, acc: 0.8030
loss: 0.5473, acc: 0.7924
loss: 0.5531, acc: 0.7869
loss: 0.5562, acc: 0.7911
loss: 0.5559, acc: 0.7914
loss: 0.5534, acc: 0.7923
loss: 0.5519, acc: 0.7930
loss: 0.5536, acc: 0.7920
loss: 0.5529, acc: 0.7937
loss: 0.5525, acc: 0.7960
loss: 0.5471, acc: 0.7988
loss: 0.5528, acc: 0.7933
loss: 0.5556, acc: 0.7914
loss: 0.5539, acc: 0.7926
loss: 0.5549, acc: 0.7923
loss: 0.5554, acc: 0.7915
loss: 0.5537, acc: 0.7919
loss: 0.5550, acc: 0.7888
loss: 0.5559, acc: 0.7869
> val_acc: 0.7777, val_f1: 0.6182
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.5115, acc: 0.7875
loss: 0.5307, acc: 0.7812
loss: 0.5072, acc: 0.8063
loss: 0.5143, acc: 0.7953
loss: 0.5216, acc: 0.7950
loss: 0.5221, acc: 0.7979
loss: 0.5276, acc: 0.7955
loss: 0.5364, acc: 0.7875
loss: 0.5493, acc: 0.7799
loss: 0.5470, acc: 0.7825
loss: 0.5482, acc: 0.7824
loss: 0.5458, acc: 0.7839
loss: 0.5426, acc: 0.7885
loss: 0.5393, acc: 0.7897
loss: 0.5417, acc: 0.7892
loss: 0.5380, acc: 0.7914
loss: 0.5405, acc: 0.7890
loss: 0.5375, acc: 0.7889
loss: 0.5386, acc: 0.7898
loss: 0.5376, acc: 0.7900
loss: 0.5370, acc: 0.7896
loss: 0.5365, acc: 0.7895
> val_acc: 0.7830, val_f1: 0.6341
>> saved: state_dict/gc_ian_restaurant_val_acc0.783
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.4140, acc: 0.8281
loss: 0.4907, acc: 0.7946
loss: 0.5131, acc: 0.8047
loss: 0.4982, acc: 0.8143
loss: 0.5192, acc: 0.8054
loss: 0.5274, acc: 0.8032
loss: 0.5345, acc: 0.7949
loss: 0.5401, acc: 0.7905
loss: 0.5300, acc: 0.7984
loss: 0.5347, acc: 0.7952
loss: 0.5322, acc: 0.7993
loss: 0.5362, acc: 0.7966
loss: 0.5347, acc: 0.7959
loss: 0.5347, acc: 0.7952
loss: 0.5305, acc: 0.7986
loss: 0.5264, acc: 0.7999
loss: 0.5316, acc: 0.7976
loss: 0.5257, acc: 0.7999
loss: 0.5225, acc: 0.8010
loss: 0.5210, acc: 0.8015
loss: 0.5224, acc: 0.7993
loss: 0.5206, acc: 0.8002
loss: 0.5193, acc: 0.8030
> val_acc: 0.7848, val_f1: 0.6376
>> saved: state_dict/gc_ian_restaurant_val_acc0.7848
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.4233, acc: 0.8750
loss: 0.3952, acc: 0.8819
loss: 0.4537, acc: 0.8415
loss: 0.4513, acc: 0.8372
loss: 0.4834, acc: 0.8203
loss: 0.4937, acc: 0.8157
loss: 0.4873, acc: 0.8180
loss: 0.4980, acc: 0.8133
loss: 0.5075, acc: 0.8089
loss: 0.5083, acc: 0.8106
loss: 0.5127, acc: 0.8032
loss: 0.5096, acc: 0.8035
loss: 0.5108, acc: 0.8037
loss: 0.5166, acc: 0.8007
loss: 0.5191, acc: 0.8003
loss: 0.5179, acc: 0.7994
loss: 0.5152, acc: 0.8025
loss: 0.5139, acc: 0.8023
loss: 0.5125, acc: 0.8022
loss: 0.5077, acc: 0.8052
loss: 0.5081, acc: 0.8047
loss: 0.5047, acc: 0.8071
> val_acc: 0.7866, val_f1: 0.6392
>> saved: state_dict/gc_ian_restaurant_val_acc0.7866
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.5389, acc: 0.7188
loss: 0.4667, acc: 0.8281
loss: 0.5035, acc: 0.8210
loss: 0.4794, acc: 0.8262
loss: 0.4704, acc: 0.8318
loss: 0.4783, acc: 0.8197
loss: 0.4784, acc: 0.8216
loss: 0.4680, acc: 0.8247
loss: 0.4610, acc: 0.8300
loss: 0.4660, acc: 0.8261
loss: 0.4713, acc: 0.8248
loss: 0.4760, acc: 0.8214
loss: 0.4817, acc: 0.8192
loss: 0.4830, acc: 0.8182
loss: 0.4819, acc: 0.8191
loss: 0.4835, acc: 0.8170
loss: 0.4807, acc: 0.8206
loss: 0.4827, acc: 0.8198
loss: 0.4888, acc: 0.8146
loss: 0.4912, acc: 0.8138
loss: 0.4918, acc: 0.8137
loss: 0.4907, acc: 0.8140
loss: 0.4895, acc: 0.8142
> val_acc: 0.7920, val_f1: 0.6520
>> saved: state_dict/gc_ian_restaurant_val_acc0.792
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.4867, acc: 0.7917
loss: 0.4342, acc: 0.8438
loss: 0.4675, acc: 0.8293
loss: 0.4635, acc: 0.8316
loss: 0.4627, acc: 0.8315
loss: 0.4612, acc: 0.8304
loss: 0.4601, acc: 0.8333
loss: 0.4758, acc: 0.8215
loss: 0.4752, acc: 0.8234
loss: 0.4795, acc: 0.8216
loss: 0.4787, acc: 0.8243
loss: 0.4857, acc: 0.8190
loss: 0.4846, acc: 0.8189
loss: 0.4798, acc: 0.8199
loss: 0.4825, acc: 0.8176
loss: 0.4853, acc: 0.8145
loss: 0.4790, acc: 0.8181
loss: 0.4762, acc: 0.8207
loss: 0.4765, acc: 0.8185
loss: 0.4787, acc: 0.8176
loss: 0.4751, acc: 0.8192
loss: 0.4751, acc: 0.8192
loss: 0.4746, acc: 0.8201
> val_acc: 0.7839, val_f1: 0.6348
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.4705, acc: 0.8250
loss: 0.4608, acc: 0.8313
loss: 0.4472, acc: 0.8438
loss: 0.4548, acc: 0.8375
loss: 0.4638, acc: 0.8337
loss: 0.4589, acc: 0.8365
loss: 0.4576, acc: 0.8384
loss: 0.4492, acc: 0.8438
loss: 0.4487, acc: 0.8424
loss: 0.4567, acc: 0.8375
loss: 0.4544, acc: 0.8375
loss: 0.4544, acc: 0.8385
loss: 0.4573, acc: 0.8370
loss: 0.4618, acc: 0.8344
loss: 0.4630, acc: 0.8317
loss: 0.4667, acc: 0.8309
loss: 0.4625, acc: 0.8335
loss: 0.4620, acc: 0.8337
loss: 0.4601, acc: 0.8339
loss: 0.4593, acc: 0.8334
loss: 0.4615, acc: 0.8310
loss: 0.4599, acc: 0.8324
> val_acc: 0.7875, val_f1: 0.6451
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.4757, acc: 0.7969
loss: 0.4825, acc: 0.7991
loss: 0.4695, acc: 0.8307
loss: 0.4660, acc: 0.8290
loss: 0.4497, acc: 0.8324
loss: 0.4353, acc: 0.8449
loss: 0.4543, acc: 0.8389
loss: 0.4541, acc: 0.8370
loss: 0.4506, acc: 0.8400
loss: 0.4543, acc: 0.8351
loss: 0.4572, acc: 0.8311
loss: 0.4570, acc: 0.8295
loss: 0.4666, acc: 0.8266
loss: 0.4677, acc: 0.8251
loss: 0.4670, acc: 0.8277
loss: 0.4635, acc: 0.8287
loss: 0.4651, acc: 0.8293
loss: 0.4634, acc: 0.8301
loss: 0.4593, acc: 0.8319
loss: 0.4587, acc: 0.8312
loss: 0.4586, acc: 0.8312
loss: 0.4569, acc: 0.8306
loss: 0.4577, acc: 0.8306
> val_acc: 0.7929, val_f1: 0.6591
>> saved: state_dict/gc_ian_restaurant_val_acc0.7929
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.4517, acc: 0.8438
loss: 0.4797, acc: 0.8125
loss: 0.4603, acc: 0.8192
loss: 0.4459, acc: 0.8257
loss: 0.4635, acc: 0.8177
loss: 0.4513, acc: 0.8287
loss: 0.4575, acc: 0.8263
loss: 0.4531, acc: 0.8309
loss: 0.4557, acc: 0.8317
loss: 0.4553, acc: 0.8329
loss: 0.4554, acc: 0.8287
loss: 0.4523, acc: 0.8279
loss: 0.4537, acc: 0.8286
loss: 0.4491, acc: 0.8329
loss: 0.4454, acc: 0.8340
loss: 0.4481, acc: 0.8311
loss: 0.4510, acc: 0.8289
loss: 0.4481, acc: 0.8308
loss: 0.4475, acc: 0.8318
loss: 0.4466, acc: 0.8324
loss: 0.4479, acc: 0.8326
loss: 0.4438, acc: 0.8343
> val_acc: 0.7920, val_f1: 0.6537
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.3199, acc: 0.8750
loss: 0.4682, acc: 0.8073
loss: 0.4184, acc: 0.8438
loss: 0.4273, acc: 0.8379
loss: 0.4305, acc: 0.8423
loss: 0.4318, acc: 0.8413
loss: 0.4416, acc: 0.8387
loss: 0.4370, acc: 0.8438
loss: 0.4340, acc: 0.8468
loss: 0.4309, acc: 0.8485
loss: 0.4363, acc: 0.8462
loss: 0.4280, acc: 0.8493
loss: 0.4332, acc: 0.8463
loss: 0.4362, acc: 0.8456
loss: 0.4330, acc: 0.8451
loss: 0.4380, acc: 0.8433
loss: 0.4346, acc: 0.8449
loss: 0.4369, acc: 0.8445
loss: 0.4375, acc: 0.8444
loss: 0.4336, acc: 0.8457
loss: 0.4290, acc: 0.8487
loss: 0.4273, acc: 0.8494
loss: 0.4270, acc: 0.8488
> val_acc: 0.7902, val_f1: 0.6560
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.3562, acc: 0.8750
loss: 0.4219, acc: 0.8398
loss: 0.4097, acc: 0.8582
loss: 0.4103, acc: 0.8594
loss: 0.4147, acc: 0.8546
loss: 0.4120, acc: 0.8527
loss: 0.4146, acc: 0.8494
loss: 0.4198, acc: 0.8470
loss: 0.4116, acc: 0.8488
loss: 0.4129, acc: 0.8522
loss: 0.4176, acc: 0.8467
loss: 0.4178, acc: 0.8481
loss: 0.4226, acc: 0.8452
loss: 0.4281, acc: 0.8415
loss: 0.4268, acc: 0.8433
loss: 0.4254, acc: 0.8450
loss: 0.4231, acc: 0.8460
loss: 0.4241, acc: 0.8469
loss: 0.4197, acc: 0.8488
loss: 0.4247, acc: 0.8466
loss: 0.4243, acc: 0.8474
loss: 0.4236, acc: 0.8478
loss: 0.4248, acc: 0.8456
> val_acc: 0.7929, val_f1: 0.6591
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.4306, acc: 0.8375
loss: 0.3996, acc: 0.8625
loss: 0.4229, acc: 0.8521
loss: 0.4359, acc: 0.8438
loss: 0.4375, acc: 0.8488
loss: 0.4212, acc: 0.8521
loss: 0.4246, acc: 0.8500
loss: 0.4277, acc: 0.8477
loss: 0.4260, acc: 0.8479
loss: 0.4274, acc: 0.8481
loss: 0.4210, acc: 0.8523
loss: 0.4261, acc: 0.8495
loss: 0.4237, acc: 0.8486
loss: 0.4221, acc: 0.8504
loss: 0.4257, acc: 0.8496
loss: 0.4255, acc: 0.8492
loss: 0.4203, acc: 0.8504
loss: 0.4213, acc: 0.8497
loss: 0.4201, acc: 0.8484
loss: 0.4206, acc: 0.8478
loss: 0.4201, acc: 0.8482
loss: 0.4187, acc: 0.8483
> val_acc: 0.7920, val_f1: 0.6585
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.4317, acc: 0.8281
loss: 0.3703, acc: 0.8705
loss: 0.3914, acc: 0.8542
loss: 0.3881, acc: 0.8658
loss: 0.4043, acc: 0.8523
loss: 0.4053, acc: 0.8530
loss: 0.4000, acc: 0.8555
loss: 0.4029, acc: 0.8564
loss: 0.4014, acc: 0.8549
loss: 0.4013, acc: 0.8517
loss: 0.4030, acc: 0.8528
loss: 0.4093, acc: 0.8498
loss: 0.4021, acc: 0.8533
loss: 0.4049, acc: 0.8517
loss: 0.4084, acc: 0.8498
loss: 0.4162, acc: 0.8454
loss: 0.4156, acc: 0.8457
loss: 0.4135, acc: 0.8452
loss: 0.4124, acc: 0.8458
loss: 0.4106, acc: 0.8457
loss: 0.4140, acc: 0.8441
loss: 0.4112, acc: 0.8461
loss: 0.4096, acc: 0.8471
> val_acc: 0.8000, val_f1: 0.6705
>> saved: state_dict/gc_ian_restaurant_val_acc0.8
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 0.4385, acc: 0.8359
loss: 0.4102, acc: 0.8542
loss: 0.3887, acc: 0.8638
loss: 0.3837, acc: 0.8684
loss: 0.3855, acc: 0.8672
loss: 0.3952, acc: 0.8621
loss: 0.4049, acc: 0.8566
loss: 0.4049, acc: 0.8558
loss: 0.4076, acc: 0.8537
loss: 0.4103, acc: 0.8501
loss: 0.4068, acc: 0.8530
loss: 0.4062, acc: 0.8538
loss: 0.4067, acc: 0.8530
loss: 0.4028, acc: 0.8528
loss: 0.4001, acc: 0.8573
loss: 0.3985, acc: 0.8580
loss: 0.3975, acc: 0.8590
loss: 0.4007, acc: 0.8557
loss: 0.4021, acc: 0.8554
loss: 0.4027, acc: 0.8561
loss: 0.4025, acc: 0.8558
loss: 0.4008, acc: 0.8564
> val_acc: 0.7955, val_f1: 0.6641
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
loss: 0.4101, acc: 0.8438
loss: 0.3540, acc: 0.8906
loss: 0.3970, acc: 0.8551
loss: 0.4198, acc: 0.8281
loss: 0.4109, acc: 0.8363
loss: 0.3990, acc: 0.8413
loss: 0.3907, acc: 0.8508
loss: 0.3795, acc: 0.8576
loss: 0.3847, acc: 0.8521
loss: 0.3912, acc: 0.8533
loss: 0.3808, acc: 0.8597
loss: 0.3768, acc: 0.8627
loss: 0.3807, acc: 0.8607
loss: 0.3844, acc: 0.8584
loss: 0.3843, acc: 0.8570
loss: 0.3847, acc: 0.8544
loss: 0.3861, acc: 0.8569
loss: 0.3869, acc: 0.8568
loss: 0.3848, acc: 0.8585
loss: 0.3895, acc: 0.8564
loss: 0.3868, acc: 0.8589
loss: 0.3902, acc: 0.8573
loss: 0.3915, acc: 0.8567
> val_acc: 0.7929, val_f1: 0.6551
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
loss: 0.3276, acc: 0.9271
loss: 0.3451, acc: 0.8789
loss: 0.3545, acc: 0.8774
loss: 0.3364, acc: 0.8906
loss: 0.3451, acc: 0.8913
loss: 0.3654, acc: 0.8761
loss: 0.3779, acc: 0.8646
loss: 0.3759, acc: 0.8668
loss: 0.3795, acc: 0.8648
loss: 0.3791, acc: 0.8659
loss: 0.3785, acc: 0.8673
loss: 0.3825, acc: 0.8658
loss: 0.3870, acc: 0.8631
loss: 0.3900, acc: 0.8598
loss: 0.3913, acc: 0.8604
loss: 0.3899, acc: 0.8622
loss: 0.3937, acc: 0.8603
loss: 0.3914, acc: 0.8612
loss: 0.3920, acc: 0.8612
loss: 0.3904, acc: 0.8619
loss: 0.3891, acc: 0.8623
loss: 0.3879, acc: 0.8623
loss: 0.3908, acc: 0.8609
> val_acc: 0.7920, val_f1: 0.6520
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 20
loss: 0.3974, acc: 0.8625
loss: 0.3628, acc: 0.8656
loss: 0.3780, acc: 0.8521
loss: 0.3906, acc: 0.8500
loss: 0.3913, acc: 0.8550
loss: 0.4019, acc: 0.8552
loss: 0.3845, acc: 0.8652
loss: 0.3773, acc: 0.8703
loss: 0.3820, acc: 0.8660
loss: 0.3847, acc: 0.8644
loss: 0.3809, acc: 0.8648
loss: 0.3844, acc: 0.8625
loss: 0.3844, acc: 0.8635
loss: 0.3861, acc: 0.8629
loss: 0.3836, acc: 0.8642
loss: 0.3864, acc: 0.8617
loss: 0.3831, acc: 0.8640
loss: 0.3814, acc: 0.8649
loss: 0.3786, acc: 0.8661
loss: 0.3775, acc: 0.8678
loss: 0.3806, acc: 0.8670
loss: 0.3784, acc: 0.8693
> val_acc: 0.7973, val_f1: 0.6713
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 21
loss: 0.2325, acc: 0.9688
loss: 0.3657, acc: 0.8884
loss: 0.3597, acc: 0.8802
loss: 0.3839, acc: 0.8695
loss: 0.3940, acc: 0.8636
loss: 0.3822, acc: 0.8681
loss: 0.3882, acc: 0.8662
loss: 0.3925, acc: 0.8606
loss: 0.3866, acc: 0.8653
loss: 0.3830, acc: 0.8664
loss: 0.3774, acc: 0.8678
loss: 0.3807, acc: 0.8657
loss: 0.3762, acc: 0.8695
loss: 0.3754, acc: 0.8703
loss: 0.3752, acc: 0.8698
loss: 0.3763, acc: 0.8681
loss: 0.3779, acc: 0.8678
loss: 0.3776, acc: 0.8678
loss: 0.3771, acc: 0.8689
loss: 0.3759, acc: 0.8702
loss: 0.3736, acc: 0.8710
loss: 0.3747, acc: 0.8703
loss: 0.3749, acc: 0.8705
> val_acc: 0.7973, val_f1: 0.6722
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 22
loss: 0.3075, acc: 0.9062
loss: 0.3819, acc: 0.8646
loss: 0.3719, acc: 0.8705
loss: 0.3638, acc: 0.8783
loss: 0.3686, acc: 0.8789
loss: 0.3766, acc: 0.8685
loss: 0.3725, acc: 0.8695
loss: 0.3649, acc: 0.8734
loss: 0.3631, acc: 0.8750
loss: 0.3690, acc: 0.8699
loss: 0.3687, acc: 0.8681
loss: 0.3722, acc: 0.8676
loss: 0.3729, acc: 0.8652
loss: 0.3751, acc: 0.8641
loss: 0.3730, acc: 0.8644
loss: 0.3733, acc: 0.8631
loss: 0.3727, acc: 0.8638
loss: 0.3741, acc: 0.8624
loss: 0.3769, acc: 0.8610
loss: 0.3769, acc: 0.8605
loss: 0.3750, acc: 0.8627
loss: 0.3727, acc: 0.8638
> val_acc: 0.8000, val_f1: 0.6772
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 23
loss: 0.3017, acc: 0.8750
loss: 0.3495, acc: 0.8854
loss: 0.3340, acc: 0.8949
loss: 0.3361, acc: 0.8887
loss: 0.3445, acc: 0.8810
loss: 0.3462, acc: 0.8810
loss: 0.3474, acc: 0.8841
loss: 0.3440, acc: 0.8889
loss: 0.3429, acc: 0.8857
loss: 0.3440, acc: 0.8852
loss: 0.3512, acc: 0.8817
loss: 0.3541, acc: 0.8778
loss: 0.3533, acc: 0.8776
loss: 0.3578, acc: 0.8741
loss: 0.3614, acc: 0.8710
loss: 0.3616, acc: 0.8697
loss: 0.3626, acc: 0.8684
loss: 0.3604, acc: 0.8703
loss: 0.3636, acc: 0.8685
loss: 0.3621, acc: 0.8698
loss: 0.3632, acc: 0.8700
loss: 0.3657, acc: 0.8679
loss: 0.3687, acc: 0.8668
> val_acc: 0.7982, val_f1: 0.6745
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 24
loss: 0.3380, acc: 0.8854
loss: 0.3183, acc: 0.8984
loss: 0.3485, acc: 0.8918
loss: 0.3437, acc: 0.8958
loss: 0.3376, acc: 0.8981
loss: 0.3466, acc: 0.8906
loss: 0.3449, acc: 0.8873
loss: 0.3458, acc: 0.8865
loss: 0.3511, acc: 0.8823
loss: 0.3510, acc: 0.8841
loss: 0.3497, acc: 0.8827
loss: 0.3457, acc: 0.8858
loss: 0.3480, acc: 0.8854
loss: 0.3478, acc: 0.8869
loss: 0.3477, acc: 0.8874
loss: 0.3513, acc: 0.8842
loss: 0.3539, acc: 0.8822
loss: 0.3574, acc: 0.8796
loss: 0.3609, acc: 0.8807
loss: 0.3625, acc: 0.8791
loss: 0.3594, acc: 0.8805
loss: 0.3619, acc: 0.8785
loss: 0.3653, acc: 0.8778
> val_acc: 0.7982, val_f1: 0.6764
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 25
loss: 0.3494, acc: 0.8625
loss: 0.3587, acc: 0.8750
loss: 0.3708, acc: 0.8688
loss: 0.3706, acc: 0.8641
loss: 0.3575, acc: 0.8738
loss: 0.3529, acc: 0.8771
loss: 0.3568, acc: 0.8759
loss: 0.3511, acc: 0.8781
loss: 0.3491, acc: 0.8799
loss: 0.3491, acc: 0.8812
loss: 0.3457, acc: 0.8824
loss: 0.3426, acc: 0.8812
loss: 0.3415, acc: 0.8808
loss: 0.3427, acc: 0.8786
loss: 0.3421, acc: 0.8792
loss: 0.3438, acc: 0.8781
loss: 0.3490, acc: 0.8750
loss: 0.3471, acc: 0.8760
loss: 0.3482, acc: 0.8753
loss: 0.3481, acc: 0.8747
loss: 0.3489, acc: 0.8738
loss: 0.3504, acc: 0.8724
> val_acc: 0.7982, val_f1: 0.6745
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 26
loss: 0.4246, acc: 0.8125
loss: 0.3955, acc: 0.8438
loss: 0.3622, acc: 0.8542
loss: 0.3414, acc: 0.8695
loss: 0.3460, acc: 0.8707
loss: 0.3449, acc: 0.8727
loss: 0.3402, acc: 0.8799
loss: 0.3570, acc: 0.8716
loss: 0.3507, acc: 0.8772
loss: 0.3514, acc: 0.8777
loss: 0.3525, acc: 0.8786
loss: 0.3574, acc: 0.8739
loss: 0.3595, acc: 0.8720
loss: 0.3600, acc: 0.8717
loss: 0.3610, acc: 0.8702
loss: 0.3656, acc: 0.8681
loss: 0.3624, acc: 0.8689
loss: 0.3647, acc: 0.8693
loss: 0.3618, acc: 0.8713
loss: 0.3620, acc: 0.8702
loss: 0.3607, acc: 0.8713
loss: 0.3590, acc: 0.8718
loss: 0.3595, acc: 0.8722
> val_acc: 0.7991, val_f1: 0.6763
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 27
loss: 0.3411, acc: 0.8828
loss: 0.3422, acc: 0.8785
loss: 0.3554, acc: 0.8750
loss: 0.3674, acc: 0.8701
loss: 0.3895, acc: 0.8568
loss: 0.3894, acc: 0.8599
loss: 0.3798, acc: 0.8658
loss: 0.3822, acc: 0.8638
loss: 0.3818, acc: 0.8608
loss: 0.3704, acc: 0.8667
loss: 0.3693, acc: 0.8657
loss: 0.3669, acc: 0.8655
loss: 0.3665, acc: 0.8682
loss: 0.3619, acc: 0.8714
loss: 0.3594, acc: 0.8720
loss: 0.3595, acc: 0.8726
loss: 0.3599, acc: 0.8728
loss: 0.3550, acc: 0.8754
loss: 0.3530, acc: 0.8767
loss: 0.3497, acc: 0.8769
loss: 0.3478, acc: 0.8774
loss: 0.3481, acc: 0.8759
> val_acc: 0.8009, val_f1: 0.6772
>> saved: state_dict/gc_ian_restaurant_val_acc0.8009
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 28
loss: 0.2448, acc: 0.9688
loss: 0.3295, acc: 0.8750
loss: 0.3383, acc: 0.8778
loss: 0.3451, acc: 0.8691
loss: 0.3524, acc: 0.8750
loss: 0.3489, acc: 0.8726
loss: 0.3566, acc: 0.8679
loss: 0.3564, acc: 0.8707
loss: 0.3519, acc: 0.8727
loss: 0.3484, acc: 0.8750
loss: 0.3421, acc: 0.8787
loss: 0.3363, acc: 0.8817
loss: 0.3363, acc: 0.8832
loss: 0.3385, acc: 0.8802
loss: 0.3442, acc: 0.8768
loss: 0.3398, acc: 0.8803
loss: 0.3428, acc: 0.8777
loss: 0.3486, acc: 0.8735
loss: 0.3447, acc: 0.8760
loss: 0.3458, acc: 0.8763
loss: 0.3461, acc: 0.8769
loss: 0.3452, acc: 0.8777
loss: 0.3429, acc: 0.8798
> val_acc: 0.7982, val_f1: 0.6735
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 29
loss: 0.3037, acc: 0.9167
loss: 0.3500, acc: 0.8945
loss: 0.3492, acc: 0.8894
loss: 0.3456, acc: 0.8924
loss: 0.3304, acc: 0.8954
loss: 0.3319, acc: 0.8906
loss: 0.3323, acc: 0.8939
loss: 0.3268, acc: 0.8964
loss: 0.3295, acc: 0.8946
loss: 0.3345, acc: 0.8926
loss: 0.3333, acc: 0.8927
loss: 0.3406, acc: 0.8895
loss: 0.3385, acc: 0.8894
loss: 0.3366, acc: 0.8897
loss: 0.3359, acc: 0.8887
loss: 0.3322, acc: 0.8898
loss: 0.3298, acc: 0.8931
loss: 0.3314, acc: 0.8913
loss: 0.3351, acc: 0.8884
loss: 0.3351, acc: 0.8897
loss: 0.3403, acc: 0.8865
loss: 0.3400, acc: 0.8869
loss: 0.3399, acc: 0.8869
> val_acc: 0.7982, val_f1: 0.6742
>> test_acc: 0.8009, test_f1: 0.6772
