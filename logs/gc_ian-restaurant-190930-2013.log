cuda memory allocated: 24697344
n_trainable_params: 4407503, n_nontrainable_params: 1764800
> training arguments:
>>> model_name: gc_ian
>>> model_ver: 3
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x000001A1827176A8>
>>> learning_rate: 0.005
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 400
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> embeddings: gd
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 0
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 125
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./embeddings/glove.840B.300d.txt
>>> embedding_matrix_path: gen_data/embeddings/400_restaurant_glove_domain_embedding_matrix.dat
>>> model_class: <class 'models.gc_ian.GC_IAN3'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.5543, acc: 0.4375
loss: 1.2615, acc: 0.5312
loss: 1.1271, acc: 0.5625
loss: 1.0631, acc: 0.5781
loss: 1.0091, acc: 0.5988
loss: 0.9808, acc: 0.6021
loss: 0.9514, acc: 0.6062
loss: 0.9387, acc: 0.6102
loss: 0.9156, acc: 0.6215
loss: 0.9055, acc: 0.6256
loss: 0.8939, acc: 0.6290
loss: 0.8705, acc: 0.6375
loss: 0.8557, acc: 0.6404
loss: 0.8519, acc: 0.6420
loss: 0.8447, acc: 0.6429
loss: 0.8288, acc: 0.6496
loss: 0.8301, acc: 0.6482
loss: 0.8264, acc: 0.6479
loss: 0.8263, acc: 0.6490
loss: 0.8268, acc: 0.6478
loss: 0.8227, acc: 0.6497
loss: 0.8182, acc: 0.6511
> val_acc: 0.7420, val_f1: 0.5480
>> saved: state_dict/gc_ian_restaurant_val_acc0.742
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.5779, acc: 0.6719
loss: 0.5636, acc: 0.7455
loss: 0.5681, acc: 0.7526
loss: 0.5678, acc: 0.7665
loss: 0.5655, acc: 0.7727
loss: 0.5666, acc: 0.7720
loss: 0.5655, acc: 0.7725
loss: 0.5653, acc: 0.7745
loss: 0.5544, acc: 0.7805
loss: 0.5590, acc: 0.7766
loss: 0.5577, acc: 0.7770
loss: 0.5616, acc: 0.7736
loss: 0.5635, acc: 0.7712
loss: 0.5608, acc: 0.7701
loss: 0.5518, acc: 0.7730
loss: 0.5554, acc: 0.7711
loss: 0.5559, acc: 0.7713
loss: 0.5538, acc: 0.7712
loss: 0.5482, acc: 0.7731
loss: 0.5504, acc: 0.7722
loss: 0.5513, acc: 0.7736
loss: 0.5496, acc: 0.7772
loss: 0.5449, acc: 0.7796
> val_acc: 0.7786, val_f1: 0.6323
>> saved: state_dict/gc_ian_restaurant_val_acc0.7786
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.4254, acc: 0.8359
loss: 0.4514, acc: 0.8368
loss: 0.4366, acc: 0.8415
loss: 0.4488, acc: 0.8289
loss: 0.4533, acc: 0.8268
loss: 0.4446, acc: 0.8319
loss: 0.4443, acc: 0.8327
loss: 0.4416, acc: 0.8325
loss: 0.4487, acc: 0.8281
loss: 0.4525, acc: 0.8240
loss: 0.4582, acc: 0.8189
loss: 0.4645, acc: 0.8183
loss: 0.4664, acc: 0.8164
loss: 0.4617, acc: 0.8170
loss: 0.4647, acc: 0.8176
loss: 0.4624, acc: 0.8192
loss: 0.4602, acc: 0.8192
loss: 0.4574, acc: 0.8213
loss: 0.4597, acc: 0.8211
loss: 0.4579, acc: 0.8232
loss: 0.4586, acc: 0.8221
loss: 0.4602, acc: 0.8222
> val_acc: 0.7580, val_f1: 0.5851
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.3461, acc: 0.9062
loss: 0.4065, acc: 0.8385
loss: 0.3994, acc: 0.8352
loss: 0.3883, acc: 0.8398
loss: 0.3835, acc: 0.8482
loss: 0.3885, acc: 0.8498
loss: 0.3909, acc: 0.8498
loss: 0.3890, acc: 0.8507
loss: 0.3943, acc: 0.8521
loss: 0.3942, acc: 0.8526
loss: 0.3957, acc: 0.8517
loss: 0.3911, acc: 0.8555
loss: 0.3987, acc: 0.8499
loss: 0.3979, acc: 0.8513
loss: 0.3954, acc: 0.8539
loss: 0.3969, acc: 0.8528
loss: 0.4002, acc: 0.8511
loss: 0.4017, acc: 0.8488
loss: 0.3986, acc: 0.8506
loss: 0.4002, acc: 0.8493
loss: 0.3994, acc: 0.8490
loss: 0.3972, acc: 0.8491
loss: 0.3959, acc: 0.8491
> val_acc: 0.7830, val_f1: 0.6541
>> saved: state_dict/gc_ian_restaurant_val_acc0.783
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.2586, acc: 0.9583
loss: 0.3339, acc: 0.8945
loss: 0.3514, acc: 0.8798
loss: 0.3510, acc: 0.8837
loss: 0.3374, acc: 0.8913
loss: 0.3563, acc: 0.8806
loss: 0.3635, acc: 0.8788
loss: 0.3571, acc: 0.8783
loss: 0.3544, acc: 0.8779
loss: 0.3566, acc: 0.8763
loss: 0.3600, acc: 0.8721
loss: 0.3632, acc: 0.8707
loss: 0.3704, acc: 0.8646
loss: 0.3696, acc: 0.8653
loss: 0.3683, acc: 0.8656
loss: 0.3686, acc: 0.8654
loss: 0.3669, acc: 0.8652
loss: 0.3648, acc: 0.8654
loss: 0.3622, acc: 0.8659
loss: 0.3642, acc: 0.8651
loss: 0.3594, acc: 0.8680
loss: 0.3601, acc: 0.8681
loss: 0.3589, acc: 0.8686
> val_acc: 0.7759, val_f1: 0.6276
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.2849, acc: 0.9000
loss: 0.3088, acc: 0.8906
loss: 0.3204, acc: 0.8854
loss: 0.3264, acc: 0.8797
loss: 0.3311, acc: 0.8825
loss: 0.3268, acc: 0.8844
loss: 0.3247, acc: 0.8875
loss: 0.3352, acc: 0.8828
loss: 0.3370, acc: 0.8806
loss: 0.3368, acc: 0.8800
loss: 0.3365, acc: 0.8818
loss: 0.3358, acc: 0.8807
loss: 0.3335, acc: 0.8827
loss: 0.3310, acc: 0.8844
loss: 0.3337, acc: 0.8854
loss: 0.3360, acc: 0.8840
loss: 0.3348, acc: 0.8838
loss: 0.3331, acc: 0.8844
loss: 0.3316, acc: 0.8852
loss: 0.3316, acc: 0.8850
loss: 0.3317, acc: 0.8839
loss: 0.3346, acc: 0.8821
> val_acc: 0.7795, val_f1: 0.6387
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.2246, acc: 0.9531
loss: 0.3163, acc: 0.9018
loss: 0.2885, acc: 0.9141
loss: 0.2939, acc: 0.9007
loss: 0.3047, acc: 0.8920
loss: 0.3135, acc: 0.8900
loss: 0.3063, acc: 0.8965
loss: 0.2977, acc: 0.8995
loss: 0.2990, acc: 0.9003
loss: 0.2978, acc: 0.8963
loss: 0.2946, acc: 0.8966
loss: 0.2933, acc: 0.8975
loss: 0.2984, acc: 0.8957
loss: 0.2915, acc: 0.8988
loss: 0.2875, acc: 0.9006
loss: 0.2918, acc: 0.8998
loss: 0.2929, acc: 0.8982
loss: 0.2968, acc: 0.8958
loss: 0.2975, acc: 0.8957
loss: 0.2987, acc: 0.8947
loss: 0.2977, acc: 0.8958
loss: 0.2992, acc: 0.8946
loss: 0.3000, acc: 0.8943
> val_acc: 0.7902, val_f1: 0.6509
>> saved: state_dict/gc_ian_restaurant_val_acc0.7902
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.2437, acc: 0.9297
loss: 0.2343, acc: 0.9410
loss: 0.2480, acc: 0.9263
loss: 0.2616, acc: 0.9161
loss: 0.2626, acc: 0.9167
loss: 0.2640, acc: 0.9159
loss: 0.2589, acc: 0.9164
loss: 0.2575, acc: 0.9167
loss: 0.2619, acc: 0.9155
loss: 0.2627, acc: 0.9145
loss: 0.2681, acc: 0.9120
loss: 0.2661, acc: 0.9131
loss: 0.2688, acc: 0.9102
loss: 0.2686, acc: 0.9108
loss: 0.2753, acc: 0.9075
loss: 0.2714, acc: 0.9102
loss: 0.2691, acc: 0.9107
loss: 0.2697, acc: 0.9101
loss: 0.2708, acc: 0.9086
loss: 0.2755, acc: 0.9066
loss: 0.2781, acc: 0.9044
loss: 0.2794, acc: 0.9031
> val_acc: 0.7902, val_f1: 0.6677
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.3169, acc: 0.8750
loss: 0.2744, acc: 0.8854
loss: 0.2791, acc: 0.8949
loss: 0.2753, acc: 0.9004
loss: 0.2801, acc: 0.8973
loss: 0.2801, acc: 0.8978
loss: 0.2714, acc: 0.9032
loss: 0.2608, acc: 0.9071
loss: 0.2575, acc: 0.9116
loss: 0.2563, acc: 0.9117
loss: 0.2636, acc: 0.9075
loss: 0.2665, acc: 0.9068
loss: 0.2620, acc: 0.9078
loss: 0.2644, acc: 0.9077
loss: 0.2629, acc: 0.9098
loss: 0.2640, acc: 0.9100
loss: 0.2623, acc: 0.9109
loss: 0.2631, acc: 0.9099
loss: 0.2646, acc: 0.9104
loss: 0.2646, acc: 0.9115
loss: 0.2665, acc: 0.9115
loss: 0.2670, acc: 0.9116
loss: 0.2678, acc: 0.9108
> val_acc: 0.7857, val_f1: 0.6461
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.2655, acc: 0.9062
loss: 0.2488, acc: 0.9219
loss: 0.2387, acc: 0.9279
loss: 0.2404, acc: 0.9236
loss: 0.2482, acc: 0.9226
loss: 0.2599, acc: 0.9129
loss: 0.2531, acc: 0.9129
loss: 0.2463, acc: 0.9186
loss: 0.2425, acc: 0.9179
loss: 0.2471, acc: 0.9160
loss: 0.2425, acc: 0.9210
loss: 0.2400, acc: 0.9213
loss: 0.2414, acc: 0.9221
loss: 0.2426, acc: 0.9210
loss: 0.2445, acc: 0.9221
loss: 0.2417, acc: 0.9223
loss: 0.2459, acc: 0.9191
loss: 0.2438, acc: 0.9212
loss: 0.2421, acc: 0.9224
loss: 0.2417, acc: 0.9219
loss: 0.2419, acc: 0.9214
loss: 0.2475, acc: 0.9184
loss: 0.2461, acc: 0.9185
> val_acc: 0.7759, val_f1: 0.6303
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.2416, acc: 0.9062
loss: 0.2296, acc: 0.9187
loss: 0.2346, acc: 0.9167
loss: 0.2360, acc: 0.9187
loss: 0.2388, acc: 0.9150
loss: 0.2341, acc: 0.9198
loss: 0.2373, acc: 0.9232
loss: 0.2373, acc: 0.9234
loss: 0.2399, acc: 0.9201
loss: 0.2413, acc: 0.9206
loss: 0.2441, acc: 0.9176
loss: 0.2431, acc: 0.9182
loss: 0.2391, acc: 0.9192
loss: 0.2402, acc: 0.9201
loss: 0.2400, acc: 0.9204
loss: 0.2375, acc: 0.9215
loss: 0.2381, acc: 0.9184
loss: 0.2362, acc: 0.9201
loss: 0.2350, acc: 0.9211
loss: 0.2387, acc: 0.9184
loss: 0.2380, acc: 0.9190
loss: 0.2395, acc: 0.9187
> val_acc: 0.7857, val_f1: 0.6455
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.3107, acc: 0.8750
loss: 0.2381, acc: 0.9152
loss: 0.2243, acc: 0.9297
loss: 0.2256, acc: 0.9265
loss: 0.2150, acc: 0.9304
loss: 0.2079, acc: 0.9340
loss: 0.2099, acc: 0.9326
loss: 0.2107, acc: 0.9341
loss: 0.2093, acc: 0.9338
loss: 0.2058, acc: 0.9355
loss: 0.2066, acc: 0.9345
loss: 0.2074, acc: 0.9337
loss: 0.2084, acc: 0.9350
loss: 0.2119, acc: 0.9342
loss: 0.2160, acc: 0.9310
loss: 0.2181, acc: 0.9302
loss: 0.2228, acc: 0.9284
loss: 0.2257, acc: 0.9264
loss: 0.2251, acc: 0.9270
loss: 0.2245, acc: 0.9278
loss: 0.2243, acc: 0.9277
loss: 0.2265, acc: 0.9255
loss: 0.2258, acc: 0.9258
> val_acc: 0.7830, val_f1: 0.6463
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.1885, acc: 0.9219
loss: 0.1957, acc: 0.9306
loss: 0.1942, acc: 0.9263
loss: 0.1926, acc: 0.9309
loss: 0.1927, acc: 0.9336
loss: 0.1962, acc: 0.9353
loss: 0.2013, acc: 0.9347
loss: 0.1982, acc: 0.9367
loss: 0.2019, acc: 0.9347
loss: 0.2034, acc: 0.9343
loss: 0.2016, acc: 0.9340
loss: 0.2034, acc: 0.9349
loss: 0.2004, acc: 0.9365
loss: 0.2007, acc: 0.9361
loss: 0.2017, acc: 0.9354
loss: 0.2011, acc: 0.9363
loss: 0.2047, acc: 0.9349
loss: 0.2052, acc: 0.9347
loss: 0.2087, acc: 0.9318
loss: 0.2132, acc: 0.9283
loss: 0.2153, acc: 0.9267
loss: 0.2154, acc: 0.9257
> val_acc: 0.7857, val_f1: 0.6426
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.1526, acc: 0.9688
loss: 0.1934, acc: 0.9323
loss: 0.1785, acc: 0.9517
loss: 0.1747, acc: 0.9551
loss: 0.1754, acc: 0.9524
loss: 0.1868, acc: 0.9471
loss: 0.1824, acc: 0.9486
loss: 0.1934, acc: 0.9401
loss: 0.1965, acc: 0.9360
loss: 0.1964, acc: 0.9348
loss: 0.1982, acc: 0.9357
loss: 0.1984, acc: 0.9347
loss: 0.1950, acc: 0.9365
loss: 0.2001, acc: 0.9337
loss: 0.2000, acc: 0.9344
loss: 0.2021, acc: 0.9334
loss: 0.2010, acc: 0.9340
loss: 0.2049, acc: 0.9324
loss: 0.2047, acc: 0.9327
loss: 0.2059, acc: 0.9326
loss: 0.2055, acc: 0.9325
loss: 0.2053, acc: 0.9322
loss: 0.2057, acc: 0.9327
> val_acc: 0.7866, val_f1: 0.6525
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.1872, acc: 0.9375
loss: 0.2063, acc: 0.9297
loss: 0.2079, acc: 0.9327
loss: 0.2045, acc: 0.9375
loss: 0.2087, acc: 0.9307
loss: 0.2047, acc: 0.9342
loss: 0.1982, acc: 0.9384
loss: 0.1978, acc: 0.9367
loss: 0.2012, acc: 0.9339
loss: 0.2024, acc: 0.9336
loss: 0.2016, acc: 0.9328
loss: 0.2031, acc: 0.9310
loss: 0.2044, acc: 0.9320
loss: 0.2041, acc: 0.9320
loss: 0.2028, acc: 0.9315
loss: 0.2003, acc: 0.9327
loss: 0.2010, acc: 0.9315
loss: 0.1982, acc: 0.9332
loss: 0.2010, acc: 0.9321
loss: 0.2003, acc: 0.9321
loss: 0.2004, acc: 0.9320
loss: 0.2006, acc: 0.9326
loss: 0.2016, acc: 0.9318
> val_acc: 0.7812, val_f1: 0.6401
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.1474, acc: 0.9750
loss: 0.1696, acc: 0.9594
loss: 0.1794, acc: 0.9500
loss: 0.1922, acc: 0.9422
loss: 0.1870, acc: 0.9437
loss: 0.1884, acc: 0.9417
loss: 0.1904, acc: 0.9402
loss: 0.1925, acc: 0.9383
loss: 0.1930, acc: 0.9382
loss: 0.1931, acc: 0.9375
loss: 0.1913, acc: 0.9398
loss: 0.1917, acc: 0.9391
loss: 0.1942, acc: 0.9370
loss: 0.1930, acc: 0.9388
loss: 0.1935, acc: 0.9387
loss: 0.1943, acc: 0.9375
loss: 0.1934, acc: 0.9375
loss: 0.1913, acc: 0.9382
loss: 0.1915, acc: 0.9375
loss: 0.1900, acc: 0.9375
loss: 0.1901, acc: 0.9378
loss: 0.1902, acc: 0.9381
> val_acc: 0.7795, val_f1: 0.6297
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.2134, acc: 0.9531
loss: 0.1881, acc: 0.9464
loss: 0.1871, acc: 0.9427
loss: 0.1930, acc: 0.9393
loss: 0.1822, acc: 0.9460
loss: 0.1852, acc: 0.9444
loss: 0.1852, acc: 0.9424
loss: 0.1845, acc: 0.9443
loss: 0.1812, acc: 0.9449
loss: 0.1846, acc: 0.9455
loss: 0.1834, acc: 0.9453
loss: 0.1865, acc: 0.9424
loss: 0.1903, acc: 0.9395
loss: 0.1889, acc: 0.9408
loss: 0.1864, acc: 0.9427
loss: 0.1868, acc: 0.9432
loss: 0.1900, acc: 0.9413
loss: 0.1914, acc: 0.9404
loss: 0.1923, acc: 0.9389
loss: 0.1912, acc: 0.9388
loss: 0.1907, acc: 0.9381
loss: 0.1905, acc: 0.9375
loss: 0.1897, acc: 0.9375
> val_acc: 0.7848, val_f1: 0.6495
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 0.1426, acc: 0.9453
loss: 0.1473, acc: 0.9549
loss: 0.1641, acc: 0.9487
loss: 0.1598, acc: 0.9507
loss: 0.1593, acc: 0.9505
loss: 0.1584, acc: 0.9504
loss: 0.1626, acc: 0.9504
loss: 0.1640, acc: 0.9503
loss: 0.1654, acc: 0.9503
loss: 0.1684, acc: 0.9483
loss: 0.1686, acc: 0.9491
loss: 0.1689, acc: 0.9497
loss: 0.1729, acc: 0.9487
loss: 0.1727, acc: 0.9484
loss: 0.1742, acc: 0.9468
loss: 0.1736, acc: 0.9466
loss: 0.1745, acc: 0.9468
loss: 0.1735, acc: 0.9480
loss: 0.1757, acc: 0.9465
loss: 0.1791, acc: 0.9444
loss: 0.1783, acc: 0.9447
loss: 0.1788, acc: 0.9429
> val_acc: 0.7937, val_f1: 0.6721
>> saved: state_dict/gc_ian_restaurant_val_acc0.7937
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
loss: 0.1153, acc: 1.0000
loss: 0.1290, acc: 0.9635
loss: 0.1422, acc: 0.9517
loss: 0.1550, acc: 0.9473
loss: 0.1638, acc: 0.9449
loss: 0.1596, acc: 0.9495
loss: 0.1616, acc: 0.9476
loss: 0.1587, acc: 0.9497
loss: 0.1613, acc: 0.9489
loss: 0.1604, acc: 0.9511
loss: 0.1617, acc: 0.9491
loss: 0.1655, acc: 0.9464
loss: 0.1688, acc: 0.9462
loss: 0.1664, acc: 0.9484
loss: 0.1643, acc: 0.9489
loss: 0.1638, acc: 0.9486
loss: 0.1632, acc: 0.9483
loss: 0.1663, acc: 0.9462
loss: 0.1656, acc: 0.9478
loss: 0.1681, acc: 0.9469
loss: 0.1712, acc: 0.9446
loss: 0.1686, acc: 0.9463
loss: 0.1694, acc: 0.9459
> val_acc: 0.7866, val_f1: 0.6436
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
loss: 0.1282, acc: 0.9583
loss: 0.1473, acc: 0.9531
loss: 0.1677, acc: 0.9399
loss: 0.1640, acc: 0.9479
loss: 0.1687, acc: 0.9470
loss: 0.1667, acc: 0.9498
loss: 0.1643, acc: 0.9508
loss: 0.1667, acc: 0.9465
loss: 0.1707, acc: 0.9469
loss: 0.1678, acc: 0.9492
loss: 0.1676, acc: 0.9517
loss: 0.1685, acc: 0.9504
loss: 0.1714, acc: 0.9504
loss: 0.1689, acc: 0.9517
loss: 0.1667, acc: 0.9521
loss: 0.1678, acc: 0.9511
loss: 0.1660, acc: 0.9503
loss: 0.1652, acc: 0.9506
loss: 0.1669, acc: 0.9493
loss: 0.1675, acc: 0.9490
loss: 0.1668, acc: 0.9502
loss: 0.1654, acc: 0.9505
loss: 0.1652, acc: 0.9504
> val_acc: 0.7929, val_f1: 0.6699
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 20
loss: 0.1242, acc: 0.9812
loss: 0.1298, acc: 0.9719
loss: 0.1311, acc: 0.9667
loss: 0.1320, acc: 0.9609
loss: 0.1314, acc: 0.9663
loss: 0.1301, acc: 0.9656
loss: 0.1378, acc: 0.9616
loss: 0.1402, acc: 0.9609
loss: 0.1442, acc: 0.9590
loss: 0.1470, acc: 0.9556
loss: 0.1479, acc: 0.9563
loss: 0.1514, acc: 0.9542
loss: 0.1545, acc: 0.9538
loss: 0.1587, acc: 0.9509
loss: 0.1604, acc: 0.9500
loss: 0.1597, acc: 0.9500
loss: 0.1588, acc: 0.9504
loss: 0.1611, acc: 0.9490
loss: 0.1601, acc: 0.9503
loss: 0.1609, acc: 0.9500
loss: 0.1615, acc: 0.9497
loss: 0.1623, acc: 0.9489
> val_acc: 0.7857, val_f1: 0.6553
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 21
loss: 0.0871, acc: 0.9844
loss: 0.1271, acc: 0.9688
loss: 0.1215, acc: 0.9688
loss: 0.1233, acc: 0.9651
loss: 0.1393, acc: 0.9602
loss: 0.1429, acc: 0.9572
loss: 0.1554, acc: 0.9512
loss: 0.1550, acc: 0.9510
loss: 0.1582, acc: 0.9516
loss: 0.1543, acc: 0.9528
loss: 0.1554, acc: 0.9531
loss: 0.1540, acc: 0.9523
loss: 0.1592, acc: 0.9516
loss: 0.1559, acc: 0.9529
loss: 0.1573, acc: 0.9514
loss: 0.1574, acc: 0.9521
loss: 0.1587, acc: 0.9520
loss: 0.1605, acc: 0.9511
loss: 0.1609, acc: 0.9507
loss: 0.1609, acc: 0.9497
loss: 0.1626, acc: 0.9488
loss: 0.1627, acc: 0.9483
loss: 0.1609, acc: 0.9495
> val_acc: 0.7848, val_f1: 0.6436
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 22
loss: 0.1700, acc: 0.9375
loss: 0.1552, acc: 0.9549
loss: 0.1632, acc: 0.9509
loss: 0.1582, acc: 0.9507
loss: 0.1523, acc: 0.9570
loss: 0.1574, acc: 0.9547
loss: 0.1581, acc: 0.9531
loss: 0.1578, acc: 0.9511
loss: 0.1534, acc: 0.9538
loss: 0.1484, acc: 0.9560
loss: 0.1511, acc: 0.9537
loss: 0.1485, acc: 0.9555
loss: 0.1472, acc: 0.9565
loss: 0.1482, acc: 0.9570
loss: 0.1479, acc: 0.9573
loss: 0.1513, acc: 0.9561
loss: 0.1537, acc: 0.9546
loss: 0.1573, acc: 0.9519
loss: 0.1578, acc: 0.9521
loss: 0.1573, acc: 0.9523
loss: 0.1564, acc: 0.9525
loss: 0.1573, acc: 0.9521
> val_acc: 0.7839, val_f1: 0.6406
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 23
loss: 0.1411, acc: 0.9375
loss: 0.1088, acc: 0.9792
loss: 0.1144, acc: 0.9744
loss: 0.1263, acc: 0.9727
loss: 0.1379, acc: 0.9643
loss: 0.1419, acc: 0.9591
loss: 0.1412, acc: 0.9577
loss: 0.1404, acc: 0.9557
loss: 0.1397, acc: 0.9566
loss: 0.1417, acc: 0.9558
loss: 0.1378, acc: 0.9571
loss: 0.1388, acc: 0.9570
loss: 0.1396, acc: 0.9554
loss: 0.1400, acc: 0.9545
loss: 0.1420, acc: 0.9542
loss: 0.1423, acc: 0.9552
loss: 0.1417, acc: 0.9556
loss: 0.1433, acc: 0.9528
loss: 0.1478, acc: 0.9512
loss: 0.1470, acc: 0.9521
loss: 0.1487, acc: 0.9520
loss: 0.1487, acc: 0.9522
loss: 0.1469, acc: 0.9535
> val_acc: 0.7786, val_f1: 0.6320
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 24
loss: 0.1146, acc: 0.9688
loss: 0.1342, acc: 0.9609
loss: 0.1337, acc: 0.9591
loss: 0.1347, acc: 0.9566
loss: 0.1469, acc: 0.9565
loss: 0.1510, acc: 0.9531
loss: 0.1487, acc: 0.9536
loss: 0.1486, acc: 0.9531
loss: 0.1486, acc: 0.9549
loss: 0.1462, acc: 0.9564
loss: 0.1472, acc: 0.9546
loss: 0.1498, acc: 0.9520
loss: 0.1497, acc: 0.9514
loss: 0.1488, acc: 0.9522
loss: 0.1480, acc: 0.9529
loss: 0.1518, acc: 0.9511
loss: 0.1482, acc: 0.9526
loss: 0.1471, acc: 0.9528
loss: 0.1491, acc: 0.9530
loss: 0.1493, acc: 0.9522
loss: 0.1490, acc: 0.9527
loss: 0.1499, acc: 0.9528
loss: 0.1520, acc: 0.9518
> val_acc: 0.7848, val_f1: 0.6495
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 25
loss: 0.1215, acc: 0.9688
loss: 0.1373, acc: 0.9563
loss: 0.1349, acc: 0.9604
loss: 0.1371, acc: 0.9578
loss: 0.1354, acc: 0.9600
loss: 0.1381, acc: 0.9604
loss: 0.1347, acc: 0.9616
loss: 0.1330, acc: 0.9609
loss: 0.1374, acc: 0.9604
loss: 0.1377, acc: 0.9587
loss: 0.1421, acc: 0.9563
loss: 0.1406, acc: 0.9557
loss: 0.1382, acc: 0.9572
loss: 0.1376, acc: 0.9567
loss: 0.1362, acc: 0.9567
loss: 0.1372, acc: 0.9566
loss: 0.1372, acc: 0.9563
loss: 0.1409, acc: 0.9552
loss: 0.1419, acc: 0.9546
loss: 0.1438, acc: 0.9541
loss: 0.1447, acc: 0.9545
loss: 0.1446, acc: 0.9548
> val_acc: 0.7875, val_f1: 0.6524
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 26
loss: 0.1348, acc: 0.9688
loss: 0.1610, acc: 0.9420
loss: 0.1727, acc: 0.9375
loss: 0.1683, acc: 0.9412
loss: 0.1704, acc: 0.9403
loss: 0.1580, acc: 0.9456
loss: 0.1516, acc: 0.9502
loss: 0.1505, acc: 0.9519
loss: 0.1468, acc: 0.9531
loss: 0.1466, acc: 0.9521
loss: 0.1530, acc: 0.9495
loss: 0.1515, acc: 0.9507
loss: 0.1522, acc: 0.9501
loss: 0.1488, acc: 0.9529
loss: 0.1469, acc: 0.9527
loss: 0.1472, acc: 0.9525
loss: 0.1466, acc: 0.9520
loss: 0.1465, acc: 0.9526
loss: 0.1451, acc: 0.9528
loss: 0.1440, acc: 0.9536
loss: 0.1418, acc: 0.9553
loss: 0.1422, acc: 0.9541
loss: 0.1420, acc: 0.9542
> val_acc: 0.7866, val_f1: 0.6520
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 27
loss: 0.1265, acc: 0.9688
loss: 0.1274, acc: 0.9653
loss: 0.1371, acc: 0.9576
loss: 0.1345, acc: 0.9605
loss: 0.1393, acc: 0.9570
loss: 0.1384, acc: 0.9558
loss: 0.1317, acc: 0.9605
loss: 0.1280, acc: 0.9623
loss: 0.1281, acc: 0.9609
loss: 0.1292, acc: 0.9605
loss: 0.1312, acc: 0.9595
loss: 0.1293, acc: 0.9608
loss: 0.1292, acc: 0.9609
loss: 0.1292, acc: 0.9620
loss: 0.1301, acc: 0.9620
loss: 0.1325, acc: 0.9593
loss: 0.1314, acc: 0.9602
loss: 0.1328, acc: 0.9589
loss: 0.1333, acc: 0.9578
loss: 0.1335, acc: 0.9574
loss: 0.1336, acc: 0.9573
loss: 0.1332, acc: 0.9573
> val_acc: 0.7857, val_f1: 0.6523
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 28
loss: 0.1086, acc: 0.9688
loss: 0.1249, acc: 0.9583
loss: 0.1433, acc: 0.9517
loss: 0.1429, acc: 0.9551
loss: 0.1397, acc: 0.9524
loss: 0.1301, acc: 0.9591
loss: 0.1302, acc: 0.9607
loss: 0.1291, acc: 0.9627
loss: 0.1294, acc: 0.9627
loss: 0.1277, acc: 0.9633
loss: 0.1307, acc: 0.9626
loss: 0.1285, acc: 0.9637
loss: 0.1320, acc: 0.9621
loss: 0.1335, acc: 0.9598
loss: 0.1342, acc: 0.9586
loss: 0.1352, acc: 0.9576
loss: 0.1379, acc: 0.9568
loss: 0.1363, acc: 0.9571
loss: 0.1382, acc: 0.9564
loss: 0.1375, acc: 0.9570
loss: 0.1378, acc: 0.9573
loss: 0.1384, acc: 0.9564
loss: 0.1384, acc: 0.9561
> val_acc: 0.7848, val_f1: 0.6401
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 29
loss: 0.1205, acc: 0.9479
loss: 0.1251, acc: 0.9531
loss: 0.1244, acc: 0.9543
loss: 0.1303, acc: 0.9514
loss: 0.1267, acc: 0.9565
loss: 0.1333, acc: 0.9520
loss: 0.1307, acc: 0.9517
loss: 0.1316, acc: 0.9539
loss: 0.1317, acc: 0.9535
loss: 0.1324, acc: 0.9531
loss: 0.1299, acc: 0.9546
loss: 0.1318, acc: 0.9547
loss: 0.1305, acc: 0.9554
loss: 0.1321, acc: 0.9540
loss: 0.1324, acc: 0.9538
loss: 0.1331, acc: 0.9543
loss: 0.1317, acc: 0.9548
loss: 0.1327, acc: 0.9553
loss: 0.1319, acc: 0.9556
loss: 0.1315, acc: 0.9563
loss: 0.1339, acc: 0.9551
loss: 0.1352, acc: 0.9540
loss: 0.1356, acc: 0.9540
> val_acc: 0.7795, val_f1: 0.6238
>> test_acc: 0.7937, test_f1: 0.6721
