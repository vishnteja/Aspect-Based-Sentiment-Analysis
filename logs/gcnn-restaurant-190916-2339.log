cuda memory allocated: 17266176
n_trainable_params: 2985843, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: gcnn
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x00000206903D96A8>
>>> learning_rate: 0.0003
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 10
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: None
>>> valset_ratio: 0
>>> num_layers: 3
>>> in_channels: 600
>>> out_channels: 3
>>> downbot: 20
>>> kernel_size: 4
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.gated_cnn.Gated_CNN'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 0.9596, acc: 0.5938
loss: 0.9616, acc: 0.5844
loss: 0.9629, acc: 0.5833
loss: 0.9544, acc: 0.5938
loss: 0.9602, acc: 0.5875
loss: 0.9665, acc: 0.5823
loss: 0.9551, acc: 0.5911
loss: 0.9443, acc: 0.5961
loss: 0.9479, acc: 0.5903
loss: 0.9434, acc: 0.5919
loss: 0.9358, acc: 0.5938
loss: 0.9269, acc: 0.5984
loss: 0.9278, acc: 0.5938
loss: 0.9177, acc: 0.5978
loss: 0.9119, acc: 0.5983
loss: 0.9107, acc: 0.5973
loss: 0.9119, acc: 0.5956
loss: 0.9099, acc: 0.5944
loss: 0.9074, acc: 0.5947
loss: 0.9025, acc: 0.5988
loss: 0.8998, acc: 0.5997
loss: 0.8964, acc: 0.6017
> val_acc: 0.6911, val_f1: 0.3987
>> saved: state_dict/gcnn_restaurant_val_acc0.6911
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.9352, acc: 0.5156
loss: 0.8172, acc: 0.6295
loss: 0.8050, acc: 0.6484
loss: 0.7952, acc: 0.6507
loss: 0.8080, acc: 0.6463
loss: 0.8165, acc: 0.6400
loss: 0.8234, acc: 0.6299
loss: 0.8203, acc: 0.6368
loss: 0.8190, acc: 0.6369
loss: 0.8134, acc: 0.6383
loss: 0.8121, acc: 0.6382
loss: 0.8116, acc: 0.6420
loss: 0.8077, acc: 0.6492
loss: 0.8102, acc: 0.6483
loss: 0.8098, acc: 0.6480
loss: 0.8054, acc: 0.6514
loss: 0.7954, acc: 0.6570
loss: 0.7962, acc: 0.6570
loss: 0.7950, acc: 0.6576
loss: 0.7928, acc: 0.6595
loss: 0.7911, acc: 0.6584
loss: 0.7951, acc: 0.6565
loss: 0.7961, acc: 0.6546
> val_acc: 0.7384, val_f1: 0.5538
>> saved: state_dict/gcnn_restaurant_val_acc0.7384
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.7528, acc: 0.7344
loss: 0.7730, acc: 0.7153
loss: 0.7612, acc: 0.7277
loss: 0.7568, acc: 0.7188
loss: 0.7547, acc: 0.7188
loss: 0.7682, acc: 0.7058
loss: 0.7803, acc: 0.6958
loss: 0.7808, acc: 0.6915
loss: 0.7738, acc: 0.6967
loss: 0.7659, acc: 0.6990
loss: 0.7660, acc: 0.6968
loss: 0.7653, acc: 0.6960
loss: 0.7646, acc: 0.6934
loss: 0.7680, acc: 0.6920
loss: 0.7665, acc: 0.6926
loss: 0.7627, acc: 0.6954
loss: 0.7574, acc: 0.6964
loss: 0.7569, acc: 0.6956
loss: 0.7553, acc: 0.6975
loss: 0.7577, acc: 0.6954
loss: 0.7586, acc: 0.6965
loss: 0.7585, acc: 0.6967
> val_acc: 0.7696, val_f1: 0.6171
>> saved: state_dict/gcnn_restaurant_val_acc0.7696
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.6601, acc: 0.7500
loss: 0.6863, acc: 0.7448
loss: 0.7285, acc: 0.7244
loss: 0.7176, acc: 0.7324
loss: 0.7048, acc: 0.7292
loss: 0.6885, acc: 0.7368
loss: 0.7041, acc: 0.7248
loss: 0.7087, acc: 0.7170
loss: 0.7146, acc: 0.7149
loss: 0.7106, acc: 0.7188
loss: 0.7137, acc: 0.7145
loss: 0.7170, acc: 0.7154
loss: 0.7163, acc: 0.7162
loss: 0.7176, acc: 0.7159
loss: 0.7186, acc: 0.7143
loss: 0.7179, acc: 0.7163
loss: 0.7188, acc: 0.7157
loss: 0.7176, acc: 0.7140
loss: 0.7198, acc: 0.7133
loss: 0.7202, acc: 0.7145
loss: 0.7205, acc: 0.7138
loss: 0.7205, acc: 0.7140
loss: 0.7192, acc: 0.7126
> val_acc: 0.7509, val_f1: 0.5650
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.7178, acc: 0.6875
loss: 0.7070, acc: 0.7109
loss: 0.6856, acc: 0.7308
loss: 0.6873, acc: 0.7344
loss: 0.6834, acc: 0.7378
loss: 0.6848, acc: 0.7411
loss: 0.6856, acc: 0.7396
loss: 0.6915, acc: 0.7336
loss: 0.6949, acc: 0.7275
loss: 0.6934, acc: 0.7266
loss: 0.6988, acc: 0.7199
loss: 0.6995, acc: 0.7204
loss: 0.6981, acc: 0.7183
loss: 0.7020, acc: 0.7142
loss: 0.6963, acc: 0.7175
loss: 0.6986, acc: 0.7163
loss: 0.7078, acc: 0.7105
loss: 0.7082, acc: 0.7106
loss: 0.7082, acc: 0.7103
loss: 0.7085, acc: 0.7121
loss: 0.7048, acc: 0.7130
loss: 0.7011, acc: 0.7150
loss: 0.7009, acc: 0.7145
> val_acc: 0.7696, val_f1: 0.6279
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.6233, acc: 0.7562
loss: 0.6619, acc: 0.7281
loss: 0.6541, acc: 0.7396
loss: 0.6664, acc: 0.7375
loss: 0.6621, acc: 0.7362
loss: 0.6637, acc: 0.7365
loss: 0.6654, acc: 0.7384
loss: 0.6641, acc: 0.7383
loss: 0.6670, acc: 0.7403
loss: 0.6627, acc: 0.7406
loss: 0.6625, acc: 0.7403
loss: 0.6648, acc: 0.7380
loss: 0.6697, acc: 0.7337
loss: 0.6766, acc: 0.7295
loss: 0.6736, acc: 0.7304
loss: 0.6771, acc: 0.7262
loss: 0.6818, acc: 0.7235
loss: 0.6799, acc: 0.7226
loss: 0.6822, acc: 0.7240
loss: 0.6823, acc: 0.7238
loss: 0.6838, acc: 0.7232
loss: 0.6821, acc: 0.7236
> val_acc: 0.7688, val_f1: 0.6379
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.6863, acc: 0.6875
loss: 0.6435, acc: 0.7411
loss: 0.6320, acc: 0.7422
loss: 0.6297, acc: 0.7445
loss: 0.6246, acc: 0.7543
loss: 0.6305, acc: 0.7465
loss: 0.6284, acc: 0.7422
loss: 0.6152, acc: 0.7466
loss: 0.6347, acc: 0.7403
loss: 0.6259, acc: 0.7427
loss: 0.6297, acc: 0.7422
loss: 0.6377, acc: 0.7423
loss: 0.6421, acc: 0.7419
loss: 0.6470, acc: 0.7397
loss: 0.6456, acc: 0.7387
loss: 0.6489, acc: 0.7386
loss: 0.6546, acc: 0.7355
loss: 0.6544, acc: 0.7346
loss: 0.6570, acc: 0.7340
loss: 0.6637, acc: 0.7307
loss: 0.6650, acc: 0.7295
loss: 0.6655, acc: 0.7284
loss: 0.6622, acc: 0.7302
> val_acc: 0.7500, val_f1: 0.5654
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.7076, acc: 0.6797
loss: 0.6433, acc: 0.7396
loss: 0.6284, acc: 0.7388
loss: 0.6170, acc: 0.7484
loss: 0.6108, acc: 0.7474
loss: 0.5989, acc: 0.7565
loss: 0.6039, acc: 0.7564
loss: 0.6070, acc: 0.7564
loss: 0.6160, acc: 0.7550
loss: 0.6250, acc: 0.7526
loss: 0.6198, acc: 0.7575
loss: 0.6214, acc: 0.7579
loss: 0.6213, acc: 0.7583
loss: 0.6289, acc: 0.7554
loss: 0.6384, acc: 0.7487
loss: 0.6395, acc: 0.7484
loss: 0.6444, acc: 0.7478
loss: 0.6455, acc: 0.7468
loss: 0.6409, acc: 0.7477
loss: 0.6410, acc: 0.7478
loss: 0.6397, acc: 0.7485
loss: 0.6383, acc: 0.7486
> val_acc: 0.7518, val_f1: 0.5869
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.3935, acc: 0.7812
loss: 0.6136, acc: 0.7240
loss: 0.6119, acc: 0.7528
loss: 0.6124, acc: 0.7598
loss: 0.6350, acc: 0.7485
loss: 0.6395, acc: 0.7404
loss: 0.6449, acc: 0.7359
loss: 0.6471, acc: 0.7370
loss: 0.6431, acc: 0.7416
loss: 0.6464, acc: 0.7391
loss: 0.6494, acc: 0.7384
loss: 0.6443, acc: 0.7405
loss: 0.6453, acc: 0.7382
loss: 0.6440, acc: 0.7391
loss: 0.6352, acc: 0.7425
loss: 0.6279, acc: 0.7459
loss: 0.6295, acc: 0.7465
loss: 0.6335, acc: 0.7453
loss: 0.6288, acc: 0.7469
loss: 0.6237, acc: 0.7500
loss: 0.6235, acc: 0.7512
loss: 0.6225, acc: 0.7500
loss: 0.6247, acc: 0.7489
> val_acc: 0.7482, val_f1: 0.6082
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.5375, acc: 0.8021
loss: 0.5954, acc: 0.7578
loss: 0.5799, acc: 0.7692
loss: 0.5882, acc: 0.7674
loss: 0.5998, acc: 0.7663
loss: 0.6057, acc: 0.7634
loss: 0.6131, acc: 0.7614
loss: 0.6071, acc: 0.7632
loss: 0.6045, acc: 0.7631
loss: 0.6010, acc: 0.7663
loss: 0.6108, acc: 0.7612
loss: 0.6026, acc: 0.7624
loss: 0.6135, acc: 0.7594
loss: 0.6083, acc: 0.7629
loss: 0.6141, acc: 0.7594
loss: 0.6140, acc: 0.7576
loss: 0.6165, acc: 0.7564
loss: 0.6210, acc: 0.7543
loss: 0.6179, acc: 0.7557
loss: 0.6201, acc: 0.7545
loss: 0.6154, acc: 0.7555
loss: 0.6156, acc: 0.7552
loss: 0.6176, acc: 0.7533
> val_acc: 0.7482, val_f1: 0.6061
>> test_acc: 0.7696, test_f1: 0.6171
