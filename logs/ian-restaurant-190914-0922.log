cuda memory allocated: 13975040
n_trainable_params: 2168403, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: ian
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x0000024D82539730>
>>> learning_rate: 0.001
>>> dropout: 0.5
>>> l2reg: 1e-05
>>> num_epoch: 50
>>> batch_size: 64
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: None
>>> valset_ratio: 0
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.ian.IAN'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 0.9413, acc: 0.6062
loss: 0.9386, acc: 0.5984
loss: 0.9351, acc: 0.5854
loss: 0.9058, acc: 0.6047
loss: 0.8831, acc: 0.6131
loss: 0.8651, acc: 0.6229
loss: 0.8571, acc: 0.6223
loss: 0.8419, acc: 0.6281
loss: 0.8357, acc: 0.6337
loss: 0.8275, acc: 0.6394
loss: 0.8221, acc: 0.6412
> val_acc: 0.7116, val_f1: 0.4605
>> saved: state_dict/ian_restaurant_val_acc0.7116
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.6624, acc: 0.7083
loss: 0.7704, acc: 0.6680
loss: 0.7072, acc: 0.7007
loss: 0.6925, acc: 0.7161
loss: 0.6933, acc: 0.7147
loss: 0.6884, acc: 0.7165
loss: 0.6752, acc: 0.7197
loss: 0.6760, acc: 0.7192
loss: 0.6753, acc: 0.7191
loss: 0.6732, acc: 0.7227
loss: 0.6768, acc: 0.7223
> val_acc: 0.7446, val_f1: 0.5638
>> saved: state_dict/ian_restaurant_val_acc0.7446
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.5239, acc: 0.8125
loss: 0.5222, acc: 0.7995
loss: 0.5781, acc: 0.7798
loss: 0.5670, acc: 0.7852
loss: 0.5815, acc: 0.7679
loss: 0.5854, acc: 0.7662
loss: 0.5865, acc: 0.7631
loss: 0.5901, acc: 0.7574
loss: 0.5906, acc: 0.7542
loss: 0.5917, acc: 0.7551
loss: 0.5975, acc: 0.7540
loss: 0.6004, acc: 0.7528
> val_acc: 0.7580, val_f1: 0.5935
>> saved: state_dict/ian_restaurant_val_acc0.758
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.5017, acc: 0.7891
loss: 0.4726, acc: 0.8056
loss: 0.4814, acc: 0.8036
loss: 0.5003, acc: 0.7952
loss: 0.5230, acc: 0.7786
loss: 0.5257, acc: 0.7834
loss: 0.5333, acc: 0.7835
loss: 0.5422, acc: 0.7817
loss: 0.5468, acc: 0.7795
loss: 0.5538, acc: 0.7774
loss: 0.5532, acc: 0.7772
> val_acc: 0.7696, val_f1: 0.6143
>> saved: state_dict/ian_restaurant_val_acc0.7696
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.4472, acc: 0.8281
loss: 0.4993, acc: 0.7924
loss: 0.4569, acc: 0.8164
loss: 0.4716, acc: 0.8153
loss: 0.4751, acc: 0.8161
loss: 0.4699, acc: 0.8171
loss: 0.4628, acc: 0.8184
loss: 0.4759, acc: 0.8117
loss: 0.4732, acc: 0.8125
loss: 0.4623, acc: 0.8178
loss: 0.4673, acc: 0.8146
loss: 0.4694, acc: 0.8126
> val_acc: 0.7598, val_f1: 0.6313
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.3831, acc: 0.8250
loss: 0.4079, acc: 0.8297
loss: 0.4039, acc: 0.8344
loss: 0.3969, acc: 0.8352
loss: 0.4088, acc: 0.8287
loss: 0.4279, acc: 0.8250
loss: 0.4378, acc: 0.8210
loss: 0.4441, acc: 0.8180
loss: 0.4431, acc: 0.8170
loss: 0.4420, acc: 0.8191
loss: 0.4547, acc: 0.8176
> val_acc: 0.7696, val_f1: 0.6564
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.3523, acc: 0.8594
loss: 0.3541, acc: 0.8516
loss: 0.3719, acc: 0.8462
loss: 0.3682, acc: 0.8524
loss: 0.3711, acc: 0.8533
loss: 0.3730, acc: 0.8549
loss: 0.3746, acc: 0.8565
loss: 0.3713, acc: 0.8561
loss: 0.3753, acc: 0.8554
loss: 0.3764, acc: 0.8545
loss: 0.3763, acc: 0.8544
> val_acc: 0.7464, val_f1: 0.5683
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.4735, acc: 0.7656
loss: 0.3548, acc: 0.8385
loss: 0.3541, acc: 0.8509
loss: 0.3270, acc: 0.8652
loss: 0.3297, acc: 0.8690
loss: 0.3390, acc: 0.8636
loss: 0.3425, acc: 0.8614
loss: 0.3424, acc: 0.8615
loss: 0.3408, acc: 0.8636
loss: 0.3411, acc: 0.8618
loss: 0.3387, acc: 0.8627
loss: 0.3475, acc: 0.8597
> val_acc: 0.7554, val_f1: 0.6406
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.3079, acc: 0.8633
loss: 0.2737, acc: 0.8941
loss: 0.2811, acc: 0.8929
loss: 0.2820, acc: 0.8947
loss: 0.2810, acc: 0.8939
loss: 0.2799, acc: 0.8939
loss: 0.2874, acc: 0.8906
loss: 0.2948, acc: 0.8870
loss: 0.2952, acc: 0.8864
loss: 0.3049, acc: 0.8830
loss: 0.3060, acc: 0.8819
> val_acc: 0.7607, val_f1: 0.6370
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.1831, acc: 0.9297
loss: 0.2233, acc: 0.9219
loss: 0.2268, acc: 0.9232
loss: 0.2224, acc: 0.9228
loss: 0.2415, acc: 0.9141
loss: 0.2494, acc: 0.9115
loss: 0.2464, acc: 0.9136
loss: 0.2582, acc: 0.9071
loss: 0.2580, acc: 0.9066
loss: 0.2559, acc: 0.9072
loss: 0.2632, acc: 0.9053
loss: 0.2698, acc: 0.9027
> val_acc: 0.7402, val_f1: 0.6187
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.1955, acc: 0.9250
loss: 0.2070, acc: 0.9156
loss: 0.2236, acc: 0.9115
loss: 0.2415, acc: 0.9086
loss: 0.2424, acc: 0.9106
loss: 0.2562, acc: 0.9062
loss: 0.2729, acc: 0.9013
loss: 0.2718, acc: 0.9031
loss: 0.2776, acc: 0.9010
loss: 0.2828, acc: 0.8991
loss: 0.2769, acc: 0.9009
> val_acc: 0.7545, val_f1: 0.6145
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.2096, acc: 0.9427
loss: 0.2256, acc: 0.9238
loss: 0.2191, acc: 0.9291
loss: 0.2220, acc: 0.9253
loss: 0.2164, acc: 0.9246
loss: 0.2306, acc: 0.9185
loss: 0.2341, acc: 0.9162
loss: 0.2335, acc: 0.9157
loss: 0.2331, acc: 0.9157
loss: 0.2409, acc: 0.9137
loss: 0.2372, acc: 0.9151
> val_acc: 0.7339, val_f1: 0.6394
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.1325, acc: 0.9688
loss: 0.1878, acc: 0.9375
loss: 0.1852, acc: 0.9347
loss: 0.1864, acc: 0.9336
loss: 0.1838, acc: 0.9330
loss: 0.1899, acc: 0.9309
loss: 0.1837, acc: 0.9340
loss: 0.1857, acc: 0.9323
loss: 0.1846, acc: 0.9314
loss: 0.1938, acc: 0.9293
loss: 0.1913, acc: 0.9301
loss: 0.1993, acc: 0.9283
> val_acc: 0.7598, val_f1: 0.6515
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.1779, acc: 0.9414
loss: 0.1550, acc: 0.9479
loss: 0.1648, acc: 0.9431
loss: 0.1835, acc: 0.9375
loss: 0.1772, acc: 0.9382
loss: 0.1703, acc: 0.9391
loss: 0.1711, acc: 0.9403
loss: 0.1790, acc: 0.9379
loss: 0.1814, acc: 0.9336
loss: 0.1833, acc: 0.9330
loss: 0.1917, acc: 0.9300
> val_acc: 0.7661, val_f1: 0.6330
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.2278, acc: 0.9219
loss: 0.1623, acc: 0.9442
loss: 0.1679, acc: 0.9401
loss: 0.1869, acc: 0.9347
loss: 0.1920, acc: 0.9297
loss: 0.1881, acc: 0.9323
loss: 0.1838, acc: 0.9346
loss: 0.1974, acc: 0.9320
loss: 0.1987, acc: 0.9327
loss: 0.2060, acc: 0.9299
loss: 0.2154, acc: 0.9243
loss: 0.2197, acc: 0.9210
> val_acc: 0.7589, val_f1: 0.6257
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.2381, acc: 0.9219
loss: 0.2038, acc: 0.9359
loss: 0.1983, acc: 0.9354
loss: 0.2117, acc: 0.9328
loss: 0.2152, acc: 0.9337
loss: 0.2070, acc: 0.9344
loss: 0.1989, acc: 0.9362
loss: 0.1937, acc: 0.9375
loss: 0.1953, acc: 0.9354
loss: 0.1897, acc: 0.9356
loss: 0.1863, acc: 0.9366
> val_acc: 0.7598, val_f1: 0.6458
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.0987, acc: 0.9688
loss: 0.1411, acc: 0.9629
loss: 0.1473, acc: 0.9555
loss: 0.1339, acc: 0.9583
loss: 0.1363, acc: 0.9579
loss: 0.1314, acc: 0.9587
loss: 0.1305, acc: 0.9593
loss: 0.1259, acc: 0.9605
loss: 0.1276, acc: 0.9593
loss: 0.1271, acc: 0.9596
loss: 0.1271, acc: 0.9593
> val_acc: 0.7393, val_f1: 0.6299
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 0.0717, acc: 0.9688
loss: 0.1222, acc: 0.9505
loss: 0.1180, acc: 0.9503
loss: 0.1076, acc: 0.9580
loss: 0.1209, acc: 0.9583
loss: 0.1203, acc: 0.9585
loss: 0.1235, acc: 0.9567
loss: 0.1262, acc: 0.9553
loss: 0.1248, acc: 0.9550
loss: 0.1267, acc: 0.9545
loss: 0.1260, acc: 0.9556
loss: 0.1348, acc: 0.9520
> val_acc: 0.7661, val_f1: 0.6676
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
loss: 0.1378, acc: 0.9492
loss: 0.1482, acc: 0.9497
loss: 0.1329, acc: 0.9565
loss: 0.1367, acc: 0.9548
loss: 0.1411, acc: 0.9512
loss: 0.1536, acc: 0.9488
loss: 0.1514, acc: 0.9485
loss: 0.1517, acc: 0.9487
loss: 0.1580, acc: 0.9474
loss: 0.1598, acc: 0.9467
loss: 0.1584, acc: 0.9473
> val_acc: 0.7652, val_f1: 0.6428
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
loss: 0.0980, acc: 0.9766
loss: 0.0972, acc: 0.9732
loss: 0.1073, acc: 0.9701
loss: 0.1127, acc: 0.9651
loss: 0.1197, acc: 0.9616
loss: 0.1214, acc: 0.9601
loss: 0.1220, acc: 0.9575
loss: 0.1284, acc: 0.9557
loss: 0.1344, acc: 0.9550
loss: 0.1413, acc: 0.9531
loss: 0.1452, acc: 0.9525
loss: 0.1478, acc: 0.9512
> val_acc: 0.7464, val_f1: 0.6315
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 20
loss: 0.2254, acc: 0.9313
loss: 0.1952, acc: 0.9406
loss: 0.1905, acc: 0.9437
loss: 0.1715, acc: 0.9500
loss: 0.1672, acc: 0.9506
loss: 0.1649, acc: 0.9495
loss: 0.1645, acc: 0.9491
loss: 0.1700, acc: 0.9500
loss: 0.1752, acc: 0.9458
loss: 0.1700, acc: 0.9472
loss: 0.1737, acc: 0.9463
> val_acc: 0.7330, val_f1: 0.6124
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 21
loss: 0.1742, acc: 0.9531
loss: 0.1915, acc: 0.9336
loss: 0.1758, acc: 0.9375
loss: 0.1736, acc: 0.9366
loss: 0.1665, acc: 0.9409
loss: 0.1600, acc: 0.9442
loss: 0.1564, acc: 0.9460
loss: 0.1511, acc: 0.9474
loss: 0.1447, acc: 0.9491
loss: 0.1454, acc: 0.9495
loss: 0.1458, acc: 0.9502
> val_acc: 0.7571, val_f1: 0.6396
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 22
loss: 0.1299, acc: 0.9375
loss: 0.0918, acc: 0.9714
loss: 0.0932, acc: 0.9688
loss: 0.0962, acc: 0.9688
loss: 0.0962, acc: 0.9673
loss: 0.0953, acc: 0.9681
loss: 0.1073, acc: 0.9632
loss: 0.1087, acc: 0.9622
loss: 0.1059, acc: 0.9627
loss: 0.1092, acc: 0.9623
loss: 0.1077, acc: 0.9629
loss: 0.1169, acc: 0.9601
> val_acc: 0.7616, val_f1: 0.6391
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 23
loss: 0.0868, acc: 0.9727
loss: 0.1014, acc: 0.9653
loss: 0.0927, acc: 0.9699
loss: 0.0935, acc: 0.9671
loss: 0.0906, acc: 0.9674
loss: 0.0957, acc: 0.9666
loss: 0.1073, acc: 0.9655
loss: 0.1038, acc: 0.9671
loss: 0.1025, acc: 0.9673
loss: 0.1065, acc: 0.9656
loss: 0.1114, acc: 0.9644
> val_acc: 0.7652, val_f1: 0.6495
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 24
loss: 0.0426, acc: 0.9844
loss: 0.0840, acc: 0.9732
loss: 0.1075, acc: 0.9648
loss: 0.1020, acc: 0.9660
loss: 0.0942, acc: 0.9680
loss: 0.0869, acc: 0.9716
loss: 0.0798, acc: 0.9731
loss: 0.0828, acc: 0.9717
loss: 0.0855, acc: 0.9714
loss: 0.0847, acc: 0.9714
loss: 0.0889, acc: 0.9706
loss: 0.0906, acc: 0.9692
> val_acc: 0.7589, val_f1: 0.6514
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 25
loss: 0.0951, acc: 0.9625
loss: 0.0847, acc: 0.9719
loss: 0.0785, acc: 0.9729
loss: 0.0878, acc: 0.9719
loss: 0.0882, acc: 0.9725
loss: 0.0857, acc: 0.9740
loss: 0.0906, acc: 0.9723
loss: 0.0922, acc: 0.9703
loss: 0.0940, acc: 0.9701
loss: 0.1045, acc: 0.9678
loss: 0.1043, acc: 0.9676
> val_acc: 0.7473, val_f1: 0.6234
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 26
loss: 0.1233, acc: 0.9740
loss: 0.1338, acc: 0.9609
loss: 0.1181, acc: 0.9675
loss: 0.1034, acc: 0.9705
loss: 0.0958, acc: 0.9681
loss: 0.0920, acc: 0.9699
loss: 0.0927, acc: 0.9697
loss: 0.0946, acc: 0.9700
loss: 0.0899, acc: 0.9713
loss: 0.1015, acc: 0.9694
loss: 0.0974, acc: 0.9705
> val_acc: 0.7357, val_f1: 0.6129
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 27
loss: 0.0460, acc: 0.9688
loss: 0.0426, acc: 0.9870
loss: 0.0519, acc: 0.9872
loss: 0.0521, acc: 0.9854
loss: 0.0538, acc: 0.9844
loss: 0.0554, acc: 0.9838
loss: 0.0719, acc: 0.9803
loss: 0.0749, acc: 0.9774
loss: 0.0839, acc: 0.9752
loss: 0.0897, acc: 0.9721
loss: 0.0915, acc: 0.9709
loss: 0.0949, acc: 0.9688
> val_acc: 0.7554, val_f1: 0.6246
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 28
loss: 0.0710, acc: 0.9805
loss: 0.1236, acc: 0.9635
loss: 0.1248, acc: 0.9598
loss: 0.1382, acc: 0.9572
loss: 0.1326, acc: 0.9577
loss: 0.1331, acc: 0.9580
loss: 0.1425, acc: 0.9559
loss: 0.1391, acc: 0.9587
loss: 0.1375, acc: 0.9570
loss: 0.1344, acc: 0.9576
loss: 0.1334, acc: 0.9566
> val_acc: 0.7607, val_f1: 0.6377
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 29
loss: 0.0721, acc: 0.9688
loss: 0.0689, acc: 0.9821
loss: 0.0794, acc: 0.9805
loss: 0.0853, acc: 0.9770
loss: 0.0986, acc: 0.9730
loss: 0.1053, acc: 0.9716
loss: 0.1073, acc: 0.9707
loss: 0.1125, acc: 0.9692
loss: 0.1133, acc: 0.9684
loss: 0.1118, acc: 0.9681
loss: 0.1167, acc: 0.9660
loss: 0.1168, acc: 0.9659
> val_acc: 0.7625, val_f1: 0.6406
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 30
loss: 0.0987, acc: 0.9719
loss: 0.1040, acc: 0.9688
loss: 0.0879, acc: 0.9740
loss: 0.0839, acc: 0.9742
loss: 0.0793, acc: 0.9762
loss: 0.0771, acc: 0.9771
loss: 0.0786, acc: 0.9768
loss: 0.0800, acc: 0.9754
loss: 0.0798, acc: 0.9740
loss: 0.0826, acc: 0.9728
loss: 0.0810, acc: 0.9730
> val_acc: 0.7714, val_f1: 0.6514
>> saved: state_dict/ian_restaurant_val_acc0.7714
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 31
loss: 0.0583, acc: 0.9792
loss: 0.0743, acc: 0.9746
loss: 0.0759, acc: 0.9736
loss: 0.0791, acc: 0.9705
loss: 0.0790, acc: 0.9721
loss: 0.0707, acc: 0.9749
loss: 0.0718, acc: 0.9721
loss: 0.0813, acc: 0.9712
loss: 0.0761, acc: 0.9731
loss: 0.0828, acc: 0.9714
loss: 0.0831, acc: 0.9714
> val_acc: 0.7679, val_f1: 0.6529
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 32
loss: 0.0108, acc: 1.0000
loss: 0.0535, acc: 0.9844
loss: 0.0831, acc: 0.9759
loss: 0.0940, acc: 0.9717
loss: 0.0920, acc: 0.9725
loss: 0.0911, acc: 0.9712
loss: 0.0939, acc: 0.9698
loss: 0.0905, acc: 0.9705
loss: 0.0895, acc: 0.9714
loss: 0.0871, acc: 0.9721
loss: 0.0915, acc: 0.9712
loss: 0.0955, acc: 0.9699
> val_acc: 0.7643, val_f1: 0.6562
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 33
loss: 0.1096, acc: 0.9648
loss: 0.1538, acc: 0.9583
loss: 0.1417, acc: 0.9531
loss: 0.1351, acc: 0.9564
loss: 0.1548, acc: 0.9518
loss: 0.1599, acc: 0.9520
loss: 0.1612, acc: 0.9517
loss: 0.1635, acc: 0.9495
loss: 0.1603, acc: 0.9503
loss: 0.1625, acc: 0.9506
loss: 0.1660, acc: 0.9485
> val_acc: 0.7545, val_f1: 0.6504
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 34
loss: 0.1912, acc: 0.9375
loss: 0.1712, acc: 0.9442
loss: 0.1659, acc: 0.9427
loss: 0.1711, acc: 0.9384
loss: 0.1615, acc: 0.9418
loss: 0.1745, acc: 0.9398
loss: 0.1883, acc: 0.9380
loss: 0.1833, acc: 0.9413
loss: 0.1729, acc: 0.9457
loss: 0.1668, acc: 0.9465
loss: 0.1597, acc: 0.9489
loss: 0.1579, acc: 0.9498
> val_acc: 0.7625, val_f1: 0.6445
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 35
loss: 0.0749, acc: 0.9781
loss: 0.0649, acc: 0.9812
loss: 0.0679, acc: 0.9792
loss: 0.0743, acc: 0.9758
loss: 0.0830, acc: 0.9731
loss: 0.0899, acc: 0.9703
loss: 0.0886, acc: 0.9696
loss: 0.0861, acc: 0.9703
loss: 0.0832, acc: 0.9719
loss: 0.0843, acc: 0.9719
loss: 0.0872, acc: 0.9705
> val_acc: 0.7625, val_f1: 0.6536
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 36
loss: 0.0366, acc: 0.9844
loss: 0.0565, acc: 0.9805
loss: 0.0722, acc: 0.9760
loss: 0.0684, acc: 0.9766
loss: 0.0771, acc: 0.9735
loss: 0.0853, acc: 0.9721
loss: 0.0842, acc: 0.9740
loss: 0.0860, acc: 0.9716
loss: 0.0915, acc: 0.9695
loss: 0.0912, acc: 0.9694
loss: 0.0920, acc: 0.9696
> val_acc: 0.7714, val_f1: 0.6562
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 37
loss: 0.0285, acc: 1.0000
loss: 0.0464, acc: 0.9870
loss: 0.0487, acc: 0.9844
loss: 0.0665, acc: 0.9795
loss: 0.0659, acc: 0.9792
loss: 0.0647, acc: 0.9784
loss: 0.0634, acc: 0.9778
loss: 0.0601, acc: 0.9796
loss: 0.0588, acc: 0.9806
loss: 0.0632, acc: 0.9783
loss: 0.0645, acc: 0.9779
loss: 0.0651, acc: 0.9780
> val_acc: 0.7607, val_f1: 0.6434
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 38
loss: 0.0329, acc: 0.9883
loss: 0.0420, acc: 0.9844
loss: 0.0448, acc: 0.9844
loss: 0.0402, acc: 0.9868
loss: 0.0518, acc: 0.9837
loss: 0.0484, acc: 0.9844
loss: 0.0581, acc: 0.9816
loss: 0.0534, acc: 0.9836
loss: 0.0625, acc: 0.9815
loss: 0.0636, acc: 0.9805
loss: 0.0636, acc: 0.9806
> val_acc: 0.7598, val_f1: 0.6493
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 39
loss: 0.0201, acc: 0.9922
loss: 0.0264, acc: 0.9911
loss: 0.0387, acc: 0.9883
loss: 0.0411, acc: 0.9871
loss: 0.0431, acc: 0.9851
loss: 0.0401, acc: 0.9867
loss: 0.0472, acc: 0.9858
loss: 0.0548, acc: 0.9840
loss: 0.0564, acc: 0.9825
loss: 0.0635, acc: 0.9791
loss: 0.0682, acc: 0.9781
loss: 0.0672, acc: 0.9787
> val_acc: 0.7696, val_f1: 0.6542
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 40
loss: 0.0894, acc: 0.9844
loss: 0.0899, acc: 0.9766
loss: 0.0868, acc: 0.9792
loss: 0.0869, acc: 0.9750
loss: 0.0963, acc: 0.9731
loss: 0.0980, acc: 0.9703
loss: 0.1132, acc: 0.9665
loss: 0.1286, acc: 0.9633
loss: 0.1379, acc: 0.9604
loss: 0.1442, acc: 0.9569
loss: 0.1425, acc: 0.9565
> val_acc: 0.7634, val_f1: 0.6347
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 41
loss: 0.0695, acc: 0.9792
loss: 0.0992, acc: 0.9727
loss: 0.0899, acc: 0.9736
loss: 0.0962, acc: 0.9740
loss: 0.1007, acc: 0.9694
loss: 0.0971, acc: 0.9715
loss: 0.1006, acc: 0.9697
loss: 0.1038, acc: 0.9675
loss: 0.1111, acc: 0.9658
loss: 0.1146, acc: 0.9626
loss: 0.1204, acc: 0.9617
> val_acc: 0.7598, val_f1: 0.6225
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 42
loss: 0.1061, acc: 0.9688
loss: 0.1604, acc: 0.9505
loss: 0.1539, acc: 0.9474
loss: 0.1370, acc: 0.9541
loss: 0.1352, acc: 0.9539
loss: 0.1349, acc: 0.9537
loss: 0.1305, acc: 0.9546
loss: 0.1342, acc: 0.9531
loss: 0.1379, acc: 0.9531
loss: 0.1338, acc: 0.9552
loss: 0.1346, acc: 0.9547
loss: 0.1355, acc: 0.9540
> val_acc: 0.7464, val_f1: 0.6244
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 43
loss: 0.0724, acc: 0.9805
loss: 0.0644, acc: 0.9792
loss: 0.0695, acc: 0.9777
loss: 0.0700, acc: 0.9786
loss: 0.0719, acc: 0.9785
loss: 0.0739, acc: 0.9768
loss: 0.0752, acc: 0.9752
loss: 0.0746, acc: 0.9744
loss: 0.0745, acc: 0.9751
loss: 0.0739, acc: 0.9742
loss: 0.0761, acc: 0.9737
> val_acc: 0.7607, val_f1: 0.6367
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 44
loss: 0.0642, acc: 0.9766
loss: 0.0846, acc: 0.9710
loss: 0.0712, acc: 0.9753
loss: 0.0693, acc: 0.9743
loss: 0.0743, acc: 0.9751
loss: 0.0691, acc: 0.9780
loss: 0.0798, acc: 0.9751
loss: 0.0897, acc: 0.9730
loss: 0.0949, acc: 0.9699
loss: 0.0949, acc: 0.9694
loss: 0.0973, acc: 0.9688
loss: 0.1057, acc: 0.9667
> val_acc: 0.7473, val_f1: 0.6311
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 45
loss: 0.1352, acc: 0.9594
loss: 0.1464, acc: 0.9656
loss: 0.1417, acc: 0.9594
loss: 0.1465, acc: 0.9523
loss: 0.1438, acc: 0.9531
loss: 0.1385, acc: 0.9563
loss: 0.1392, acc: 0.9558
loss: 0.1470, acc: 0.9520
loss: 0.1492, acc: 0.9503
loss: 0.1544, acc: 0.9484
loss: 0.1597, acc: 0.9460
> val_acc: 0.7491, val_f1: 0.6154
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 46
loss: 0.1057, acc: 0.9531
loss: 0.1052, acc: 0.9688
loss: 0.1027, acc: 0.9675
loss: 0.1134, acc: 0.9635
loss: 0.1069, acc: 0.9674
loss: 0.1120, acc: 0.9654
loss: 0.1124, acc: 0.9645
loss: 0.1132, acc: 0.9646
loss: 0.1155, acc: 0.9633
loss: 0.1173, acc: 0.9632
loss: 0.1178, acc: 0.9617
> val_acc: 0.7286, val_f1: 0.6187
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 47
loss: 0.0670, acc: 0.9844
loss: 0.0967, acc: 0.9661
loss: 0.0756, acc: 0.9759
loss: 0.0894, acc: 0.9697
loss: 0.0973, acc: 0.9680
loss: 0.1032, acc: 0.9633
loss: 0.1224, acc: 0.9607
loss: 0.1201, acc: 0.9609
loss: 0.1220, acc: 0.9607
loss: 0.1298, acc: 0.9589
loss: 0.1361, acc: 0.9574
loss: 0.1368, acc: 0.9568
> val_acc: 0.7571, val_f1: 0.6311
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 48
loss: 0.1557, acc: 0.9609
loss: 0.1853, acc: 0.9479
loss: 0.1721, acc: 0.9431
loss: 0.1600, acc: 0.9507
loss: 0.1559, acc: 0.9512
loss: 0.1523, acc: 0.9558
loss: 0.1526, acc: 0.9540
loss: 0.1519, acc: 0.9551
loss: 0.1515, acc: 0.9545
loss: 0.1447, acc: 0.9563
loss: 0.1424, acc: 0.9580
> val_acc: 0.7518, val_f1: 0.6258
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 49
loss: 0.1058, acc: 0.9766
loss: 0.0923, acc: 0.9710
loss: 0.0844, acc: 0.9740
loss: 0.0961, acc: 0.9651
loss: 0.0876, acc: 0.9702
loss: 0.0961, acc: 0.9682
loss: 0.0983, acc: 0.9683
loss: 0.1003, acc: 0.9675
loss: 0.1054, acc: 0.9658
loss: 0.1086, acc: 0.9654
loss: 0.1137, acc: 0.9633
loss: 0.1153, acc: 0.9626
> val_acc: 0.7500, val_f1: 0.6208
>> test_acc: 0.7714, test_f1: 0.6514
