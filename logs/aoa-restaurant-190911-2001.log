cuda memory allocated: 16861696
n_trainable_params: 2891403, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: aoa
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x0000022771A68730>
>>> learning_rate: 0.001
>>> dropout: 0.1
>>> l2reg: 0.01
>>> num_epoch: 50
>>> batch_size: 64
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: None
>>> valset_ratio: 0
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.aoa.AOA'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 0.9933, acc: 0.5844
loss: 0.9818, acc: 0.5984
loss: 0.9752, acc: 0.5969
loss: 0.9826, acc: 0.5867
loss: 0.9817, acc: 0.5856
loss: 0.9820, acc: 0.5880
loss: 0.9767, acc: 0.5942
loss: 0.9737, acc: 0.5973
loss: 0.9718, acc: 0.5962
loss: 0.9716, acc: 0.5966
loss: 0.9694, acc: 0.5972
> val_acc: 0.6500, val_f1: 0.2626
>> saved: state_dict/aoa_restaurant_val_acc0.65
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.9931, acc: 0.5625
loss: 0.9841, acc: 0.5703
loss: 0.9682, acc: 0.5793
loss: 0.9623, acc: 0.5833
loss: 0.9634, acc: 0.5802
loss: 0.9538, acc: 0.5915
loss: 0.9527, acc: 0.5914
loss: 0.9569, acc: 0.5859
loss: 0.9530, acc: 0.5898
loss: 0.9508, acc: 0.5928
loss: 0.9483, acc: 0.5943
> val_acc: 0.6500, val_f1: 0.2626
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.8202, acc: 0.6719
loss: 0.8863, acc: 0.6406
loss: 0.9132, acc: 0.6179
loss: 0.9225, acc: 0.6074
loss: 0.9203, acc: 0.6116
loss: 0.9168, acc: 0.6118
loss: 0.9154, acc: 0.6119
loss: 0.9195, acc: 0.6063
loss: 0.9217, acc: 0.6029
loss: 0.9259, acc: 0.5988
loss: 0.9225, acc: 0.6014
loss: 0.9215, acc: 0.6004
> val_acc: 0.6500, val_f1: 0.2626
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.9642, acc: 0.5391
loss: 0.9383, acc: 0.5677
loss: 0.9253, acc: 0.5781
loss: 0.9151, acc: 0.5921
loss: 0.9028, acc: 0.5983
loss: 0.8990, acc: 0.6002
loss: 0.9051, acc: 0.5915
loss: 0.9005, acc: 0.5966
loss: 0.9004, acc: 0.5959
loss: 0.8938, acc: 0.6008
loss: 0.8908, acc: 0.6027
> val_acc: 0.6545, val_f1: 0.2832
>> saved: state_dict/aoa_restaurant_val_acc0.6545
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.9174, acc: 0.5469
loss: 0.9157, acc: 0.5714
loss: 0.8924, acc: 0.5964
loss: 0.8848, acc: 0.5993
loss: 0.8836, acc: 0.5966
loss: 0.8763, acc: 0.6036
loss: 0.8780, acc: 0.6021
loss: 0.8725, acc: 0.6047
loss: 0.8677, acc: 0.6079
loss: 0.8650, acc: 0.6104
loss: 0.8612, acc: 0.6112
loss: 0.8589, acc: 0.6131
> val_acc: 0.6634, val_f1: 0.3183
>> saved: state_dict/aoa_restaurant_val_acc0.6634
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.8028, acc: 0.6531
loss: 0.8234, acc: 0.6344
loss: 0.8260, acc: 0.6396
loss: 0.8321, acc: 0.6344
loss: 0.8194, acc: 0.6444
loss: 0.8190, acc: 0.6427
loss: 0.8255, acc: 0.6379
loss: 0.8254, acc: 0.6367
loss: 0.8206, acc: 0.6392
loss: 0.8180, acc: 0.6388
loss: 0.8216, acc: 0.6358
> val_acc: 0.6946, val_f1: 0.4376
>> saved: state_dict/aoa_restaurant_val_acc0.6946
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.8541, acc: 0.6250
loss: 0.8465, acc: 0.6270
loss: 0.8247, acc: 0.6454
loss: 0.8320, acc: 0.6363
loss: 0.8182, acc: 0.6393
loss: 0.8132, acc: 0.6373
loss: 0.8069, acc: 0.6420
loss: 0.8096, acc: 0.6439
loss: 0.8079, acc: 0.6414
loss: 0.8056, acc: 0.6426
loss: 0.8036, acc: 0.6442
> val_acc: 0.6973, val_f1: 0.4273
>> saved: state_dict/aoa_restaurant_val_acc0.6973
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.8488, acc: 0.6094
loss: 0.7810, acc: 0.6510
loss: 0.7679, acc: 0.6676
loss: 0.7734, acc: 0.6680
loss: 0.7815, acc: 0.6644
loss: 0.7719, acc: 0.6731
loss: 0.7754, acc: 0.6673
loss: 0.7820, acc: 0.6619
loss: 0.7862, acc: 0.6582
loss: 0.7898, acc: 0.6535
loss: 0.7936, acc: 0.6498
loss: 0.7910, acc: 0.6518
> val_acc: 0.6937, val_f1: 0.4124
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.7042, acc: 0.7109
loss: 0.7735, acc: 0.6649
loss: 0.7565, acc: 0.6797
loss: 0.7629, acc: 0.6678
loss: 0.7845, acc: 0.6562
loss: 0.7782, acc: 0.6622
loss: 0.7804, acc: 0.6585
loss: 0.7775, acc: 0.6587
loss: 0.7825, acc: 0.6534
loss: 0.7794, acc: 0.6521
loss: 0.7798, acc: 0.6536
> val_acc: 0.7107, val_f1: 0.4580
>> saved: state_dict/aoa_restaurant_val_acc0.7107
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.8220, acc: 0.6406
loss: 0.7990, acc: 0.6384
loss: 0.7899, acc: 0.6510
loss: 0.7790, acc: 0.6627
loss: 0.7763, acc: 0.6705
loss: 0.7810, acc: 0.6615
loss: 0.7963, acc: 0.6504
loss: 0.7845, acc: 0.6567
loss: 0.7843, acc: 0.6574
loss: 0.7860, acc: 0.6546
loss: 0.7848, acc: 0.6566
loss: 0.7774, acc: 0.6624
> val_acc: 0.7054, val_f1: 0.4449
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.7592, acc: 0.6875
loss: 0.7530, acc: 0.6891
loss: 0.7390, acc: 0.6844
loss: 0.7580, acc: 0.6687
loss: 0.7651, acc: 0.6663
loss: 0.7644, acc: 0.6719
loss: 0.7657, acc: 0.6683
loss: 0.7687, acc: 0.6633
loss: 0.7601, acc: 0.6701
loss: 0.7636, acc: 0.6691
loss: 0.7690, acc: 0.6645
> val_acc: 0.7179, val_f1: 0.4651
>> saved: state_dict/aoa_restaurant_val_acc0.7179
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.7343, acc: 0.6979
loss: 0.7551, acc: 0.6855
loss: 0.7506, acc: 0.6743
loss: 0.7564, acc: 0.6745
loss: 0.7733, acc: 0.6617
loss: 0.7660, acc: 0.6663
loss: 0.7773, acc: 0.6562
loss: 0.7670, acc: 0.6616
loss: 0.7697, acc: 0.6621
loss: 0.7675, acc: 0.6637
loss: 0.7677, acc: 0.6642
> val_acc: 0.6946, val_f1: 0.4128
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.8964, acc: 0.5781
loss: 0.8026, acc: 0.6484
loss: 0.7670, acc: 0.6648
loss: 0.7693, acc: 0.6621
loss: 0.7903, acc: 0.6473
loss: 0.7706, acc: 0.6593
loss: 0.7696, acc: 0.6603
loss: 0.7599, acc: 0.6658
loss: 0.7636, acc: 0.6635
loss: 0.7591, acc: 0.6661
loss: 0.7628, acc: 0.6664
loss: 0.7570, acc: 0.6699
> val_acc: 0.7232, val_f1: 0.4741
>> saved: state_dict/aoa_restaurant_val_acc0.7232
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.7219, acc: 0.6797
loss: 0.7348, acc: 0.6858
loss: 0.7447, acc: 0.6741
loss: 0.7387, acc: 0.6760
loss: 0.7479, acc: 0.6738
loss: 0.7386, acc: 0.6800
loss: 0.7457, acc: 0.6742
loss: 0.7452, acc: 0.6763
loss: 0.7415, acc: 0.6751
loss: 0.7463, acc: 0.6760
loss: 0.7479, acc: 0.6753
> val_acc: 0.7063, val_f1: 0.4690
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.7976, acc: 0.6875
loss: 0.7566, acc: 0.7009
loss: 0.7345, acc: 0.6979
loss: 0.7471, acc: 0.6829
loss: 0.7456, acc: 0.6832
loss: 0.7505, acc: 0.6840
loss: 0.7522, acc: 0.6821
loss: 0.7447, acc: 0.6812
loss: 0.7458, acc: 0.6830
loss: 0.7460, acc: 0.6828
loss: 0.7445, acc: 0.6821
loss: 0.7477, acc: 0.6790
> val_acc: 0.7098, val_f1: 0.4683
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.7192, acc: 0.6937
loss: 0.7215, acc: 0.7016
loss: 0.7613, acc: 0.6740
loss: 0.7698, acc: 0.6687
loss: 0.7593, acc: 0.6744
loss: 0.7613, acc: 0.6687
loss: 0.7509, acc: 0.6737
loss: 0.7439, acc: 0.6770
loss: 0.7440, acc: 0.6764
loss: 0.7454, acc: 0.6769
loss: 0.7442, acc: 0.6776
> val_acc: 0.6982, val_f1: 0.4166
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.8214, acc: 0.6406
loss: 0.7505, acc: 0.6758
loss: 0.7563, acc: 0.6695
loss: 0.7634, acc: 0.6736
loss: 0.7546, acc: 0.6807
loss: 0.7499, acc: 0.6769
loss: 0.7422, acc: 0.6780
loss: 0.7433, acc: 0.6797
loss: 0.7393, acc: 0.6810
loss: 0.7452, acc: 0.6777
loss: 0.7419, acc: 0.6784
> val_acc: 0.7205, val_f1: 0.4681
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 0.7582, acc: 0.6719
loss: 0.7331, acc: 0.6849
loss: 0.7235, acc: 0.6932
loss: 0.7284, acc: 0.6816
loss: 0.7353, acc: 0.6778
loss: 0.7332, acc: 0.6809
loss: 0.7273, acc: 0.6875
loss: 0.7268, acc: 0.6901
loss: 0.7418, acc: 0.6772
loss: 0.7432, acc: 0.6790
loss: 0.7394, acc: 0.6798
loss: 0.7379, acc: 0.6822
> val_acc: 0.7232, val_f1: 0.4700
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
loss: 0.6851, acc: 0.6836
loss: 0.7404, acc: 0.6615
loss: 0.7579, acc: 0.6551
loss: 0.7631, acc: 0.6604
loss: 0.7500, acc: 0.6699
loss: 0.7430, acc: 0.6767
loss: 0.7325, acc: 0.6843
loss: 0.7267, acc: 0.6879
loss: 0.7274, acc: 0.6903
loss: 0.7314, acc: 0.6865
loss: 0.7359, acc: 0.6820
> val_acc: 0.7241, val_f1: 0.4843
>> saved: state_dict/aoa_restaurant_val_acc0.7241
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
loss: 0.7420, acc: 0.6953
loss: 0.7515, acc: 0.6696
loss: 0.7411, acc: 0.6784
loss: 0.7259, acc: 0.6893
loss: 0.7239, acc: 0.6896
loss: 0.7251, acc: 0.6910
loss: 0.7204, acc: 0.6929
loss: 0.7246, acc: 0.6905
loss: 0.7303, acc: 0.6856
loss: 0.7303, acc: 0.6875
loss: 0.7305, acc: 0.6863
loss: 0.7312, acc: 0.6857
> val_acc: 0.7250, val_f1: 0.4785
>> saved: state_dict/aoa_restaurant_val_acc0.725
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 20
loss: 0.7370, acc: 0.6906
loss: 0.7669, acc: 0.6703
loss: 0.7708, acc: 0.6687
loss: 0.7632, acc: 0.6742
loss: 0.7504, acc: 0.6756
loss: 0.7425, acc: 0.6792
loss: 0.7404, acc: 0.6808
loss: 0.7424, acc: 0.6777
loss: 0.7388, acc: 0.6830
loss: 0.7343, acc: 0.6828
loss: 0.7321, acc: 0.6858
> val_acc: 0.7214, val_f1: 0.4687
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 21
loss: 0.7068, acc: 0.7083
loss: 0.7305, acc: 0.6914
loss: 0.7545, acc: 0.6731
loss: 0.7286, acc: 0.6858
loss: 0.7225, acc: 0.6875
loss: 0.7315, acc: 0.6797
loss: 0.7329, acc: 0.6790
loss: 0.7304, acc: 0.6817
loss: 0.7360, acc: 0.6813
loss: 0.7342, acc: 0.6823
loss: 0.7337, acc: 0.6816
> val_acc: 0.7277, val_f1: 0.4869
>> saved: state_dict/aoa_restaurant_val_acc0.7277
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 22
loss: 0.7246, acc: 0.7031
loss: 0.7553, acc: 0.6615
loss: 0.7531, acc: 0.6591
loss: 0.7600, acc: 0.6631
loss: 0.7395, acc: 0.6786
loss: 0.7448, acc: 0.6755
loss: 0.7391, acc: 0.6799
loss: 0.7302, acc: 0.6858
loss: 0.7241, acc: 0.6886
loss: 0.7238, acc: 0.6865
loss: 0.7262, acc: 0.6850
loss: 0.7274, acc: 0.6842
> val_acc: 0.7241, val_f1: 0.4840
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 23
loss: 0.7433, acc: 0.6992
loss: 0.7308, acc: 0.6962
loss: 0.7274, acc: 0.6897
loss: 0.7286, acc: 0.6867
loss: 0.7291, acc: 0.6810
loss: 0.7252, acc: 0.6848
loss: 0.7264, acc: 0.6847
loss: 0.7240, acc: 0.6835
loss: 0.7243, acc: 0.6861
loss: 0.7247, acc: 0.6859
loss: 0.7275, acc: 0.6855
> val_acc: 0.7196, val_f1: 0.4682
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 24
loss: 0.7189, acc: 0.6797
loss: 0.7463, acc: 0.6652
loss: 0.7349, acc: 0.6745
loss: 0.7438, acc: 0.6756
loss: 0.7251, acc: 0.6882
loss: 0.7293, acc: 0.6869
loss: 0.7223, acc: 0.6904
loss: 0.7237, acc: 0.6900
loss: 0.7266, acc: 0.6905
loss: 0.7283, acc: 0.6888
loss: 0.7290, acc: 0.6869
loss: 0.7231, acc: 0.6912
> val_acc: 0.7018, val_f1: 0.4222
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 25
loss: 0.7649, acc: 0.6406
loss: 0.7423, acc: 0.6781
loss: 0.7561, acc: 0.6677
loss: 0.7400, acc: 0.6758
loss: 0.7417, acc: 0.6731
loss: 0.7452, acc: 0.6724
loss: 0.7359, acc: 0.6772
loss: 0.7288, acc: 0.6777
loss: 0.7193, acc: 0.6872
loss: 0.7219, acc: 0.6859
loss: 0.7223, acc: 0.6898
> val_acc: 0.7223, val_f1: 0.4727
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 26
loss: 0.7695, acc: 0.6615
loss: 0.7089, acc: 0.7012
loss: 0.7139, acc: 0.6911
loss: 0.7125, acc: 0.6970
loss: 0.7228, acc: 0.6936
loss: 0.7199, acc: 0.6914
loss: 0.7155, acc: 0.6951
loss: 0.7187, acc: 0.6920
loss: 0.7128, acc: 0.6955
loss: 0.7152, acc: 0.6924
loss: 0.7188, acc: 0.6875
> val_acc: 0.7080, val_f1: 0.4414
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 27
loss: 0.6588, acc: 0.7031
loss: 0.7171, acc: 0.6875
loss: 0.7020, acc: 0.6946
loss: 0.7079, acc: 0.6934
loss: 0.7069, acc: 0.6972
loss: 0.7081, acc: 0.6971
loss: 0.7062, acc: 0.6951
loss: 0.7126, acc: 0.6897
loss: 0.7202, acc: 0.6883
loss: 0.7287, acc: 0.6875
loss: 0.7243, acc: 0.6896
loss: 0.7217, acc: 0.6889
> val_acc: 0.7295, val_f1: 0.4928
>> saved: state_dict/aoa_restaurant_val_acc0.7295
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 28
loss: 0.7248, acc: 0.6680
loss: 0.7183, acc: 0.6944
loss: 0.7068, acc: 0.6975
loss: 0.7120, acc: 0.6974
loss: 0.7125, acc: 0.6927
loss: 0.7216, acc: 0.6848
loss: 0.7250, acc: 0.6843
loss: 0.7329, acc: 0.6799
loss: 0.7316, acc: 0.6815
loss: 0.7283, acc: 0.6827
loss: 0.7203, acc: 0.6889
> val_acc: 0.7241, val_f1: 0.4778
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 29
loss: 0.6031, acc: 0.7500
loss: 0.6612, acc: 0.7277
loss: 0.6907, acc: 0.7031
loss: 0.6964, acc: 0.7004
loss: 0.7078, acc: 0.6960
loss: 0.7090, acc: 0.6985
loss: 0.7043, acc: 0.7017
loss: 0.7070, acc: 0.7006
loss: 0.7079, acc: 0.7005
loss: 0.7104, acc: 0.7008
loss: 0.7138, acc: 0.6971
loss: 0.7147, acc: 0.6943
> val_acc: 0.7268, val_f1: 0.4923
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 30
loss: 0.7138, acc: 0.6844
loss: 0.6869, acc: 0.7000
loss: 0.6885, acc: 0.7063
loss: 0.6865, acc: 0.7070
loss: 0.6927, acc: 0.7025
loss: 0.6955, acc: 0.7021
loss: 0.7025, acc: 0.6964
loss: 0.7052, acc: 0.6969
loss: 0.7097, acc: 0.6965
loss: 0.7157, acc: 0.6919
loss: 0.7155, acc: 0.6906
> val_acc: 0.7268, val_f1: 0.4862
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 31
loss: 0.6541, acc: 0.7344
loss: 0.6798, acc: 0.7109
loss: 0.6971, acc: 0.6995
loss: 0.6910, acc: 0.7049
loss: 0.6955, acc: 0.7031
loss: 0.6933, acc: 0.7042
loss: 0.6998, acc: 0.7017
loss: 0.7058, acc: 0.6978
loss: 0.7056, acc: 0.6977
loss: 0.7042, acc: 0.6982
loss: 0.7057, acc: 0.6966
> val_acc: 0.7330, val_f1: 0.4970
>> saved: state_dict/aoa_restaurant_val_acc0.733
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 32
loss: 0.8488, acc: 0.5625
loss: 0.7366, acc: 0.6693
loss: 0.6999, acc: 0.7131
loss: 0.7275, acc: 0.6934
loss: 0.7275, acc: 0.6882
loss: 0.7233, acc: 0.6851
loss: 0.7306, acc: 0.6804
loss: 0.7163, acc: 0.6875
loss: 0.7192, acc: 0.6875
loss: 0.7202, acc: 0.6892
loss: 0.7210, acc: 0.6893
loss: 0.7149, acc: 0.6925
> val_acc: 0.7214, val_f1: 0.4919
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 33
loss: 0.6890, acc: 0.7188
loss: 0.7037, acc: 0.7049
loss: 0.7114, acc: 0.6953
loss: 0.7150, acc: 0.6957
loss: 0.7098, acc: 0.6953
loss: 0.7110, acc: 0.6950
loss: 0.7117, acc: 0.6949
loss: 0.7152, acc: 0.6923
loss: 0.7118, acc: 0.6960
loss: 0.7099, acc: 0.6964
loss: 0.7110, acc: 0.6950
> val_acc: 0.7170, val_f1: 0.4869
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 34
loss: 0.7924, acc: 0.6172
loss: 0.7386, acc: 0.6808
loss: 0.7242, acc: 0.6862
loss: 0.7338, acc: 0.6866
loss: 0.7269, acc: 0.6896
loss: 0.7236, acc: 0.6916
loss: 0.7200, acc: 0.6943
loss: 0.7143, acc: 0.6972
loss: 0.7099, acc: 0.6998
loss: 0.7111, acc: 0.6988
loss: 0.7105, acc: 0.6980
loss: 0.7097, acc: 0.6982
> val_acc: 0.7241, val_f1: 0.4847
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 35
loss: 0.6860, acc: 0.7250
loss: 0.6925, acc: 0.7156
loss: 0.6993, acc: 0.7115
loss: 0.7051, acc: 0.7047
loss: 0.6959, acc: 0.7087
loss: 0.6968, acc: 0.7026
loss: 0.7029, acc: 0.6996
loss: 0.7059, acc: 0.6953
loss: 0.7065, acc: 0.6948
loss: 0.7077, acc: 0.6956
loss: 0.7106, acc: 0.6955
> val_acc: 0.7304, val_f1: 0.4959
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 36
loss: 0.6701, acc: 0.6927
loss: 0.6656, acc: 0.7109
loss: 0.6791, acc: 0.7019
loss: 0.7000, acc: 0.6944
loss: 0.6929, acc: 0.6963
loss: 0.6982, acc: 0.6975
loss: 0.6995, acc: 0.6979
loss: 0.7063, acc: 0.6949
loss: 0.7070, acc: 0.6937
loss: 0.7002, acc: 0.6973
loss: 0.7042, acc: 0.6934
> val_acc: 0.7196, val_f1: 0.4940
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 37
loss: 0.6206, acc: 0.7969
loss: 0.6320, acc: 0.7370
loss: 0.6566, acc: 0.7344
loss: 0.6793, acc: 0.7148
loss: 0.6804, acc: 0.7113
loss: 0.6900, acc: 0.7049
loss: 0.6961, acc: 0.7016
loss: 0.7068, acc: 0.6975
loss: 0.7090, acc: 0.6982
loss: 0.7100, acc: 0.6987
loss: 0.7069, acc: 0.6991
loss: 0.7085, acc: 0.6973
> val_acc: 0.7259, val_f1: 0.4906
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 38
loss: 0.6034, acc: 0.7852
loss: 0.6651, acc: 0.7361
loss: 0.6702, acc: 0.7366
loss: 0.6767, acc: 0.7237
loss: 0.6880, acc: 0.7109
loss: 0.6841, acc: 0.7101
loss: 0.6965, acc: 0.7017
loss: 0.6946, acc: 0.7051
loss: 0.7001, acc: 0.7003
loss: 0.7001, acc: 0.6990
loss: 0.7009, acc: 0.6982
> val_acc: 0.7330, val_f1: 0.4984
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 39
loss: 0.7172, acc: 0.6641
loss: 0.7179, acc: 0.6897
loss: 0.6849, acc: 0.7070
loss: 0.6962, acc: 0.7031
loss: 0.6956, acc: 0.7038
loss: 0.7069, acc: 0.6939
loss: 0.7012, acc: 0.6997
loss: 0.7011, acc: 0.7031
loss: 0.6990, acc: 0.7028
loss: 0.6978, acc: 0.7048
loss: 0.6992, acc: 0.7013
loss: 0.7024, acc: 0.6998
> val_acc: 0.7312, val_f1: 0.4913
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 40
loss: 0.7237, acc: 0.6750
loss: 0.7418, acc: 0.6625
loss: 0.7403, acc: 0.6729
loss: 0.7173, acc: 0.6914
loss: 0.7151, acc: 0.6931
loss: 0.7150, acc: 0.6979
loss: 0.7067, acc: 0.6987
loss: 0.7106, acc: 0.6969
loss: 0.7063, acc: 0.6997
loss: 0.7010, acc: 0.7009
loss: 0.7026, acc: 0.6994
> val_acc: 0.7321, val_f1: 0.4945
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 41
loss: 0.6939, acc: 0.7135
loss: 0.6909, acc: 0.7129
loss: 0.7009, acc: 0.7127
loss: 0.7109, acc: 0.7135
loss: 0.7157, acc: 0.7065
loss: 0.7220, acc: 0.7020
loss: 0.7171, acc: 0.7008
loss: 0.7084, acc: 0.7031
loss: 0.7068, acc: 0.7042
loss: 0.7028, acc: 0.7051
loss: 0.7023, acc: 0.7043
> val_acc: 0.7312, val_f1: 0.4995
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 42
loss: 0.6192, acc: 0.7500
loss: 0.6766, acc: 0.7161
loss: 0.6820, acc: 0.7159
loss: 0.7158, acc: 0.6982
loss: 0.7205, acc: 0.6920
loss: 0.7100, acc: 0.6953
loss: 0.7103, acc: 0.6946
loss: 0.7094, acc: 0.6957
loss: 0.7003, acc: 0.7020
loss: 0.7047, acc: 0.6990
loss: 0.7050, acc: 0.6970
loss: 0.7017, acc: 0.6989
> val_acc: 0.7304, val_f1: 0.4945
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 43
loss: 0.7752, acc: 0.6445
loss: 0.7472, acc: 0.6580
loss: 0.7570, acc: 0.6585
loss: 0.7461, acc: 0.6669
loss: 0.7275, acc: 0.6764
loss: 0.7191, acc: 0.6859
loss: 0.7181, acc: 0.6861
loss: 0.7032, acc: 0.6971
loss: 0.7057, acc: 0.6953
loss: 0.7067, acc: 0.6961
loss: 0.7032, acc: 0.6970
> val_acc: 0.7286, val_f1: 0.4937
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 44
loss: 0.6654, acc: 0.7344
loss: 0.7018, acc: 0.7031
loss: 0.6985, acc: 0.7096
loss: 0.6849, acc: 0.7105
loss: 0.6763, acc: 0.7159
loss: 0.6865, acc: 0.7031
loss: 0.6923, acc: 0.6968
loss: 0.6981, acc: 0.6913
loss: 0.6994, acc: 0.6901
loss: 0.6977, acc: 0.6925
loss: 0.7011, acc: 0.6944
loss: 0.6998, acc: 0.6965
> val_acc: 0.7339, val_f1: 0.4984
>> saved: state_dict/aoa_restaurant_val_acc0.7339
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 45
loss: 0.6474, acc: 0.7469
loss: 0.6273, acc: 0.7359
loss: 0.6710, acc: 0.7094
loss: 0.6786, acc: 0.7086
loss: 0.6898, acc: 0.7069
loss: 0.7057, acc: 0.7026
loss: 0.7058, acc: 0.6969
loss: 0.7076, acc: 0.6930
loss: 0.7025, acc: 0.6979
loss: 0.7005, acc: 0.7000
loss: 0.6969, acc: 0.7040
> val_acc: 0.7321, val_f1: 0.4937
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 46
loss: 0.7248, acc: 0.6979
loss: 0.7249, acc: 0.6875
loss: 0.7382, acc: 0.6755
loss: 0.7143, acc: 0.6892
loss: 0.7126, acc: 0.6895
loss: 0.7039, acc: 0.6931
loss: 0.7136, acc: 0.6899
loss: 0.7058, acc: 0.6961
loss: 0.6962, acc: 0.7035
loss: 0.6942, acc: 0.7038
loss: 0.6941, acc: 0.7022
> val_acc: 0.7330, val_f1: 0.5006
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 47
loss: 0.6786, acc: 0.6875
loss: 0.7013, acc: 0.6953
loss: 0.6993, acc: 0.6847
loss: 0.6991, acc: 0.6885
loss: 0.7085, acc: 0.6808
loss: 0.6942, acc: 0.6911
loss: 0.6897, acc: 0.6956
loss: 0.6844, acc: 0.7018
loss: 0.6893, acc: 0.7005
loss: 0.6926, acc: 0.7004
loss: 0.6898, acc: 0.7028
loss: 0.6932, acc: 0.7020
> val_acc: 0.7286, val_f1: 0.4816
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 48
loss: 0.7527, acc: 0.6641
loss: 0.7424, acc: 0.6788
loss: 0.7192, acc: 0.6897
loss: 0.7022, acc: 0.6924
loss: 0.7093, acc: 0.6895
loss: 0.7049, acc: 0.6929
loss: 0.6999, acc: 0.6981
loss: 0.6966, acc: 0.7007
loss: 0.6931, acc: 0.7028
loss: 0.6867, acc: 0.7060
loss: 0.6909, acc: 0.7034
> val_acc: 0.7330, val_f1: 0.4903
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 49
loss: 0.6513, acc: 0.7031
loss: 0.7000, acc: 0.6763
loss: 0.7024, acc: 0.6901
loss: 0.7035, acc: 0.6912
loss: 0.7062, acc: 0.6896
loss: 0.7037, acc: 0.6939
loss: 0.7026, acc: 0.6973
loss: 0.7038, acc: 0.6930
loss: 0.6978, acc: 0.6983
loss: 0.6999, acc: 0.6985
loss: 0.6957, acc: 0.6998
loss: 0.6932, acc: 0.7032
> val_acc: 0.7304, val_f1: 0.4831
>> test_acc: 0.7339, test_f1: 0.4984
