cuda memory allocated: 4711936
n_trainable_params: 288503, n_nontrainable_params: 883732
> training arguments:
>>> model_name: gc_embed
>>> model_ver: 1
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adamax.Adamax'>
>>> initializer: <function xavier_uniform_ at 0x0000014561913E18>
>>> learning_rate: 0.001
>>> momentum: 0.95
>>> dropout: 0.6
>>> l2reg: 5e-05
>>> num_epoch: 200
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 236
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> embeddings: gd
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 0
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 25
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> position_dim: 100
>>> stanford_pos_model: C:/NLP_Programs/stanford-postagger-2018-10-16/models/english-bidirectional-distsim.tagger
>>> stanford_pos_jar: C:/NLP_Programs/stanford-postagger-2018-10-16/stanford-postagger.jar
>>> glove_path: ./embeddings/glove.840B.300d.txt
>>> embedding_matrix_path: gen_data/embeddings/200_restaurant_glove_domain_embedding_matrix.dat
>>> model_class: <class 'models.gc_embed.GC_EMBED1'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices', 'pos_indices', 'aspect_pos_indices', 'position_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.5212, acc: 0.3063
loss: 1.3738, acc: 0.3594
loss: 1.2857, acc: 0.4208
loss: 1.2144, acc: 0.4641
loss: 1.2120, acc: 0.4788
loss: 1.1788, acc: 0.4958
loss: 1.1575, acc: 0.5134
loss: 1.1439, acc: 0.5203
loss: 1.1266, acc: 0.5271
loss: 1.1191, acc: 0.5294
loss: 1.1099, acc: 0.5318
loss: 1.1114, acc: 0.5255
loss: 1.1036, acc: 0.5269
loss: 1.0997, acc: 0.5299
loss: 1.1037, acc: 0.5271
loss: 1.0961, acc: 0.5297
loss: 1.0947, acc: 0.5312
loss: 1.0886, acc: 0.5330
loss: 1.0847, acc: 0.5339
loss: 1.0815, acc: 0.5356
loss: 1.0782, acc: 0.5369
loss: 1.0748, acc: 0.5386
> val_acc: 0.6500, val_f1: 0.2626
>> saved: state_dict/gc_embed_restaurant_val_acc0.65
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.9694, acc: 0.5938
loss: 0.9840, acc: 0.5714
loss: 1.0286, acc: 0.5625
loss: 1.0140, acc: 0.5588
loss: 1.0081, acc: 0.5497
loss: 0.9925, acc: 0.5509
loss: 0.9971, acc: 0.5459
loss: 1.0012, acc: 0.5397
loss: 0.9948, acc: 0.5484
loss: 0.9901, acc: 0.5505
loss: 0.9842, acc: 0.5523
loss: 0.9728, acc: 0.5609
loss: 0.9673, acc: 0.5645
loss: 0.9596, acc: 0.5732
loss: 0.9591, acc: 0.5742
loss: 0.9599, acc: 0.5767
loss: 0.9584, acc: 0.5800
loss: 0.9534, acc: 0.5815
loss: 0.9557, acc: 0.5798
loss: 0.9539, acc: 0.5799
loss: 0.9515, acc: 0.5790
loss: 0.9515, acc: 0.5774
loss: 0.9497, acc: 0.5776
> val_acc: 0.6696, val_f1: 0.3340
>> saved: state_dict/gc_embed_restaurant_val_acc0.6696
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.9477, acc: 0.5312
loss: 0.8759, acc: 0.6042
loss: 0.8842, acc: 0.6094
loss: 0.8787, acc: 0.6201
loss: 0.8843, acc: 0.6120
loss: 0.8893, acc: 0.6110
loss: 0.8863, acc: 0.6176
loss: 0.8902, acc: 0.6154
loss: 0.8912, acc: 0.6122
loss: 0.8796, acc: 0.6186
loss: 0.8839, acc: 0.6128
loss: 0.8924, acc: 0.6102
loss: 0.8973, acc: 0.6064
loss: 0.8984, acc: 0.6037
loss: 0.9008, acc: 0.6035
loss: 0.8948, acc: 0.6048
loss: 0.8927, acc: 0.6057
loss: 0.8944, acc: 0.6043
loss: 0.8956, acc: 0.6027
loss: 0.8997, acc: 0.5997
loss: 0.8947, acc: 0.6013
loss: 0.8924, acc: 0.6041
> val_acc: 0.6929, val_f1: 0.4002
>> saved: state_dict/gc_embed_restaurant_val_acc0.6929
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.7616, acc: 0.6562
loss: 0.8251, acc: 0.6562
loss: 0.8029, acc: 0.6733
loss: 0.8497, acc: 0.6328
loss: 0.8367, acc: 0.6429
loss: 0.8368, acc: 0.6346
loss: 0.8293, acc: 0.6351
loss: 0.8309, acc: 0.6354
loss: 0.8287, acc: 0.6349
loss: 0.8209, acc: 0.6386
loss: 0.8255, acc: 0.6336
loss: 0.8321, acc: 0.6295
loss: 0.8351, acc: 0.6301
loss: 0.8345, acc: 0.6293
loss: 0.8265, acc: 0.6364
loss: 0.8255, acc: 0.6386
loss: 0.8214, acc: 0.6400
loss: 0.8255, acc: 0.6370
loss: 0.8256, acc: 0.6363
loss: 0.8263, acc: 0.6344
loss: 0.8232, acc: 0.6352
loss: 0.8216, acc: 0.6365
loss: 0.8202, acc: 0.6371
> val_acc: 0.7098, val_f1: 0.4480
>> saved: state_dict/gc_embed_restaurant_val_acc0.7098
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.7669, acc: 0.6458
loss: 0.7741, acc: 0.6367
loss: 0.7895, acc: 0.6322
loss: 0.7878, acc: 0.6337
loss: 0.7862, acc: 0.6454
loss: 0.7994, acc: 0.6417
loss: 0.7895, acc: 0.6420
loss: 0.7993, acc: 0.6456
loss: 0.8004, acc: 0.6475
loss: 0.7951, acc: 0.6484
loss: 0.7881, acc: 0.6527
loss: 0.7778, acc: 0.6584
loss: 0.7693, acc: 0.6642
loss: 0.7669, acc: 0.6677
loss: 0.7702, acc: 0.6652
loss: 0.7677, acc: 0.6671
loss: 0.7702, acc: 0.6675
loss: 0.7759, acc: 0.6665
loss: 0.7762, acc: 0.6673
loss: 0.7742, acc: 0.6680
loss: 0.7718, acc: 0.6696
loss: 0.7752, acc: 0.6672
loss: 0.7782, acc: 0.6671
> val_acc: 0.7375, val_f1: 0.5165
>> saved: state_dict/gc_embed_restaurant_val_acc0.7375
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.7542, acc: 0.6875
loss: 0.7419, acc: 0.7094
loss: 0.7640, acc: 0.7042
loss: 0.7644, acc: 0.7000
loss: 0.7669, acc: 0.6913
loss: 0.7605, acc: 0.6896
loss: 0.7596, acc: 0.6848
loss: 0.7564, acc: 0.6836
loss: 0.7626, acc: 0.6743
loss: 0.7619, acc: 0.6756
loss: 0.7661, acc: 0.6716
loss: 0.7627, acc: 0.6703
loss: 0.7513, acc: 0.6774
loss: 0.7488, acc: 0.6790
loss: 0.7434, acc: 0.6813
loss: 0.7440, acc: 0.6809
loss: 0.7429, acc: 0.6820
loss: 0.7447, acc: 0.6823
loss: 0.7444, acc: 0.6822
loss: 0.7471, acc: 0.6806
loss: 0.7442, acc: 0.6824
loss: 0.7420, acc: 0.6832
> val_acc: 0.7384, val_f1: 0.5196
>> saved: state_dict/gc_embed_restaurant_val_acc0.7384
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.7540, acc: 0.6562
loss: 0.7485, acc: 0.6652
loss: 0.7468, acc: 0.6693
loss: 0.7035, acc: 0.6930
loss: 0.7116, acc: 0.7003
loss: 0.7244, acc: 0.6956
loss: 0.7303, acc: 0.6895
loss: 0.7366, acc: 0.6917
loss: 0.7297, acc: 0.6972
loss: 0.7138, acc: 0.7015
loss: 0.7108, acc: 0.7019
loss: 0.7142, acc: 0.7023
loss: 0.7103, acc: 0.7041
loss: 0.7085, acc: 0.7038
loss: 0.7230, acc: 0.6962
loss: 0.7247, acc: 0.6940
loss: 0.7250, acc: 0.6928
loss: 0.7251, acc: 0.6925
loss: 0.7255, acc: 0.6936
loss: 0.7288, acc: 0.6936
loss: 0.7222, acc: 0.6967
loss: 0.7207, acc: 0.6992
loss: 0.7201, acc: 0.6992
> val_acc: 0.7643, val_f1: 0.5814
>> saved: state_dict/gc_embed_restaurant_val_acc0.7643
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.7215, acc: 0.6562
loss: 0.7152, acc: 0.6701
loss: 0.7101, acc: 0.6875
loss: 0.7003, acc: 0.6990
loss: 0.6960, acc: 0.7031
loss: 0.7032, acc: 0.6994
loss: 0.7022, acc: 0.6976
loss: 0.6999, acc: 0.7011
loss: 0.7110, acc: 0.6989
loss: 0.7050, acc: 0.7009
loss: 0.6940, acc: 0.7101
loss: 0.6909, acc: 0.7129
loss: 0.6949, acc: 0.7095
loss: 0.6969, acc: 0.7111
loss: 0.7003, acc: 0.7073
loss: 0.6939, acc: 0.7112
loss: 0.6935, acc: 0.7113
loss: 0.6934, acc: 0.7107
loss: 0.6945, acc: 0.7111
loss: 0.6939, acc: 0.7112
loss: 0.6953, acc: 0.7115
loss: 0.6939, acc: 0.7124
> val_acc: 0.7580, val_f1: 0.5616
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.6269, acc: 0.7188
loss: 0.6339, acc: 0.7292
loss: 0.6339, acc: 0.7216
loss: 0.6320, acc: 0.7285
loss: 0.6248, acc: 0.7336
loss: 0.6547, acc: 0.7200
loss: 0.6583, acc: 0.7208
loss: 0.6664, acc: 0.7161
loss: 0.6611, acc: 0.7226
loss: 0.6571, acc: 0.7194
loss: 0.6539, acc: 0.7194
loss: 0.6583, acc: 0.7165
loss: 0.6565, acc: 0.7177
loss: 0.6591, acc: 0.7169
loss: 0.6574, acc: 0.7201
loss: 0.6560, acc: 0.7220
loss: 0.6573, acc: 0.7222
loss: 0.6580, acc: 0.7227
loss: 0.6576, acc: 0.7218
loss: 0.6589, acc: 0.7223
loss: 0.6586, acc: 0.7209
loss: 0.6586, acc: 0.7220
loss: 0.6595, acc: 0.7207
> val_acc: 0.7714, val_f1: 0.6006
>> saved: state_dict/gc_embed_restaurant_val_acc0.7714
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.6419, acc: 0.7396
loss: 0.6722, acc: 0.7188
loss: 0.6998, acc: 0.7188
loss: 0.7004, acc: 0.7066
loss: 0.6893, acc: 0.7160
loss: 0.6806, acc: 0.7188
loss: 0.6865, acc: 0.7121
loss: 0.6893, acc: 0.7122
loss: 0.6805, acc: 0.7180
loss: 0.6787, acc: 0.7194
loss: 0.6756, acc: 0.7223
loss: 0.6682, acc: 0.7263
loss: 0.6730, acc: 0.7242
loss: 0.6698, acc: 0.7266
loss: 0.6700, acc: 0.7252
loss: 0.6625, acc: 0.7264
loss: 0.6595, acc: 0.7278
loss: 0.6623, acc: 0.7255
loss: 0.6566, acc: 0.7268
loss: 0.6583, acc: 0.7261
loss: 0.6646, acc: 0.7221
loss: 0.6636, acc: 0.7228
loss: 0.6616, acc: 0.7228
> val_acc: 0.7571, val_f1: 0.5615
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.7043, acc: 0.7312
loss: 0.7164, acc: 0.7188
loss: 0.7180, acc: 0.7104
loss: 0.6795, acc: 0.7344
loss: 0.6835, acc: 0.7262
loss: 0.6757, acc: 0.7281
loss: 0.7004, acc: 0.7125
loss: 0.6944, acc: 0.7148
loss: 0.6831, acc: 0.7215
loss: 0.6793, acc: 0.7262
loss: 0.6730, acc: 0.7307
loss: 0.6623, acc: 0.7354
loss: 0.6585, acc: 0.7365
loss: 0.6611, acc: 0.7344
loss: 0.6563, acc: 0.7383
loss: 0.6551, acc: 0.7387
loss: 0.6531, acc: 0.7371
loss: 0.6502, acc: 0.7372
loss: 0.6498, acc: 0.7382
loss: 0.6481, acc: 0.7372
loss: 0.6449, acc: 0.7372
loss: 0.6444, acc: 0.7364
> val_acc: 0.7705, val_f1: 0.5936
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.7321, acc: 0.7656
loss: 0.6506, acc: 0.7321
loss: 0.6687, acc: 0.7344
loss: 0.6523, acc: 0.7408
loss: 0.6415, acc: 0.7472
