cuda memory allocated: 32726528
n_trainable_params: 6841263, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: gc_ian
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x000001F8B89F7620>
>>> learning_rate: 0.01
>>> momentum: 0.95
>>> dropout: 0.2
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 10
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 600
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.gc_ian.GC_IAN'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 21.6792, acc: 0.2812
loss: 12.3865, acc: 0.4250
loss: 8.8520, acc: 0.4625
loss: 6.9496, acc: 0.4641
loss: 5.7756, acc: 0.4888
loss: 4.9869, acc: 0.4979
loss: 4.4094, acc: 0.5134
loss: 3.9822, acc: 0.5133
loss: 3.6354, acc: 0.5285
loss: 3.3682, acc: 0.5337
loss: 3.1522, acc: 0.5358
loss: 2.9658, acc: 0.5432
loss: 2.8101, acc: 0.5476
loss: 2.6796, acc: 0.5500
loss: 2.5573, acc: 0.5575
loss: 2.4626, acc: 0.5574
loss: 2.3757, acc: 0.5574
loss: 2.2984, acc: 0.5566
loss: 2.2292, acc: 0.5589
loss: 2.1660, acc: 0.5584
loss: 2.1081, acc: 0.5619
loss: 2.0520, acc: 0.5651
> val_acc: 0.6098, val_f1: 0.3323
>> saved: state_dict/gc_ian_restaurant_val_acc0.6098
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.9158, acc: 0.6250
loss: 0.9078, acc: 0.6339
loss: 0.9009, acc: 0.6276
loss: 0.9019, acc: 0.6195
loss: 0.9006, acc: 0.6165
loss: 0.8919, acc: 0.6215
loss: 0.9008, acc: 0.6152
loss: 0.8949, acc: 0.6182
loss: 0.8972, acc: 0.6183
loss: 0.8956, acc: 0.6203
loss: 0.9044, acc: 0.6124
loss: 0.9056, acc: 0.6113
loss: 0.9087, acc: 0.6099
loss: 0.9071, acc: 0.6101
loss: 0.9093, acc: 0.6063
loss: 0.9063, acc: 0.6067
loss: 0.9117, acc: 0.6025
loss: 0.9130, acc: 0.6031
loss: 0.9136, acc: 0.6026
loss: 0.9124, acc: 0.6041
loss: 0.9120, acc: 0.6045
loss: 0.9137, acc: 0.6037
loss: 0.9149, acc: 0.6038
> val_acc: 0.6500, val_f1: 0.2626
>> saved: state_dict/gc_ian_restaurant_val_acc0.65
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.9024, acc: 0.6094
loss: 0.8892, acc: 0.6111
loss: 0.8572, acc: 0.6295
loss: 0.8872, acc: 0.6118
loss: 0.8861, acc: 0.6016
loss: 0.8914, acc: 0.6024
loss: 0.8814, acc: 0.6103
loss: 0.8734, acc: 0.6186
loss: 0.8731, acc: 0.6186
loss: 0.8837, acc: 0.6116
loss: 0.8902, acc: 0.6047
loss: 0.8914, acc: 0.6028
loss: 0.8933, acc: 0.6045
loss: 0.8872, acc: 0.6082
loss: 0.8875, acc: 0.6073
loss: 0.8891, acc: 0.6060
loss: 0.8907, acc: 0.6045
loss: 0.8940, acc: 0.6011
loss: 0.8954, acc: 0.6004
loss: 0.8982, acc: 0.5997
loss: 0.9020, acc: 0.5977
loss: 0.8994, acc: 0.5995
> val_acc: 0.6500, val_f1: 0.2626
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.9636, acc: 0.5312
loss: 0.9927, acc: 0.5365
loss: 0.9220, acc: 0.5767
loss: 0.9003, acc: 0.5977
loss: 0.8879, acc: 0.6071
loss: 0.8901, acc: 0.6010
loss: 0.9010, acc: 0.5958
loss: 0.9012, acc: 0.5955
loss: 0.8955, acc: 0.5976
loss: 0.8955, acc: 0.6012
loss: 0.8975, acc: 0.6048
loss: 0.8966, acc: 0.6049
loss: 0.8995, acc: 0.5989
loss: 0.8957, acc: 0.6009
loss: 0.8927, acc: 0.6017
loss: 0.8871, acc: 0.6057
loss: 0.8823, acc: 0.6065
loss: 0.8800, acc: 0.6076
loss: 0.8819, acc: 0.6061
loss: 0.8762, acc: 0.6113
loss: 0.8711, acc: 0.6142
loss: 0.8713, acc: 0.6123
loss: 0.8709, acc: 0.6120
> val_acc: 0.6500, val_f1: 0.3397
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.7013, acc: 0.6875
loss: 0.8193, acc: 0.6211
loss: 0.8456, acc: 0.6202
loss: 0.8417, acc: 0.6285
loss: 0.8415, acc: 0.6223
loss: 0.8541, acc: 0.6205
loss: 0.8548, acc: 0.6146
loss: 0.8572, acc: 0.6143
loss: 0.8538, acc: 0.6177
loss: 0.8564, acc: 0.6152
loss: 0.8638, acc: 0.6103
loss: 0.8533, acc: 0.6169
loss: 0.8563, acc: 0.6146
loss: 0.8562, acc: 0.6140
