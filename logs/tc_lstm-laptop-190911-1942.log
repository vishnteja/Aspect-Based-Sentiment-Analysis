cuda memory allocated: 12407808
n_trainable_params: 2166603, n_nontrainable_params: 934800
> training arguments:
>>> model_name: tc_lstm
>>> dataset: laptop
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x0000020D7A0D67B8>
>>> learning_rate: 0.001
>>> dropout: 0.1
>>> l2reg: 0.01
>>> num_epoch: 20
>>> batch_size: 64
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: None
>>> valset_ratio: 0
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.tc_lstm.TC_LSTM'>
>>> dataset_file: {'train': './datasets/semeval14/Laptops_Train.xml.seg', 'test': './datasets/semeval14/Laptops_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_left_with_aspect_indices', 'text_right_with_aspect_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.0220, acc: 0.4594
loss: 1.0362, acc: 0.4750
loss: 0.9986, acc: 0.5115
loss: 0.9936, acc: 0.5180
loss: 0.9776, acc: 0.5294
loss: 0.9665, acc: 0.5401
loss: 0.9665, acc: 0.5415
> val_acc: 0.5721, val_f1: 0.4655
>> saved: state_dict/tc_lstm_laptop_val_acc0.5721
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.8017, acc: 0.6667
loss: 0.7992, acc: 0.6465
loss: 0.8454, acc: 0.6166
loss: 0.8435, acc: 0.6102
loss: 0.8357, acc: 0.6216
loss: 0.8458, acc: 0.6189
loss: 0.8466, acc: 0.6165
> val_acc: 0.5909, val_f1: 0.5151
>> saved: state_dict/tc_lstm_laptop_val_acc0.5909
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.8028, acc: 0.6406
loss: 0.7765, acc: 0.6693
loss: 0.7665, acc: 0.6790
loss: 0.7824, acc: 0.6621
loss: 0.7883, acc: 0.6570
loss: 0.7940, acc: 0.6478
loss: 0.7940, acc: 0.6497
loss: 0.7952, acc: 0.6497
> val_acc: 0.5815, val_f1: 0.4731
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.6932, acc: 0.7344
loss: 0.7169, acc: 0.7066
loss: 0.7273, acc: 0.6953
loss: 0.7221, acc: 0.7048
loss: 0.7290, acc: 0.6914
loss: 0.7373, acc: 0.6913
loss: 0.7345, acc: 0.6866
> val_acc: 0.6050, val_f1: 0.4981
>> saved: state_dict/tc_lstm_laptop_val_acc0.605
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.7229, acc: 0.6797
loss: 0.6723, acc: 0.7188
loss: 0.6808, acc: 0.7214
loss: 0.7032, acc: 0.7022
loss: 0.7124, acc: 0.6967
loss: 0.7176, acc: 0.6921
loss: 0.7135, acc: 0.6948
loss: 0.7206, acc: 0.6972
> val_acc: 0.5580, val_f1: 0.4972
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.6755, acc: 0.7156
loss: 0.6463, acc: 0.7188
loss: 0.6541, acc: 0.7208
loss: 0.6644, acc: 0.7148
loss: 0.6669, acc: 0.7181
loss: 0.6785, acc: 0.7125
loss: 0.6837, acc: 0.7116
> val_acc: 0.5987, val_f1: 0.5351
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.6984, acc: 0.7240
loss: 0.6433, acc: 0.7363
loss: 0.6554, acc: 0.7272
loss: 0.6294, acc: 0.7413
loss: 0.6537, acc: 0.7303
loss: 0.6615, acc: 0.7271
loss: 0.6586, acc: 0.7240
> val_acc: 0.6395, val_f1: 0.5414
>> saved: state_dict/tc_lstm_laptop_val_acc0.6395
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.5221, acc: 0.7812
loss: 0.5787, acc: 0.7630
loss: 0.6100, acc: 0.7528
loss: 0.6172, acc: 0.7441
loss: 0.6306, acc: 0.7359
loss: 0.6355, acc: 0.7356
loss: 0.6305, acc: 0.7374
loss: 0.6316, acc: 0.7374
> val_acc: 0.5925, val_f1: 0.5108
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.6324, acc: 0.7344
loss: 0.6242, acc: 0.7378
loss: 0.6105, acc: 0.7533
loss: 0.6196, acc: 0.7508
loss: 0.6138, acc: 0.7546
loss: 0.6169, acc: 0.7478
loss: 0.6158, acc: 0.7486
> val_acc: 0.5737, val_f1: 0.4891
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.5873, acc: 0.7812
loss: 0.5630, acc: 0.7768
loss: 0.5624, acc: 0.7799
loss: 0.5745, acc: 0.7702
loss: 0.5766, acc: 0.7678
loss: 0.5833, acc: 0.7593
loss: 0.5861, acc: 0.7612
loss: 0.5895, acc: 0.7590
> val_acc: 0.6348, val_f1: 0.5301
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.5150, acc: 0.7969
loss: 0.5005, acc: 0.8000
loss: 0.5388, acc: 0.7802
loss: 0.5278, acc: 0.7828
loss: 0.5382, acc: 0.7762
loss: 0.5530, acc: 0.7677
loss: 0.5625, acc: 0.7643
> val_acc: 0.6238, val_f1: 0.5268
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.5366, acc: 0.7708
loss: 0.5446, acc: 0.7832
loss: 0.5420, acc: 0.7764
loss: 0.5264, acc: 0.7891
loss: 0.5182, acc: 0.7921
loss: 0.5310, acc: 0.7879
loss: 0.5454, acc: 0.7808
> val_acc: 0.6285, val_f1: 0.5273
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.5056, acc: 0.7969
loss: 0.5872, acc: 0.7682
loss: 0.5964, acc: 0.7585
loss: 0.5840, acc: 0.7598
loss: 0.5696, acc: 0.7619
loss: 0.5736, acc: 0.7632
loss: 0.5772, acc: 0.7596
loss: 0.5800, acc: 0.7582
> val_acc: 0.6144, val_f1: 0.5707
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.5128, acc: 0.8008
loss: 0.5163, acc: 0.7882
loss: 0.5043, acc: 0.8013
loss: 0.5063, acc: 0.7969
loss: 0.5011, acc: 0.7995
loss: 0.4997, acc: 0.8006
loss: 0.5029, acc: 0.7987
> val_acc: 0.6520, val_f1: 0.5800
>> saved: state_dict/tc_lstm_laptop_val_acc0.652
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.4234, acc: 0.8672
loss: 0.4521, acc: 0.8482
loss: 0.4561, acc: 0.8307
loss: 0.4569, acc: 0.8254
loss: 0.4552, acc: 0.8260
loss: 0.4618, acc: 0.8194
loss: 0.4725, acc: 0.8105
loss: 0.4852, acc: 0.8024
> val_acc: 0.6317, val_f1: 0.5358
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.4760, acc: 0.7937
loss: 0.4570, acc: 0.8156
loss: 0.4593, acc: 0.8156
loss: 0.4614, acc: 0.8164
loss: 0.4677, acc: 0.8125
loss: 0.4644, acc: 0.8151
loss: 0.4767, acc: 0.8103
> val_acc: 0.6442, val_f1: 0.5471
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.4022, acc: 0.8542
loss: 0.3834, acc: 0.8613
loss: 0.4132, acc: 0.8450
loss: 0.4389, acc: 0.8342
loss: 0.4481, acc: 0.8227
loss: 0.4572, acc: 0.8203
loss: 0.4740, acc: 0.8149
> val_acc: 0.6489, val_f1: 0.5687
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 0.5042, acc: 0.7969
loss: 0.4654, acc: 0.8151
loss: 0.4541, acc: 0.8210
loss: 0.4464, acc: 0.8203
loss: 0.4347, acc: 0.8259
loss: 0.4356, acc: 0.8287
loss: 0.4302, acc: 0.8322
loss: 0.4421, acc: 0.8264
> val_acc: 0.6520, val_f1: 0.5811
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 18
loss: 0.3860, acc: 0.8828
loss: 0.3700, acc: 0.8681
loss: 0.3903, acc: 0.8560
loss: 0.3934, acc: 0.8561
loss: 0.3975, acc: 0.8509
loss: 0.4093, acc: 0.8464
loss: 0.4119, acc: 0.8433
> val_acc: 0.6238, val_f1: 0.5472
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 19
loss: 0.3374, acc: 0.8594
loss: 0.3557, acc: 0.8795
loss: 0.3709, acc: 0.8685
loss: 0.3794, acc: 0.8612
loss: 0.3774, acc: 0.8608
loss: 0.3800, acc: 0.8594
loss: 0.3828, acc: 0.8594
loss: 0.3968, acc: 0.8544
> val_acc: 0.6473, val_f1: 0.5694
>> test_acc: 0.6520, test_f1: 0.5800
