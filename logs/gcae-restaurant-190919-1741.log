cuda memory allocated: 24776192
n_trainable_params: 4869603, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: gcae
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x00000134A9C27620>
>>> learning_rate: 0.01
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: None
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 600
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.gcae.GCAE'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 8.5798, acc: 0.4875
loss: 5.5968, acc: 0.4719
loss: 4.3240, acc: 0.4854
loss: 3.6406, acc: 0.5078
loss: 3.3310, acc: 0.5212
loss: 3.0072, acc: 0.5354
loss: 2.7845, acc: 0.5339
loss: 2.5453, acc: 0.5586
loss: 2.3861, acc: 0.5694
loss: 2.3078, acc: 0.5694
loss: 2.1925, acc: 0.5727
loss: 2.1295, acc: 0.5760
loss: 2.0286, acc: 0.5885
loss: 1.9552, acc: 0.5933
loss: 1.8903, acc: 0.6000
loss: 1.8390, acc: 0.6055
loss: 1.7874, acc: 0.6132
loss: 1.7558, acc: 0.6146
loss: 1.7181, acc: 0.6155
loss: 1.6719, acc: 0.6197
loss: 1.6345, acc: 0.6238
loss: 1.6053, acc: 0.6267
> val_acc: 0.6652, val_f1: 0.4806
>> saved: state_dict/gcae_restaurant_val_acc0.6652
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 1.0475, acc: 0.6094
loss: 0.7339, acc: 0.7232
loss: 0.8165, acc: 0.7188
loss: 0.8367, acc: 0.7335
loss: 0.8410, acc: 0.7230
loss: 0.8776, acc: 0.7106
loss: 0.8788, acc: 0.7109
loss: 0.9230, acc: 0.7078
loss: 0.9715, acc: 0.7054
loss: 0.9871, acc: 0.6941
loss: 0.9727, acc: 0.6977
loss: 0.9874, acc: 0.6996
loss: 0.9817, acc: 0.7041
loss: 0.9716, acc: 0.7024
loss: 0.9643, acc: 0.7049
loss: 0.9671, acc: 0.7001
loss: 0.9868, acc: 0.6959
loss: 0.9812, acc: 0.6990
loss: 1.0031, acc: 0.6936
loss: 1.0065, acc: 0.6965
loss: 1.0074, acc: 0.6964
loss: 0.9998, acc: 0.6995
loss: 1.0163, acc: 0.6973
> val_acc: 0.7027, val_f1: 0.5153
>> saved: state_dict/gcae_restaurant_val_acc0.7027
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.9929, acc: 0.7266
loss: 0.8368, acc: 0.7882
loss: 0.7796, acc: 0.7835
loss: 0.8009, acc: 0.7730
loss: 0.8099, acc: 0.7617
loss: 0.8863, acc: 0.7532
loss: 1.0103, acc: 0.7390
loss: 0.9932, acc: 0.7468
loss: 0.9748, acc: 0.7528
loss: 0.9889, acc: 0.7557
loss: 1.0155, acc: 0.7523
loss: 1.0377, acc: 0.7447
loss: 1.0273, acc: 0.7432
loss: 1.0225, acc: 0.7428
loss: 1.0574, acc: 0.7365
loss: 1.0853, acc: 0.7358
loss: 1.0869, acc: 0.7351
loss: 1.0813, acc: 0.7331
loss: 1.0847, acc: 0.7334
loss: 1.0957, acc: 0.7330
loss: 1.0987, acc: 0.7329
loss: 1.0920, acc: 0.7322
> val_acc: 0.7143, val_f1: 0.5193
>> saved: state_dict/gcae_restaurant_val_acc0.7143
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.8511, acc: 0.7188
loss: 0.9818, acc: 0.7552
loss: 1.0796, acc: 0.7386
loss: 1.0542, acc: 0.7461
loss: 1.0716, acc: 0.7560
loss: 1.0436, acc: 0.7668
loss: 1.1182, acc: 0.7510
loss: 1.1699, acc: 0.7413
loss: 1.4106, acc: 0.7287
loss: 1.4072, acc: 0.7323
loss: 1.4502, acc: 0.7249
loss: 1.4284, acc: 0.7254
loss: 1.4280, acc: 0.7228
loss: 1.4180, acc: 0.7230
loss: 1.4087, acc: 0.7245
loss: 1.3944, acc: 0.7266
loss: 1.3968, acc: 0.7249
loss: 1.4255, acc: 0.7253
loss: 1.4385, acc: 0.7253
loss: 1.4269, acc: 0.7246
loss: 1.4095, acc: 0.7290
loss: 1.3763, acc: 0.7332
loss: 1.3640, acc: 0.7325
> val_acc: 0.7375, val_f1: 0.5568
>> saved: state_dict/gcae_restaurant_val_acc0.7375
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.7765, acc: 0.7917
loss: 0.9252, acc: 0.7891
loss: 1.0859, acc: 0.7764
loss: 1.0964, acc: 0.7830
loss: 1.1144, acc: 0.7758
loss: 1.1836, acc: 0.7723
loss: 1.1709, acc: 0.7708
loss: 1.1977, acc: 0.7738
loss: 1.2191, acc: 0.7747
loss: 1.2219, acc: 0.7773
loss: 1.2360, acc: 0.7771
loss: 1.2253, acc: 0.7818
loss: 1.2298, acc: 0.7758
loss: 1.2301, acc: 0.7762
loss: 1.2462, acc: 0.7744
loss: 1.2633, acc: 0.7716
loss: 1.2577, acc: 0.7707
loss: 1.2580, acc: 0.7692
loss: 1.2515, acc: 0.7665
loss: 1.2739, acc: 0.7602
loss: 1.2897, acc: 0.7579
loss: 1.2901, acc: 0.7575
loss: 1.3143, acc: 0.7550
> val_acc: 0.6723, val_f1: 0.5753
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 1.7488, acc: 0.7438
loss: 1.1410, acc: 0.7937
loss: 1.0902, acc: 0.8063
loss: 1.2575, acc: 0.7875
loss: 1.3010, acc: 0.7725
loss: 1.3114, acc: 0.7719
loss: 1.3706, acc: 0.7696
loss: 1.4774, acc: 0.7711
loss: 1.5062, acc: 0.7681
loss: 1.5268, acc: 0.7694
loss: 1.5024, acc: 0.7682
loss: 1.4861, acc: 0.7703
loss: 1.4580, acc: 0.7764
loss: 1.4537, acc: 0.7777
loss: 1.4350, acc: 0.7788
loss: 1.4280, acc: 0.7797
loss: 1.4290, acc: 0.7787
loss: 1.4290, acc: 0.7771
loss: 1.4184, acc: 0.7773
loss: 1.3959, acc: 0.7781
loss: 1.4370, acc: 0.7726
loss: 1.4473, acc: 0.7716
> val_acc: 0.7295, val_f1: 0.5887
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.7280, acc: 0.8281
loss: 0.7578, acc: 0.8348
loss: 0.9080, acc: 0.8385
loss: 0.9052, acc: 0.8382
loss: 0.9091, acc: 0.8295
loss: 0.9041, acc: 0.8299
loss: 1.0202, acc: 0.8223
loss: 1.0838, acc: 0.8159
loss: 1.1633, acc: 0.8080
loss: 1.1642, acc: 0.8065
loss: 1.1497, acc: 0.8053
loss: 1.1218, acc: 0.8098
loss: 1.1125, acc: 0.8095
loss: 1.0735, acc: 0.8144
loss: 1.0521, acc: 0.8177
loss: 1.0522, acc: 0.8202
loss: 1.0831, acc: 0.8167
loss: 1.0785, acc: 0.8157
loss: 1.0875, acc: 0.8135
loss: 1.1239, acc: 0.8109
loss: 1.1377, acc: 0.8097
loss: 1.1318, acc: 0.8090
loss: 1.1231, acc: 0.8083
> val_acc: 0.7027, val_f1: 0.6047
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.7444, acc: 0.8594
loss: 1.0404, acc: 0.8368
loss: 1.0016, acc: 0.8371
loss: 0.9174, acc: 0.8421
loss: 0.8193, acc: 0.8490
loss: 0.8396, acc: 0.8416
loss: 0.9143, acc: 0.8382
loss: 0.8706, acc: 0.8397
loss: 0.8725, acc: 0.8338
loss: 0.9090, acc: 0.8342
loss: 0.8880, acc: 0.8397
loss: 0.8821, acc: 0.8411
loss: 0.9191, acc: 0.8369
loss: 0.9325, acc: 0.8342
loss: 0.9454, acc: 0.8345
loss: 0.9384, acc: 0.8350
loss: 0.9457, acc: 0.8341
loss: 0.9593, acc: 0.8329
loss: 0.9275, acc: 0.8354
loss: 0.9311, acc: 0.8330
loss: 0.9190, acc: 0.8329
loss: 0.9239, acc: 0.8288
> val_acc: 0.7420, val_f1: 0.5458
>> saved: state_dict/gcae_restaurant_val_acc0.742
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.2847, acc: 0.8750
loss: 0.5804, acc: 0.8646
loss: 0.5534, acc: 0.8693
loss: 0.6166, acc: 0.8594
loss: 0.5605, acc: 0.8705
loss: 0.5981, acc: 0.8654
loss: 0.5897, acc: 0.8700
loss: 0.5769, acc: 0.8733
loss: 0.6118, acc: 0.8727
loss: 0.6274, acc: 0.8689
loss: 0.6332, acc: 0.8658
loss: 0.6547, acc: 0.8638
loss: 0.6628, acc: 0.8637
loss: 0.6665, acc: 0.8613
loss: 0.6955, acc: 0.8578
loss: 0.7105, acc: 0.8569
loss: 0.7262, acc: 0.8534
loss: 0.7271, acc: 0.8514
loss: 0.7280, acc: 0.8510
loss: 0.7525, acc: 0.8503
loss: 0.7583, acc: 0.8493
loss: 0.7650, acc: 0.8494
loss: 0.7672, acc: 0.8468
> val_acc: 0.7482, val_f1: 0.6217
>> saved: state_dict/gcae_restaurant_val_acc0.7482
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.7908, acc: 0.8646
loss: 0.5693, acc: 0.8750
loss: 0.5097, acc: 0.8822
loss: 0.4973, acc: 0.8750
loss: 0.5124, acc: 0.8750
loss: 0.5404, acc: 0.8750
loss: 0.5527, acc: 0.8703
loss: 0.5705, acc: 0.8717
loss: 0.5865, acc: 0.8648
loss: 0.5667, acc: 0.8711
loss: 0.6001, acc: 0.8673
loss: 0.5920, acc: 0.8696
loss: 0.6089, acc: 0.8671
loss: 0.6221, acc: 0.8653
loss: 0.6224, acc: 0.8673
loss: 0.6313, acc: 0.8682
loss: 0.6442, acc: 0.8656
loss: 0.6511, acc: 0.8636
loss: 0.6698, acc: 0.8602
loss: 0.6650, acc: 0.8594
loss: 0.6604, acc: 0.8601
loss: 0.6697, acc: 0.8585
loss: 0.6732, acc: 0.8578
> val_acc: 0.7429, val_f1: 0.6304
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.3954, acc: 0.9000
loss: 0.4686, acc: 0.9000
loss: 0.4817, acc: 0.8917
loss: 0.5535, acc: 0.8797
loss: 0.5453, acc: 0.8825
loss: 0.5248, acc: 0.8823
loss: 0.5005, acc: 0.8848
loss: 0.5205, acc: 0.8805
loss: 0.5435, acc: 0.8785
loss: 0.5756, acc: 0.8738
loss: 0.5985, acc: 0.8670
loss: 0.6118, acc: 0.8661
loss: 0.6247, acc: 0.8663
loss: 0.6277, acc: 0.8652
loss: 0.6178, acc: 0.8675
loss: 0.6144, acc: 0.8652
loss: 0.6214, acc: 0.8629
loss: 0.6247, acc: 0.8632
loss: 0.6183, acc: 0.8641
loss: 0.6095, acc: 0.8656
loss: 0.6166, acc: 0.8643
loss: 0.6351, acc: 0.8616
> val_acc: 0.7348, val_f1: 0.6258
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.8615, acc: 0.8125
loss: 0.5998, acc: 0.8527
loss: 0.5070, acc: 0.8750
loss: 0.5396, acc: 0.8658
loss: 0.4932, acc: 0.8707
loss: 0.5539, acc: 0.8600
loss: 0.5919, acc: 0.8516
loss: 0.6181, acc: 0.8505
loss: 0.6115, acc: 0.8542
loss: 0.5946, acc: 0.8597
loss: 0.6099, acc: 0.8576
loss: 0.5984, acc: 0.8569
loss: 0.6038, acc: 0.8558
loss: 0.5852, acc: 0.8587
loss: 0.5775, acc: 0.8607
loss: 0.5962, acc: 0.8592
loss: 0.5940, acc: 0.8598
loss: 0.5770, acc: 0.8631
loss: 0.5651, acc: 0.8655
loss: 0.5618, acc: 0.8679
loss: 0.5739, acc: 0.8661
loss: 0.5681, acc: 0.8671
loss: 0.5613, acc: 0.8675
> val_acc: 0.7420, val_f1: 0.6262
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.6526, acc: 0.8906
loss: 0.4273, acc: 0.9062
loss: 0.3408, acc: 0.9286
loss: 0.3939, acc: 0.9128
loss: 0.3868, acc: 0.9089
loss: 0.4048, acc: 0.9041
loss: 0.3955, acc: 0.9072
loss: 0.4293, acc: 0.9022
loss: 0.4464, acc: 0.8963
loss: 0.4412, acc: 0.8960
loss: 0.4527, acc: 0.8941
loss: 0.4749, acc: 0.8946
loss: 0.4739, acc: 0.8940
loss: 0.4729, acc: 0.8945
loss: 0.4766, acc: 0.8948
loss: 0.4780, acc: 0.8940
loss: 0.4730, acc: 0.8936
loss: 0.4663, acc: 0.8936
loss: 0.4802, acc: 0.8913
loss: 0.4815, acc: 0.8892
loss: 0.4936, acc: 0.8870
loss: 0.5009, acc: 0.8850
> val_acc: 0.7714, val_f1: 0.6051
>> saved: state_dict/gcae_restaurant_val_acc0.7714
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.4964, acc: 0.8438
loss: 0.2690, acc: 0.9062
loss: 0.3213, acc: 0.8949
loss: 0.3780, acc: 0.8926
loss: 0.3902, acc: 0.8973
loss: 0.3858, acc: 0.9002
loss: 0.4113, acc: 0.8952
loss: 0.4197, acc: 0.8906
loss: 0.4207, acc: 0.8925
loss: 0.4325, acc: 0.8947
loss: 0.4426, acc: 0.8958
loss: 0.4741, acc: 0.8934
loss: 0.5028, acc: 0.8914
loss: 0.5178, acc: 0.8897
loss: 0.5392, acc: 0.8860
loss: 0.5373, acc: 0.8857
loss: 0.5588, acc: 0.8823
loss: 0.5568, acc: 0.8823
loss: 0.5615, acc: 0.8815
loss: 0.5709, acc: 0.8809
loss: 0.5870, acc: 0.8784
loss: 0.6012, acc: 0.8759
loss: 0.6057, acc: 0.8744
> val_acc: 0.7232, val_f1: 0.5482
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.6759, acc: 0.8958
loss: 0.5820, acc: 0.8984
loss: 0.6448, acc: 0.8990
loss: 0.6807, acc: 0.8872
loss: 0.6735, acc: 0.8845
loss: 0.6593, acc: 0.8873
loss: 0.6328, acc: 0.8873
loss: 0.6736, acc: 0.8849
loss: 0.7105, acc: 0.8823
loss: 0.7104, acc: 0.8802
loss: 0.7003, acc: 0.8791
loss: 0.6890, acc: 0.8793
loss: 0.6774, acc: 0.8770
loss: 0.6699, acc: 0.8764
loss: 0.6487, acc: 0.8763
loss: 0.6852, acc: 0.8734
loss: 0.6941, acc: 0.8682
loss: 0.6871, acc: 0.8675
loss: 0.6867, acc: 0.8659
loss: 0.6777, acc: 0.8667
loss: 0.6856, acc: 0.8653
loss: 0.6897, acc: 0.8623
loss: 0.6975, acc: 0.8617
> val_acc: 0.7268, val_f1: 0.5993
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.6427, acc: 0.8750
loss: 0.4537, acc: 0.8938
loss: 0.4723, acc: 0.8938
loss: 0.5254, acc: 0.8922
loss: 0.5579, acc: 0.8925
loss: 0.5554, acc: 0.8865
loss: 0.6396, acc: 0.8795
loss: 0.6456, acc: 0.8789
loss: 0.6763, acc: 0.8757
loss: 0.7153, acc: 0.8706
loss: 0.7055, acc: 0.8710
loss: 0.7069, acc: 0.8708
loss: 0.7371, acc: 0.8663
loss: 0.7576, acc: 0.8643
loss: 0.7718, acc: 0.8658
loss: 0.7678, acc: 0.8672
loss: 0.8029, acc: 0.8629
loss: 0.8085, acc: 0.8597
loss: 0.7998, acc: 0.8599
loss: 0.8154, acc: 0.8588
loss: 0.8292, acc: 0.8571
loss: 0.8235, acc: 0.8580
> val_acc: 0.7357, val_f1: 0.5729
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.7160, acc: 0.8438
loss: 0.7758, acc: 0.8438
loss: 1.0086, acc: 0.8229
loss: 0.9633, acc: 0.8327
loss: 0.9675, acc: 0.8381
loss: 0.9951, acc: 0.8368
loss: 1.0124, acc: 0.8389
loss: 1.0289, acc: 0.8370
loss: 1.0669, acc: 0.8356
loss: 1.1290, acc: 0.8351
loss: 1.1209, acc: 0.8389
loss: 1.1442, acc: 0.8410
loss: 1.2085, acc: 0.8347
loss: 1.2279, acc: 0.8344
loss: 1.2281, acc: 0.8351
loss: 1.3321, acc: 0.8291
loss: 1.3341, acc: 0.8262
loss: 1.3086, acc: 0.8269
loss: 1.2978, acc: 0.8278
loss: 1.3209, acc: 0.8283
loss: 1.3629, acc: 0.8266
loss: 1.3677, acc: 0.8262
loss: 1.3850, acc: 0.8248
> val_acc: 0.6902, val_f1: 0.5120
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 17
loss: 1.7690, acc: 0.8281
loss: 1.6761, acc: 0.8333
loss: 1.5985, acc: 0.8438
