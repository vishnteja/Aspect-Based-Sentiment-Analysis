cuda memory allocated: 8187392
n_trainable_params: 722403, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: gc_ian
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x000002AD6F457620>
>>> learning_rate: 0.01
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 10
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 100
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.gc_ian.GC_IAN'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
cuda memory allocated: 8187392
n_trainable_params: 722403, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: gc_ian
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x0000024761B57620>
>>> learning_rate: 0.01
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 15
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 10
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 100
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.gc_ian.GC_IAN'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.0896, acc: 0.5312
loss: 1.0292, acc: 0.5094
loss: 1.0161, acc: 0.5229
loss: 0.9876, acc: 0.5359
loss: 0.9894, acc: 0.5500
loss: 0.9639, acc: 0.5656
loss: 0.9716, acc: 0.5643
loss: 0.9705, acc: 0.5641
loss: 0.9669, acc: 0.5632
loss: 0.9557, acc: 0.5713
loss: 0.9578, acc: 0.5716
loss: 0.9518, acc: 0.5724
loss: 0.9458, acc: 0.5788
loss: 0.9413, acc: 0.5839
loss: 0.9351, acc: 0.5871
loss: 0.9205, acc: 0.5941
loss: 0.9170, acc: 0.5971
loss: 0.9095, acc: 0.5979
loss: 0.9024, acc: 0.6007
loss: 0.8982, acc: 0.6069
loss: 0.8910, acc: 0.6119
loss: 0.8887, acc: 0.6119
> val_acc: 0.7009, val_f1: 0.5009
>> saved: state_dict/gc_ian_restaurant_val_acc0.7009
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.8038, acc: 0.6562
loss: 0.6621, acc: 0.7455
loss: 0.6808, acc: 0.7292
loss: 0.6813, acc: 0.7371
loss: 0.6757, acc: 0.7358
loss: 0.6655, acc: 0.7407
loss: 0.6570, acc: 0.7373
loss: 0.6591, acc: 0.7314
loss: 0.6568, acc: 0.7329
loss: 0.6496, acc: 0.7354
loss: 0.6467, acc: 0.7380
loss: 0.6495, acc: 0.7390
loss: 0.6471, acc: 0.7434
loss: 0.6423, acc: 0.7467
loss: 0.6389, acc: 0.7491
loss: 0.6397, acc: 0.7484
loss: 0.6420, acc: 0.7466
loss: 0.6385, acc: 0.7486
loss: 0.6363, acc: 0.7507
loss: 0.6343, acc: 0.7532
loss: 0.6310, acc: 0.7561
loss: 0.6353, acc: 0.7523
loss: 0.6376, acc: 0.7508
> val_acc: 0.7241, val_f1: 0.5694
>> saved: state_dict/gc_ian_restaurant_val_acc0.7241
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.4794, acc: 0.8672
loss: 0.4951, acc: 0.8264
loss: 0.4902, acc: 0.8259
loss: 0.4858, acc: 0.8273
loss: 0.4977, acc: 0.8216
loss: 0.4877, acc: 0.8297
loss: 0.4872, acc: 0.8290
loss: 0.4905, acc: 0.8285
loss: 0.4976, acc: 0.8210
loss: 0.4968, acc: 0.8202
loss: 0.5066, acc: 0.8131
loss: 0.5030, acc: 0.8162
loss: 0.5036, acc: 0.8149
loss: 0.5002, acc: 0.8184
loss: 0.5009, acc: 0.8180
loss: 0.5027, acc: 0.8180
loss: 0.5021, acc: 0.8177
loss: 0.5035, acc: 0.8167
loss: 0.5040, acc: 0.8172
loss: 0.5011, acc: 0.8185
loss: 0.4985, acc: 0.8200
loss: 0.4977, acc: 0.8197
> val_acc: 0.7321, val_f1: 0.5484
>> saved: state_dict/gc_ian_restaurant_val_acc0.7321
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.2896, acc: 0.9062
loss: 0.4846, acc: 0.8073
loss: 0.4619, acc: 0.8182
loss: 0.4390, acc: 0.8398
loss: 0.4212, acc: 0.8527
loss: 0.4184, acc: 0.8510
loss: 0.4067, acc: 0.8538
loss: 0.4112, acc: 0.8533
loss: 0.4145, acc: 0.8529
loss: 0.4113, acc: 0.8567
loss: 0.4118, acc: 0.8560
loss: 0.4137, acc: 0.8516
loss: 0.4130, acc: 0.8504
loss: 0.4091, acc: 0.8527
loss: 0.4053, acc: 0.8539
loss: 0.4064, acc: 0.8536
loss: 0.4064, acc: 0.8546
loss: 0.4083, acc: 0.8543
loss: 0.4061, acc: 0.8554
loss: 0.4011, acc: 0.8584
loss: 0.4027, acc: 0.8567
loss: 0.4006, acc: 0.8573
loss: 0.4024, acc: 0.8564
> val_acc: 0.7420, val_f1: 0.5945
>> saved: state_dict/gc_ian_restaurant_val_acc0.742
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.3113, acc: 0.9062
loss: 0.3658, acc: 0.8633
loss: 0.3207, acc: 0.8798
loss: 0.3152, acc: 0.8802
loss: 0.3181, acc: 0.8859
loss: 0.3126, acc: 0.8940
loss: 0.3110, acc: 0.8968
loss: 0.3106, acc: 0.8964
loss: 0.3112, acc: 0.8968
loss: 0.3154, acc: 0.8932
loss: 0.3151, acc: 0.8945
loss: 0.3199, acc: 0.8917
loss: 0.3154, acc: 0.8929
loss: 0.3186, acc: 0.8897
loss: 0.3238, acc: 0.8874
loss: 0.3272, acc: 0.8866
loss: 0.3240, acc: 0.8893
loss: 0.3262, acc: 0.8878
loss: 0.3266, acc: 0.8884
loss: 0.3280, acc: 0.8874
loss: 0.3286, acc: 0.8862
loss: 0.3262, acc: 0.8874
loss: 0.3250, acc: 0.8883
> val_acc: 0.7339, val_f1: 0.5897
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.2475, acc: 0.9250
loss: 0.2459, acc: 0.9094
loss: 0.2464, acc: 0.9104
loss: 0.2543, acc: 0.9062
loss: 0.2547, acc: 0.9075
loss: 0.2527, acc: 0.9125
loss: 0.2486, acc: 0.9170
loss: 0.2564, acc: 0.9109
loss: 0.2569, acc: 0.9090
loss: 0.2551, acc: 0.9113
loss: 0.2494, acc: 0.9148
loss: 0.2516, acc: 0.9135
loss: 0.2536, acc: 0.9120
loss: 0.2535, acc: 0.9116
loss: 0.2535, acc: 0.9121
loss: 0.2547, acc: 0.9109
loss: 0.2570, acc: 0.9099
loss: 0.2592, acc: 0.9087
loss: 0.2630, acc: 0.9076
loss: 0.2651, acc: 0.9066
loss: 0.2642, acc: 0.9068
loss: 0.2711, acc: 0.9028
> val_acc: 0.7393, val_f1: 0.5881
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.2137, acc: 0.9375
loss: 0.2184, acc: 0.9420
loss: 0.2245, acc: 0.9349
loss: 0.2255, acc: 0.9375
loss: 0.2242, acc: 0.9361
loss: 0.2248, acc: 0.9398
loss: 0.2271, acc: 0.9346
loss: 0.2259, acc: 0.9358
loss: 0.2212, acc: 0.9390
loss: 0.2246, acc: 0.9342
loss: 0.2238, acc: 0.9333
loss: 0.2206, acc: 0.9348
loss: 0.2162, acc: 0.9375
loss: 0.2172, acc: 0.9370
loss: 0.2173, acc: 0.9366
loss: 0.2194, acc: 0.9351
loss: 0.2209, acc: 0.9348
loss: 0.2213, acc: 0.9343
loss: 0.2247, acc: 0.9317
loss: 0.2256, acc: 0.9311
loss: 0.2248, acc: 0.9323
loss: 0.2251, acc: 0.9311
loss: 0.2282, acc: 0.9294
> val_acc: 0.7455, val_f1: 0.5941
>> saved: state_dict/gc_ian_restaurant_val_acc0.7455
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.1554, acc: 0.9688
loss: 0.1926, acc: 0.9479
loss: 0.1797, acc: 0.9487
loss: 0.1820, acc: 0.9457
loss: 0.1832, acc: 0.9479
loss: 0.1855, acc: 0.9504
loss: 0.1907, acc: 0.9467
loss: 0.1919, acc: 0.9455
loss: 0.1855, acc: 0.9460
loss: 0.1835, acc: 0.9477
loss: 0.1845, acc: 0.9473
loss: 0.1847, acc: 0.9470
loss: 0.1875, acc: 0.9448
loss: 0.1889, acc: 0.9438
loss: 0.1892, acc: 0.9430
loss: 0.1879, acc: 0.9434
loss: 0.1902, acc: 0.9420
loss: 0.1894, acc: 0.9424
loss: 0.1875, acc: 0.9435
loss: 0.1888, acc: 0.9432
loss: 0.1895, acc: 0.9426
loss: 0.1901, acc: 0.9427
> val_acc: 0.7446, val_f1: 0.6072
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.1142, acc: 0.9688
loss: 0.1384, acc: 0.9688
loss: 0.1688, acc: 0.9460
loss: 0.1848, acc: 0.9395
loss: 0.1823, acc: 0.9435
loss: 0.1830, acc: 0.9387
loss: 0.1767, acc: 0.9415
loss: 0.1805, acc: 0.9418
loss: 0.1742, acc: 0.9451
loss: 0.1741, acc: 0.9436
loss: 0.1710, acc: 0.9455
loss: 0.1722, acc: 0.9448
loss: 0.1729, acc: 0.9462
loss: 0.1752, acc: 0.9465
loss: 0.1761, acc: 0.9472
loss: 0.1734, acc: 0.9474
loss: 0.1729, acc: 0.9471
loss: 0.1728, acc: 0.9477
loss: 0.1707, acc: 0.9485
loss: 0.1683, acc: 0.9502
loss: 0.1671, acc: 0.9508
loss: 0.1677, acc: 0.9508
loss: 0.1674, acc: 0.9505
> val_acc: 0.7518, val_f1: 0.6107
>> saved: state_dict/gc_ian_restaurant_val_acc0.7518
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.1427, acc: 0.9688
loss: 0.1461, acc: 0.9648
loss: 0.1381, acc: 0.9663
loss: 0.1511, acc: 0.9601
loss: 0.1452, acc: 0.9592
loss: 0.1471, acc: 0.9621
loss: 0.1493, acc: 0.9583
loss: 0.1436, acc: 0.9605
loss: 0.1437, acc: 0.9615
loss: 0.1391, acc: 0.9635
loss: 0.1400, acc: 0.9629
loss: 0.1388, acc: 0.9634
loss: 0.1381, acc: 0.9638
loss: 0.1392, acc: 0.9628
loss: 0.1392, acc: 0.9632
loss: 0.1405, acc: 0.9627
loss: 0.1434, acc: 0.9616
loss: 0.1434, acc: 0.9602
loss: 0.1460, acc: 0.9587
loss: 0.1480, acc: 0.9570
loss: 0.1485, acc: 0.9560
loss: 0.1482, acc: 0.9557
loss: 0.1485, acc: 0.9557
> val_acc: 0.7402, val_f1: 0.5740
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.1221, acc: 0.9688
loss: 0.1050, acc: 0.9750
loss: 0.1115, acc: 0.9750
loss: 0.1143, acc: 0.9734
loss: 0.1154, acc: 0.9712
loss: 0.1254, acc: 0.9677
loss: 0.1241, acc: 0.9679
loss: 0.1292, acc: 0.9648
loss: 0.1332, acc: 0.9632
loss: 0.1342, acc: 0.9625
loss: 0.1287, acc: 0.9648
loss: 0.1280, acc: 0.9646
loss: 0.1269, acc: 0.9649
loss: 0.1264, acc: 0.9647
loss: 0.1259, acc: 0.9650
loss: 0.1272, acc: 0.9637
loss: 0.1305, acc: 0.9632
loss: 0.1299, acc: 0.9625
loss: 0.1304, acc: 0.9622
loss: 0.1290, acc: 0.9631
loss: 0.1286, acc: 0.9637
loss: 0.1301, acc: 0.9636
> val_acc: 0.7482, val_f1: 0.6112
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.1259, acc: 0.9688
loss: 0.1129, acc: 0.9732
loss: 0.1193, acc: 0.9688
loss: 0.1130, acc: 0.9743
loss: 0.1090, acc: 0.9773
loss: 0.1202, acc: 0.9699
loss: 0.1193, acc: 0.9688
loss: 0.1155, acc: 0.9704
loss: 0.1153, acc: 0.9702
loss: 0.1130, acc: 0.9707
loss: 0.1117, acc: 0.9724
loss: 0.1087, acc: 0.9737
loss: 0.1093, acc: 0.9733
loss: 0.1121, acc: 0.9720
loss: 0.1141, acc: 0.9714
loss: 0.1129, acc: 0.9716
loss: 0.1111, acc: 0.9722
loss: 0.1111, acc: 0.9723
loss: 0.1117, acc: 0.9721
loss: 0.1140, acc: 0.9716
loss: 0.1134, acc: 0.9718
loss: 0.1127, acc: 0.9723
loss: 0.1143, acc: 0.9713
> val_acc: 0.7429, val_f1: 0.6053
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.1291, acc: 0.9609
loss: 0.1168, acc: 0.9618
loss: 0.1165, acc: 0.9688
loss: 0.1197, acc: 0.9655
loss: 0.1124, acc: 0.9701
loss: 0.1124, acc: 0.9688
loss: 0.1093, acc: 0.9715
loss: 0.1093, acc: 0.9736
loss: 0.1078, acc: 0.9730
loss: 0.1087, acc: 0.9739
loss: 0.1095, acc: 0.9734
loss: 0.1098, acc: 0.9730
loss: 0.1093, acc: 0.9722
loss: 0.1092, acc: 0.9719
loss: 0.1093, acc: 0.9721
loss: 0.1085, acc: 0.9727
loss: 0.1067, acc: 0.9725
loss: 0.1070, acc: 0.9730
loss: 0.1080, acc: 0.9717
loss: 0.1067, acc: 0.9722
loss: 0.1054, acc: 0.9727
loss: 0.1063, acc: 0.9722
> val_acc: 0.7446, val_f1: 0.5989
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.0746, acc: 1.0000
loss: 0.0959, acc: 0.9844
loss: 0.0890, acc: 0.9858
loss: 0.0951, acc: 0.9805
loss: 0.0979, acc: 0.9777
loss: 0.0912, acc: 0.9796
loss: 0.0877, acc: 0.9808
loss: 0.0901, acc: 0.9774
loss: 0.0893, acc: 0.9794
loss: 0.0870, acc: 0.9810
loss: 0.0868, acc: 0.9816
loss: 0.0864, acc: 0.9816
loss: 0.0864, acc: 0.9821
loss: 0.0861, acc: 0.9815
loss: 0.0894, acc: 0.9811
loss: 0.0921, acc: 0.9794
loss: 0.0920, acc: 0.9799
loss: 0.0945, acc: 0.9789
loss: 0.0927, acc: 0.9801
loss: 0.0926, acc: 0.9798
loss: 0.0926, acc: 0.9793
loss: 0.0925, acc: 0.9797
loss: 0.0937, acc: 0.9792
> val_acc: 0.7455, val_f1: 0.5993
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.0634, acc: 0.9896
loss: 0.0995, acc: 0.9648
loss: 0.0912, acc: 0.9712
loss: 0.0840, acc: 0.9757
loss: 0.0810, acc: 0.9783
loss: 0.0837, acc: 0.9788
loss: 0.0821, acc: 0.9811
loss: 0.0833, acc: 0.9819
loss: 0.0850, acc: 0.9811
loss: 0.0831, acc: 0.9811
loss: 0.0882, acc: 0.9800
loss: 0.0874, acc: 0.9795
loss: 0.0882, acc: 0.9802
loss: 0.0885, acc: 0.9798
loss: 0.0875, acc: 0.9807
loss: 0.0900, acc: 0.9792
loss: 0.0924, acc: 0.9782
loss: 0.0936, acc: 0.9787
loss: 0.0922, acc: 0.9795
loss: 0.0915, acc: 0.9796
loss: 0.0943, acc: 0.9782
loss: 0.0939, acc: 0.9783
loss: 0.0934, acc: 0.9781
> val_acc: 0.7455, val_f1: 0.5964
>> test_acc: 0.7518, test_f1: 0.6107
