cuda memory allocated: 8836608
n_trainable_params: 1766003, n_nontrainable_params: 441200
> training arguments:
>>> model_name: gc_ian
>>> model_ver: 3
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x000002223B9476A8>
>>> learning_rate: 0.01
>>> momentum: 0.95
>>> dropout: 0.2
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 100
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> embeddings: d
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 0
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 100
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./embeddings/glove.840B.300d.txt
>>> embedding_matrix_path: gen_data/embeddings/100_restaurant_domain_embedding_matrix.dat
>>> model_class: <class 'models.gc_ian.GC_IAN3'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.0162, acc: 0.5563
loss: 0.9507, acc: 0.6094
loss: 0.9197, acc: 0.6188
loss: 0.9110, acc: 0.6188
loss: 0.9040, acc: 0.6125
loss: 0.9065, acc: 0.6052
loss: 0.9004, acc: 0.6062
loss: 0.8866, acc: 0.6109
loss: 0.8812, acc: 0.6132
loss: 0.8667, acc: 0.6194
loss: 0.8574, acc: 0.6210
loss: 0.8525, acc: 0.6245
loss: 0.8431, acc: 0.6260
loss: 0.8368, acc: 0.6299
loss: 0.8319, acc: 0.6346
loss: 0.8280, acc: 0.6355
loss: 0.8240, acc: 0.6371
loss: 0.8213, acc: 0.6372
loss: 0.8208, acc: 0.6359
loss: 0.8157, acc: 0.6394
loss: 0.8080, acc: 0.6432
loss: 0.8070, acc: 0.6446
> val_acc: 0.6804, val_f1: 0.3735
>> saved: state_dict/gc_ian_restaurant_val_acc0.6804
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.6826, acc: 0.7031
loss: 0.6330, acc: 0.7277
loss: 0.6562, acc: 0.7161
loss: 0.6662, acc: 0.7151
loss: 0.6600, acc: 0.7145
loss: 0.6684, acc: 0.7106
loss: 0.6753, acc: 0.7012
loss: 0.6918, acc: 0.6976
loss: 0.6943, acc: 0.6957
loss: 0.7023, acc: 0.6935
loss: 0.7035, acc: 0.6917
loss: 0.7083, acc: 0.6957
loss: 0.7075, acc: 0.6986
loss: 0.7029, acc: 0.6987
loss: 0.7080, acc: 0.6966
loss: 0.7087, acc: 0.6940
loss: 0.7104, acc: 0.6932
loss: 0.7106, acc: 0.6932
loss: 0.7077, acc: 0.6950
loss: 0.7100, acc: 0.6914
loss: 0.7081, acc: 0.6921
loss: 0.7076, acc: 0.6930
loss: 0.7075, acc: 0.6934
> val_acc: 0.7411, val_f1: 0.5282
>> saved: state_dict/gc_ian_restaurant_val_acc0.7411
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.6694, acc: 0.7344
loss: 0.6640, acc: 0.7361
loss: 0.6939, acc: 0.7031
loss: 0.6912, acc: 0.7007
loss: 0.7056, acc: 0.6966
loss: 0.6944, acc: 0.7015
loss: 0.6898, acc: 0.7013
loss: 0.6881, acc: 0.7027
loss: 0.6950, acc: 0.7003
loss: 0.6968, acc: 0.7003
loss: 0.6947, acc: 0.7008
loss: 0.6888, acc: 0.7055
loss: 0.6815, acc: 0.7100
loss: 0.6811, acc: 0.7097
loss: 0.6860, acc: 0.7069
loss: 0.6892, acc: 0.7057
loss: 0.6910, acc: 0.7065
loss: 0.6952, acc: 0.7037
loss: 0.6982, acc: 0.7035
loss: 0.6938, acc: 0.7058
loss: 0.6907, acc: 0.7073
loss: 0.6840, acc: 0.7110
> val_acc: 0.7527, val_f1: 0.5799
>> saved: state_dict/gc_ian_restaurant_val_acc0.7527
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.8082, acc: 0.6250
loss: 0.6838, acc: 0.7188
loss: 0.6576, acc: 0.7415
loss: 0.6809, acc: 0.7109
loss: 0.7025, acc: 0.6949
loss: 0.7040, acc: 0.6935
loss: 0.7034, acc: 0.6956
loss: 0.6971, acc: 0.6970
loss: 0.6925, acc: 0.7035
loss: 0.6941, acc: 0.7052
loss: 0.6869, acc: 0.7077
loss: 0.6825, acc: 0.7087
loss: 0.6799, acc: 0.7111
loss: 0.6761, acc: 0.7121
loss: 0.6823, acc: 0.7099
loss: 0.6813, acc: 0.7097
loss: 0.6792, acc: 0.7114
loss: 0.6819, acc: 0.7111
loss: 0.6804, acc: 0.7126
loss: 0.6782, acc: 0.7142
loss: 0.6726, acc: 0.7153
loss: 0.6701, acc: 0.7167
loss: 0.6720, acc: 0.7140
> val_acc: 0.7509, val_f1: 0.5600
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.4839, acc: 0.8229
loss: 0.5982, acc: 0.7656
loss: 0.6055, acc: 0.7500
loss: 0.6056, acc: 0.7431
loss: 0.6121, acc: 0.7500
loss: 0.6276, acc: 0.7433
loss: 0.6524, acc: 0.7358
loss: 0.6556, acc: 0.7368
loss: 0.6475, acc: 0.7340
loss: 0.6509, acc: 0.7298
loss: 0.6609, acc: 0.7246
loss: 0.6698, acc: 0.7220
loss: 0.6715, acc: 0.7197
loss: 0.6737, acc: 0.7197
cuda memory allocated: 19891200
n_trainable_params: 3206003, n_nontrainable_params: 1764800
> training arguments:
>>> model_name: gc_ian
>>> model_ver: 3
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x000002ECC4C576A8>
>>> learning_rate: 0.01
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 400
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> embeddings: gd
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 0
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 100
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./embeddings/glove.840B.300d.txt
>>> embedding_matrix_path: gen_data/embeddings/400_restaurant_glove_domain_embedding_matrix.dat
>>> model_class: <class 'models.gc_ian.GC_IAN3'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.1009, acc: 0.5813
loss: 0.9996, acc: 0.6000
loss: 0.9780, acc: 0.5917
loss: 0.9536, acc: 0.5953
loss: 0.9408, acc: 0.6012
loss: 0.9093, acc: 0.6104
loss: 0.9098, acc: 0.6000
loss: 0.8951, acc: 0.6062
loss: 0.8855, acc: 0.6049
loss: 0.8722, acc: 0.6144
loss: 0.8608, acc: 0.6216
loss: 0.8607, acc: 0.6193
loss: 0.8577, acc: 0.6197
loss: 0.8481, acc: 0.6237
loss: 0.8406, acc: 0.6271
cuda memory allocated: 8836608
loss: 0.8348, acc: 0.6309
n_trainable_params: 1766003, n_nontrainable_params: 441200
> training arguments:
>>> model_name: gc_ian
>>> model_ver: 3
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adagrad.Adagrad'>
>>> initializer: <function xavier_uniform_ at 0x00000226BCAA76A8>
>>> learning_rate: 0.01
>>> momentum: 0.95
>>> dropout: 0.5
>>> l2reg: 5e-05
>>> num_epoch: 30
>>> batch_size: 32
>>> log_step: 5
>>> embed_dim: 100
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> embeddings: d
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: 0
>>> valset_ratio: 0
>>> num_layers: 1
>>> in_channels: 100
>>> out_channels: 1
>>> downbot: 20
>>> kernel_size: 3
>>> glove_path: ./embeddings/glove.840B.300d.txt
>>> embedding_matrix_path: gen_data/embeddings/100_restaurant_domain_embedding_matrix.dat
>>> model_class: <class 'models.gc_ian.GC_IAN3'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_raw_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 0.8278, acc: 0.6371
loss: 0.8187, acc: 0.6413
loss: 0.8120, acc: 0.6451
loss: 0.8107, acc: 0.6462
loss: 0.8071, acc: 0.6479
loss: 0.8020, acc: 0.6491
loss: 1.0160, acc: 0.5563
loss: 0.9533, acc: 0.5938
loss: 0.9289, acc: 0.6083
loss: 0.9222, acc: 0.6156
loss: 0.9186, acc: 0.6100
> val_acc: 0.7312, val_f1: 0.5075
>> saved: state_dict/gc_ian_restaurant_val_acc0.7312
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.7050, acc: 0.7188
loss: 0.9202, acc: 0.6000
loss: 0.9149, acc: 0.6009
loss: 0.7654, acc: 0.6696
loss: 0.9017, acc: 0.6062
loss: 0.8974, acc: 0.6097
loss: 0.7613, acc: 0.6823
loss: 0.8830, acc: 0.6169
loss: 0.7152, acc: 0.7004
loss: 0.8742, acc: 0.6188
loss: 0.8694, acc: 0.6198
loss: 0.6969, acc: 0.7074
loss: 0.8597, acc: 0.6226
loss: 0.6945, acc: 0.7153
loss: 0.8536, acc: 0.6246
loss: 0.8494, acc: 0.6292
loss: 0.6797, acc: 0.7178
loss: 0.8463, acc: 0.6289
loss: 0.6907, acc: 0.7145
loss: 0.8427, acc: 0.6301
loss: 0.6895, acc: 0.7158
loss: 0.8403, acc: 0.6299
loss: 0.8397, acc: 0.6280
loss: 0.6944, acc: 0.7101
loss: 0.8347, acc: 0.6316
loss: 0.6949, acc: 0.7079
loss: 0.8284, acc: 0.6336
loss: 0.8268, acc: 0.6369
loss: 0.6926, acc: 0.7078
loss: 0.6930, acc: 0.7061
loss: 0.6928, acc: 0.7062
> val_acc: 0.6723, val_f1: 0.3449
>> saved: state_dict/gc_ian_restaurant_val_acc0.6723
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.6947, acc: 0.7027
loss: 0.6964, acc: 0.7031
loss: 0.6518, acc: 0.7054
loss: 0.6900, acc: 0.7050
loss: 0.6702, acc: 0.6979
loss: 0.6887, acc: 0.7054
loss: 0.6850, acc: 0.6967
loss: 0.6785, acc: 0.7003
loss: 0.6839, acc: 0.7076
loss: 0.6873, acc: 0.6968
loss: 0.6873, acc: 0.7065
loss: 0.6931, acc: 0.6885
loss: 0.7106, acc: 0.6824
loss: 0.6864, acc: 0.7088
loss: 0.7134, acc: 0.6801
loss: 0.6851, acc: 0.7080
loss: 0.7202, acc: 0.6802
loss: 0.7214, acc: 0.6815
loss: 0.6827, acc: 0.7091
loss: 0.7264, acc: 0.6837
loss: 0.6836, acc: 0.7090
loss: 0.7252, acc: 0.6865
loss: 0.7210, acc: 0.6870
loss: 0.7260, acc: 0.6827
loss: 0.7268, acc: 0.6798
loss: 0.7284, acc: 0.6787
> val_acc: 0.7580, val_f1: 0.5922
>> saved: state_dict/gc_ian_restaurant_val_acc0.758
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.7293, acc: 0.6789
loss: 0.6466, acc: 0.7422
loss: 0.7264, acc: 0.6810
loss: 0.7288, acc: 0.6782
loss: 0.6012, acc: 0.7465
loss: 0.7268, acc: 0.6792
loss: 0.6407, acc: 0.7299
loss: 0.7261, acc: 0.6805
loss: 0.6251, acc: 0.7401
loss: 0.7257, acc: 0.6811
loss: 0.6465, acc: 0.7318
loss: 0.6531, acc: 0.7252
> val_acc: 0.7348, val_f1: 0.5103
>> saved: state_dict/gc_ian_restaurant_val_acc0.7348
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.6921, acc: 0.7031
loss: 0.6418, acc: 0.7307
loss: 0.6796, acc: 0.7326
loss: 0.6443, acc: 0.7340
loss: 0.7108, acc: 0.6942
loss: 0.7082, acc: 0.6941
loss: 0.6529, acc: 0.7330
loss: 0.7220, acc: 0.6927
loss: 0.7116, acc: 0.6961
loss: 0.6495, acc: 0.7372
loss: 0.7082, acc: 0.6939
loss: 0.6494, acc: 0.7361
loss: 0.7063, acc: 0.6939
loss: 0.7110, acc: 0.6918
loss: 0.6502, acc: 0.7368
loss: 0.7113, acc: 0.6913
loss: 0.6530, acc: 0.7344
loss: 0.7082, acc: 0.6927
loss: 0.7027, acc: 0.6970
loss: 0.6521, acc: 0.7378
loss: 0.6958, acc: 0.7002
loss: 0.6549, acc: 0.7344
loss: 0.6964, acc: 0.6997
loss: 0.7002, acc: 0.6976
loss: 0.6547, acc: 0.7346
loss: 0.7037, acc: 0.6974
loss: 0.6513, acc: 0.7344
loss: 0.7046, acc: 0.6975
loss: 0.7087, acc: 0.6942
loss: 0.6521, acc: 0.7321
loss: 0.7120, acc: 0.6935
loss: 0.6471, acc: 0.7344
loss: 0.7079, acc: 0.6963
loss: 0.7053, acc: 0.6977
loss: 0.6455, acc: 0.7342
loss: 0.6988, acc: 0.7013
loss: 0.6434, acc: 0.7359
loss: 0.6467, acc: 0.7325
> val_acc: 0.7402, val_f1: 0.5452
>> saved: state_dict/gc_ian_restaurant_val_acc0.7402
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.8265, acc: 0.6250
loss: 0.6950, acc: 0.7083
loss: 0.6682, acc: 0.7159
loss: 0.6934, acc: 0.6934
> val_acc: 0.7589, val_f1: 0.5913
>> saved: state_dict/gc_ian_restaurant_val_acc0.7589
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.6789, acc: 0.7500
loss: 0.7149, acc: 0.6845
loss: 0.7162, acc: 0.6803
loss: 0.6413, acc: 0.7500
loss: 0.7156, acc: 0.6794
loss: 0.6231, acc: 0.7415
loss: 0.7098, acc: 0.6832
loss: 0.7061, acc: 0.6890
loss: 0.6368, acc: 0.7324
loss: 0.7074, acc: 0.6923
loss: 0.6401, acc: 0.7307
loss: 0.6994, acc: 0.6955
loss: 0.6948, acc: 0.6981
loss: 0.6388, acc: 0.7224
loss: 0.6928, acc: 0.6983
loss: 0.6451, acc: 0.7157
loss: 0.6888, acc: 0.7003
loss: 0.6348, acc: 0.7248
loss: 0.6946, acc: 0.6989
loss: 0.6936, acc: 0.6986
loss: 0.6374, acc: 0.7271
loss: 0.6918, acc: 0.6991
loss: 0.6939, acc: 0.6977
loss: 0.6369, acc: 0.7249
loss: 0.6924, acc: 0.6999
loss: 0.6351, acc: 0.7255
loss: 0.6898, acc: 0.7028
loss: 0.6848, acc: 0.7033
loss: 0.6350, acc: 0.7277
loss: 0.6823, acc: 0.7049
loss: 0.6358, acc: 0.7321
loss: 0.6839, acc: 0.7038
loss: 0.6319, acc: 0.7353
loss: 0.6377, acc: 0.7337
> val_acc: 0.7464, val_f1: 0.5424
>> saved: state_dict/gc_ian_restaurant_val_acc0.7464
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.5047, acc: 0.8333
loss: 0.6356, acc: 0.7356
loss: 0.6062, acc: 0.7617
loss: 0.6331, acc: 0.7361
loss: 0.6180, acc: 0.7500
loss: 0.6152, acc: 0.7483
loss: 0.6334, acc: 0.7340
loss: 0.6226, acc: 0.7418
loss: 0.6326, acc: 0.7349
loss: 0.6371, acc: 0.7333
loss: 0.6293, acc: 0.7370
loss: 0.6634, acc: 0.7216
loss: 0.6684, acc: 0.7229
loss: 0.6305, acc: 0.7364
loss: 0.6609, acc: 0.7202
loss: 0.6274, acc: 0.7391
loss: 0.6640, acc: 0.7161
loss: 0.6738, acc: 0.7099
loss: 0.6297, acc: 0.7387
loss: 0.6822, acc: 0.7091
loss: 0.6848, acc: 0.7068
loss: 0.6873, acc: 0.7086
loss: 0.6878, acc: 0.7089
> val_acc: 0.7607, val_f1: 0.5873
>> saved: state_dict/gc_ian_restaurant_val_acc0.7607
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.6866, acc: 0.7079
loss: 0.6463, acc: 0.7083
loss: 0.6826, acc: 0.7108
loss: 0.6831, acc: 0.7113
loss: 0.5908, acc: 0.7188
loss: 0.6846, acc: 0.7093
loss: 0.5974, acc: 0.7139
loss: 0.6864, acc: 0.7066
loss: 0.6819, acc: 0.7078
loss: 0.6025, acc: 0.7240
loss: 0.6803, acc: 0.7083
loss: 0.5866, acc: 0.7364
loss: 0.6788, acc: 0.7084
loss: 0.6065, acc: 0.7232
loss: 0.6092, acc: 0.7235
> val_acc: 0.7589, val_f1: 0.5844
>> saved: state_dict/gc_ian_restaurant_val_acc0.7589
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.7046, acc: 0.7125
loss: 0.6034, acc: 0.7327
loss: 0.6769, acc: 0.7250
loss: 0.5960, acc: 0.7376
loss: 0.6617, acc: 0.7333
loss: 0.6669, acc: 0.7219
loss: 0.5890, acc: 0.7448
loss: 0.6644, acc: 0.7188
loss: 0.5892, acc: 0.7465
loss: 0.6678, acc: 0.7219
loss: 0.6759, acc: 0.7188
loss: 0.5968, acc: 0.7425
loss: 0.6756, acc: 0.7180
loss: 0.6014, acc: 0.7426
loss: 0.6756, acc: 0.7167
loss: 0.6004, acc: 0.7436
loss: 0.6819, acc: 0.7156
loss: 0.6791, acc: 0.7142
loss: 0.6060, acc: 0.7432
loss: 0.6862, acc: 0.7089
loss: 0.6099, acc: 0.7408
loss: 0.6925, acc: 0.7058
loss: 0.6874, acc: 0.7076
loss: 0.6076, acc: 0.7425
loss: 0.6821, acc: 0.7092
loss: 0.6080, acc: 0.7429
loss: 0.6845, acc: 0.7047
loss: 0.6067, acc: 0.7426
loss: 0.6821, acc: 0.7063
loss: 0.6834, acc: 0.7052
loss: 0.6108, acc: 0.7408
loss: 0.6788, acc: 0.7066
loss: 0.6126, acc: 0.7391
loss: 0.6733, acc: 0.7103
loss: 0.6732, acc: 0.7122
loss: 0.6113, acc: 0.7399
loss: 0.6705, acc: 0.7142
loss: 0.6100, acc: 0.7411
> val_acc: 0.7509, val_f1: 0.5674
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.7507, acc: 0.6562
> val_acc: 0.7598, val_f1: 0.5867
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.6439, acc: 0.7143
loss: 0.4659, acc: 0.8187
loss: 0.6649, acc: 0.7161
loss: 0.6522, acc: 0.7206
loss: 0.5196, acc: 0.7906
loss: 0.6476, acc: 0.7287
loss: 0.6533, acc: 0.7280
loss: 0.5474, acc: 0.7729
loss: 0.6588, acc: 0.7236
loss: 0.5773, acc: 0.7531
loss: 0.6685, acc: 0.7179
loss: 0.5854, acc: 0.7512
loss: 0.6580, acc: 0.7217
loss: 0.6583, acc: 0.7227
loss: 0.5968, acc: 0.7438
loss: 0.6545, acc: 0.7260
loss: 0.5929, acc: 0.7482
loss: 0.6529, acc: 0.7275
loss: 0.6567, acc: 0.7243
loss: 0.5939, acc: 0.7531
loss: 0.6591, acc: 0.7234
loss: 0.5933, acc: 0.7542
loss: 0.6576, acc: 0.7231
loss: 0.6613, acc: 0.7232
loss: 0.5983, acc: 0.7475
loss: 0.6635, acc: 0.7229
loss: 0.6049, acc: 0.7432
loss: 0.6664, acc: 0.7205
loss: 0.6662, acc: 0.7208
loss: 0.6066, acc: 0.7406
loss: 0.6655, acc: 0.7204
loss: 0.5973, acc: 0.7476
loss: 0.6668, acc: 0.7184
loss: 0.5949, acc: 0.7478
loss: 0.6667, acc: 0.7196
loss: 0.6643, acc: 0.7204
loss: 0.5920, acc: 0.7504
loss: 0.5948, acc: 0.7496
> val_acc: 0.7509, val_f1: 0.5740
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.5989, acc: 0.7489
loss: 0.7142, acc: 0.6797
loss: 0.5991, acc: 0.7490
loss: 0.6852, acc: 0.7014
loss: 0.6813, acc: 0.7165
loss: 0.5995, acc: 0.7490
loss: 0.6682, acc: 0.7270
loss: 0.6585, acc: 0.7344
loss: 0.5957, acc: 0.7512
loss: 0.6557, acc: 0.7371
loss: 0.5946, acc: 0.7518
loss: 0.6724, acc: 0.7261
loss: 0.5914, acc: 0.7528
loss: 0.6785, acc: 0.7196
loss: 0.6819, acc: 0.7131
loss: 0.6785, acc: 0.7143
loss: 0.6677, acc: 0.7216
loss: 0.6744, acc: 0.7193
loss: 0.6716, acc: 0.7212
> val_acc: 0.7679, val_f1: 0.6161
>> saved: state_dict/gc_ian_restaurant_val_acc0.7679
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.6704, acc: 0.7215
loss: 0.5086, acc: 0.7500
loss: 0.6755, acc: 0.7183
loss: 0.5197, acc: 0.7768
loss: 0.6755, acc: 0.7172
loss: 0.5925, acc: 0.7552
loss: 0.6750, acc: 0.7154
loss: 0.6740, acc: 0.7163
loss: 0.5867, acc: 0.7537
loss: 0.6687, acc: 0.7194
loss: 0.5862, acc: 0.7599
loss: 0.6656, acc: 0.7197
loss: 0.6660, acc: 0.7197
loss: 0.5839, acc: 0.7650
loss: 0.6643, acc: 0.7208
loss: 0.5933, acc: 0.7559
loss: 0.5943, acc: 0.7525
> val_acc: 0.7580, val_f1: 0.5900
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.6015, acc: 0.7448
loss: 0.8647, acc: 0.6875
loss: 0.6313, acc: 0.7552
loss: 0.6084, acc: 0.7400
loss: 0.6531, acc: 0.7415
loss: 0.5986, acc: 0.7446
loss: 0.6492, acc: 0.7324
loss: 0.6403, acc: 0.7321
loss: 0.5903, acc: 0.7505
loss: 0.6521, acc: 0.7296
loss: 0.5938, acc: 0.7500
loss: 0.6595, acc: 0.7218
loss: 0.6579, acc: 0.7240
loss: 0.5905, acc: 0.7537
loss: 0.6710, acc: 0.7195
loss: 0.5871, acc: 0.7561
loss: 0.6648, acc: 0.7255
loss: 0.6690, acc: 0.7249
loss: 0.5850, acc: 0.7573
loss: 0.6761, acc: 0.7221
loss: 0.5837, acc: 0.7588
loss: 0.6751, acc: 0.7213
loss: 0.6731, acc: 0.7240
loss: 0.5827, acc: 0.7615
loss: 0.6674, acc: 0.7280
loss: 0.5851, acc: 0.7588
loss: 0.6625, acc: 0.7278
loss: 0.6614, acc: 0.7269
loss: 0.5870, acc: 0.7568
loss: 0.6643, acc: 0.7253
loss: 0.5830, acc: 0.7577
loss: 0.6629, acc: 0.7239
loss: 0.5831, acc: 0.7561
loss: 0.6610, acc: 0.7253
loss: 0.6610, acc: 0.7280
loss: 0.5842, acc: 0.7553
loss: 0.6594, acc: 0.7276
loss: 0.6584, acc: 0.7269
> val_acc: 0.7589, val_f1: 0.5840
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
> val_acc: 0.7580, val_f1: 0.5845
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.6500, acc: 0.7188
loss: 0.5704, acc: 0.7500
loss: 0.6245, acc: 0.7383
loss: 0.5923, acc: 0.7396
loss: 0.6286, acc: 0.7500
loss: 0.5824, acc: 0.7500
loss: 0.6409, acc: 0.7361
loss: 0.6439, acc: 0.7378
loss: 0.5597, acc: 0.7697
loss: 0.6422, acc: 0.7366
loss: 0.5660, acc: 0.7682
loss: 0.6343, acc: 0.7396
loss: 0.6473, acc: 0.7360
loss: 0.5815, acc: 0.7586
loss: 0.6508, acc: 0.7355
loss: 0.5842, acc: 0.7537
loss: 0.6554, acc: 0.7311
loss: 0.6541, acc: 0.7317
loss: 0.5872, acc: 0.7524
loss: 0.6606, acc: 0.7284
loss: 0.5908, acc: 0.7528
loss: 0.6586, acc: 0.7292
loss: 0.6586, acc: 0.7298
loss: 0.5803, acc: 0.7602
loss: 0.6581, acc: 0.7286
loss: 0.5794, acc: 0.7616
loss: 0.6575, acc: 0.7296
loss: 0.5818, acc: 0.7585
loss: 0.6483, acc: 0.7349
loss: 0.6516, acc: 0.7312
loss: 0.5794, acc: 0.7612
loss: 0.6518, acc: 0.7288
loss: 0.5762, acc: 0.7604
loss: 0.6514, acc: 0.7277
loss: 0.6511, acc: 0.7285
loss: 0.5764, acc: 0.7606
loss: 0.6538, acc: 0.7266
loss: 0.6544, acc: 0.7281
loss: 0.5743, acc: 0.7627
loss: 0.5747, acc: 0.7630
> val_acc: 0.7616, val_f1: 0.5950
>> saved: state_dict/gc_ian_restaurant_val_acc0.7616
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.5745, acc: 0.7637
loss: 0.6377, acc: 0.7438
loss: 0.5716, acc: 0.7663
loss: 0.6352, acc: 0.7469
loss: 0.5725, acc: 0.7658
loss: 0.6182, acc: 0.7542
loss: 0.6471, acc: 0.7391
loss: 0.5676, acc: 0.7683
loss: 0.6616, acc: 0.7325
loss: 0.5657, acc: 0.7683
loss: 0.6631, acc: 0.7365
loss: 0.6568, acc: 0.7321
loss: 0.6560, acc: 0.7312
loss: 0.6481, acc: 0.7354
loss: 0.6451, acc: 0.7375
> val_acc: 0.7723, val_f1: 0.6383
>> saved: state_dict/gc_ian_restaurant_val_acc0.7723
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.4723, acc: 0.7812
loss: 0.6473, acc: 0.7398
loss: 0.6453, acc: 0.7401
loss: 0.5537, acc: 0.7448
loss: 0.6464, acc: 0.7399
loss: 0.5369, acc: 0.7699
loss: 0.6471, acc: 0.7371
loss: 0.6453, acc: 0.7371
loss: 0.5287, acc: 0.7734
loss: 0.6446, acc: 0.7383
loss: 0.5307, acc: 0.7857
loss: 0.6464, acc: 0.7364
loss: 0.6492, acc: 0.7344
loss: 0.5360, acc: 0.7873
loss: 0.6485, acc: 0.7355
loss: 0.5425, acc: 0.7843
loss: 0.6500, acc: 0.7359
loss: 0.6527, acc: 0.7330
loss: 0.5414, acc: 0.7839
loss: 0.6523, acc: 0.7338
loss: 0.5510, acc: 0.7774
loss: 0.5521, acc: 0.7738
loss: 0.5515, acc: 0.7727
> val_acc: 0.7643, val_f1: 0.6073
>> saved: state_dict/gc_ian_restaurant_val_acc0.7643
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.5211, acc: 0.8125
loss: 0.5499, acc: 0.7723
loss: 0.5433, acc: 0.7812
loss: 0.5475, acc: 0.7746
loss: 0.5552, acc: 0.7682
loss: 0.6048, acc: 0.7482
loss: 0.5471, acc: 0.7732
loss: 0.6211, acc: 0.7429
loss: 0.5554, acc: 0.7694
loss: 0.6245, acc: 0.7350
loss: 0.6373, acc: 0.7275
loss: 0.5595, acc: 0.7681
loss: 0.6406, acc: 0.7238
loss: 0.5614, acc: 0.7670
loss: 0.6265, acc: 0.7336
loss: 0.6355, acc: 0.7334
loss: 0.5601, acc: 0.7703
loss: 0.6461, acc: 0.7236
loss: 0.5615, acc: 0.7706
loss: 0.6453, acc: 0.7237
loss: 0.6410, acc: 0.7268
loss: 0.5617, acc: 0.7718
loss: 0.6396, acc: 0.7271
loss: 0.6414, acc: 0.7270
loss: 0.5644, acc: 0.7701
loss: 0.6428, acc: 0.7297
loss: 0.5605, acc: 0.7718
loss: 0.6410, acc: 0.7302
loss: 0.6386, acc: 0.7317
loss: 0.5631, acc: 0.7677
loss: 0.6382, acc: 0.7323
loss: 0.6412, acc: 0.7297
loss: 0.6460, acc: 0.7261
loss: 0.6475, acc: 0.7249
> val_acc: 0.7723, val_f1: 0.6200
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.6468, acc: 0.7280
loss: 0.5529, acc: 0.7917
loss: 0.5852, acc: 0.7852
loss: 0.5504, acc: 0.7885
> val_acc: 0.7634, val_f1: 0.6032
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.8332, acc: 0.6328
loss: 0.5572, acc: 0.7778
loss: 0.7301, acc: 0.7049
loss: 0.5604, acc: 0.7731
loss: 0.6927, acc: 0.7277
loss: 0.6555, acc: 0.7500
loss: 0.5501, acc: 0.7790
loss: 0.6587, acc: 0.7474
loss: 0.5512, acc: 0.7746
loss: 0.6533, acc: 0.7478
loss: 0.6634, acc: 0.7362
loss: 0.5514, acc: 0.7714
loss: 0.6766, acc: 0.7348
loss: 0.5438, acc: 0.7747
loss: 0.6682, acc: 0.7372
loss: 0.6656, acc: 0.7360
loss: 0.5433, acc: 0.7728
loss: 0.6670, acc: 0.7321
loss: 0.5480, acc: 0.7700
loss: 0.6664, acc: 0.7309
loss: 0.6715, acc: 0.7280
loss: 0.5477, acc: 0.7705
loss: 0.6664, acc: 0.7301
loss: 0.5470, acc: 0.7728
loss: 0.6682, acc: 0.7297
loss: 0.6644, acc: 0.7298
loss: 0.5470, acc: 0.7716
loss: 0.6603, acc: 0.7344
loss: 0.5470, acc: 0.7723
loss: 0.6564, acc: 0.7331
loss: 0.6520, acc: 0.7340
loss: 0.5530, acc: 0.7680
loss: 0.6507, acc: 0.7339
loss: 0.5519, acc: 0.7703
loss: 0.6500, acc: 0.7332
loss: 0.6497, acc: 0.7322
loss: 0.5497, acc: 0.7717
loss: 0.5481, acc: 0.7735
loss: 0.5487, acc: 0.7720
> val_acc: 0.7571, val_f1: 0.5952
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 13
loss: 0.5456, acc: 0.7812
loss: 0.5518, acc: 0.7697
loss: 0.6039, acc: 0.7656
loss: 0.5530, acc: 0.7714
loss: 0.6318, acc: 0.7386
loss: 0.6482, acc: 0.7266
loss: 0.5547, acc: 0.7708
loss: 0.6500, acc: 0.7336
loss: 0.6411, acc: 0.7392
loss: 0.6377, acc: 0.7369
loss: 0.6458, acc: 0.7300
> val_acc: 0.7670, val_f1: 0.6019
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 10
loss: 0.6423, acc: 0.7332
loss: 0.6422, acc: 0.7330
loss: 0.4957, acc: 0.7812
loss: 0.6395, acc: 0.7347
loss: 0.5139, acc: 0.7750
loss: 0.6401, acc: 0.7333
loss: 0.6345, acc: 0.7382
loss: 0.5207, acc: 0.7750
loss: 0.6396, acc: 0.7363
loss: 0.5215, acc: 0.7781
loss: 0.6348, acc: 0.7372
loss: 0.5139, acc: 0.7863
loss: 0.6323, acc: 0.7360
loss: 0.6310, acc: 0.7361
loss: 0.5046, acc: 0.7896
loss: 0.6278, acc: 0.7387
loss: 0.4980, acc: 0.7937
loss: 0.6290, acc: 0.7387
loss: 0.6302, acc: 0.7386
loss: 0.5081, acc: 0.7898
loss: 0.6384, acc: 0.7339
loss: 0.5153, acc: 0.7854
loss: 0.6436, acc: 0.7317
loss: 0.6447, acc: 0.7320
loss: 0.5199, acc: 0.7831
loss: 0.5186, acc: 0.7835
> val_acc: 0.7705, val_f1: 0.6192
>> saved: state_dict/gc_ian_restaurant_val_acc0.7705
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 14
loss: 0.5261, acc: 0.7786
loss: 0.5370, acc: 0.7708
loss: 0.5938, acc: 0.7422
loss: 0.5296, acc: 0.7779
loss: 0.6201, acc: 0.7404
loss: 0.5268, acc: 0.7799
loss: 0.6386, acc: 0.7309
loss: 0.5237, acc: 0.7817
loss: 0.6422, acc: 0.7283
loss: 0.6443, acc: 0.7243
loss: 0.5287, acc: 0.7789
loss: 0.6426, acc: 0.7244
loss: 0.6460, acc: 0.7262
loss: 0.5298, acc: 0.7761
loss: 0.6400, acc: 0.7297
loss: 0.5320, acc: 0.7750
loss: 0.6442, acc: 0.7272
loss: 0.6470, acc: 0.7229
loss: 0.5357, acc: 0.7724
loss: 0.6408, acc: 0.7290
loss: 0.5395, acc: 0.7728
loss: 0.6367, acc: 0.7331
loss: 0.6411, acc: 0.7325
loss: 0.5411, acc: 0.7723
loss: 0.6408, acc: 0.7329
loss: 0.5449, acc: 0.7713
loss: 0.6368, acc: 0.7340
loss: 0.6385, acc: 0.7323
loss: 0.6412, acc: 0.7308
loss: 0.6442, acc: 0.7272
loss: 0.6433, acc: 0.7274
> val_acc: 0.7688, val_f1: 0.6284
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 11
loss: 0.6387, acc: 0.7294
loss: 0.6434, acc: 0.7500
loss: 0.6425, acc: 0.7274
loss: 0.5760, acc: 0.7679
loss: 0.6374, acc: 0.7298
loss: 0.5589, acc: 0.7891
loss: 0.5472, acc: 0.7812
> val_acc: 0.7741, val_f1: 0.6291
>> saved: state_dict/gc_ian_restaurant_val_acc0.7741
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 15
loss: 0.6225, acc: 0.7188
loss: 0.5503, acc: 0.7770
loss: 0.6306, acc: 0.7406
loss: 0.5574, acc: 0.7697
loss: 0.6273, acc: 0.7500
loss: 0.6487, acc: 0.7359
loss: 0.5579, acc: 0.7676
loss: 0.6449, acc: 0.7275
loss: 0.5473, acc: 0.7779
loss: 0.6300, acc: 0.7427
loss: 0.6377, acc: 0.7384
loss: 0.5373, acc: 0.7835
loss: 0.6313, acc: 0.7445
loss: 0.5280, acc: 0.7866
loss: 0.6288, acc: 0.7458
loss: 0.5378, acc: 0.7800
loss: 0.6301, acc: 0.7462
loss: 0.6309, acc: 0.7466
loss: 0.5375, acc: 0.7818
loss: 0.6341, acc: 0.7417
loss: 0.5399, acc: 0.7792
loss: 0.6385, acc: 0.7423
loss: 0.6432, acc: 0.7375
loss: 0.5442, acc: 0.7757
loss: 0.6420, acc: 0.7362
loss: 0.5411, acc: 0.7778
loss: 0.6415, acc: 0.7375
loss: 0.6374, acc: 0.7412
loss: 0.5422, acc: 0.7760
loss: 0.6360, acc: 0.7403
loss: 0.5416, acc: 0.7744
loss: 0.6397, acc: 0.7398
loss: 0.6429, acc: 0.7391
loss: 0.5424, acc: 0.7741
loss: 0.6445, acc: 0.7351
loss: 0.5447, acc: 0.7711
loss: 0.6444, acc: 0.7347
loss: 0.5445, acc: 0.7719
loss: 0.5419, acc: 0.7730
> val_acc: 0.7679, val_f1: 0.6042
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 16
loss: 0.6837, acc: 0.7031
loss: 0.5454, acc: 0.7713
loss: 0.6723, acc: 0.7188
loss: 0.5421, acc: 0.7729
> val_acc: 0.7732, val_f1: 0.6166
>> saved: state_dict/gc_ian_restaurant_val_acc0.7732
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 12
loss: 0.4695, acc: 0.7891
loss: 0.4967, acc: 0.7882
loss: 0.5298, acc: 0.7723
loss: 0.5323, acc: 0.7763
loss: 0.5335, acc: 0.7734
loss: 0.5476, acc: 0.7640
loss: 0.5476, acc: 0.7629
loss: 0.5383, acc: 0.7732
loss: 0.5381, acc: 0.7770
loss: 0.5386, acc: 0.7761
loss: 0.5354, acc: 0.7795
