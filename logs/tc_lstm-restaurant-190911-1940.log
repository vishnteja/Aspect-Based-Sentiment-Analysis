cuda memory allocated: 13962752
n_trainable_params: 2166603, n_nontrainable_params: 1323600
> training arguments:
>>> model_name: tc_lstm
>>> dataset: restaurant
>>> optimizer: <class 'torch.optim.adam.Adam'>
>>> initializer: <function xavier_uniform_ at 0x000001F9624157B8>
>>> learning_rate: 0.001
>>> dropout: 0.1
>>> l2reg: 0.01
>>> num_epoch: 10
>>> batch_size: 64
>>> log_step: 5
>>> embed_dim: 300
>>> hidden_dim: 300
>>> bert_dim: 768
>>> pretrained_bert_name: bert-base-uncased
>>> max_seq_len: 80
>>> polarities_dim: 3
>>> hops: 3
>>> device: cuda
>>> seed: None
>>> valset_ratio: 0
>>> glove_path: ./glove/glove.840B.300d.txt
>>> model_class: <class 'models.tc_lstm.TC_LSTM'>
>>> dataset_file: {'train': './datasets/semeval14/Restaurants_Train.xml.seg', 'test': './datasets/semeval14/Restaurants_Test_Gold.xml.seg'}
>>> inputs_cols: ['text_left_with_aspect_indices', 'text_right_with_aspect_indices', 'aspect_indices']
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 0
loss: 1.1375, acc: 0.4813
loss: 1.0149, acc: 0.5516
loss: 0.9765, acc: 0.5740
loss: 0.9501, acc: 0.5859
loss: 0.9250, acc: 0.6006
loss: 0.9292, acc: 0.5958
loss: 0.9314, acc: 0.5920
loss: 0.9278, acc: 0.5898
loss: 0.9150, acc: 0.5969
loss: 0.9152, acc: 0.5978
loss: 0.9138, acc: 0.5974
> val_acc: 0.6661, val_f1: 0.3619
>> saved: state_dict/tc_lstm_restaurant_val_acc0.6661
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 1
loss: 0.7985, acc: 0.6406
loss: 0.7962, acc: 0.6602
loss: 0.7779, acc: 0.6683
loss: 0.7863, acc: 0.6649
loss: 0.7866, acc: 0.6624
loss: 0.7912, acc: 0.6613
loss: 0.7908, acc: 0.6596
loss: 0.7921, acc: 0.6567
loss: 0.7875, acc: 0.6588
loss: 0.7888, acc: 0.6598
loss: 0.7897, acc: 0.6589
> val_acc: 0.7098, val_f1: 0.4900
>> saved: state_dict/tc_lstm_restaurant_val_acc0.7098
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 2
loss: 0.6476, acc: 0.7031
loss: 0.7176, acc: 0.6823
loss: 0.7322, acc: 0.6761
loss: 0.7174, acc: 0.6904
loss: 0.7384, acc: 0.6815
loss: 0.7313, acc: 0.6887
loss: 0.7338, acc: 0.6895
loss: 0.7319, acc: 0.6866
loss: 0.7265, acc: 0.6890
loss: 0.7270, acc: 0.6899
loss: 0.7202, acc: 0.6906
loss: 0.7265, acc: 0.6900
> val_acc: 0.7384, val_f1: 0.5896
>> saved: state_dict/tc_lstm_restaurant_val_acc0.7384
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 3
loss: 0.7140, acc: 0.7266
loss: 0.7172, acc: 0.7031
loss: 0.7035, acc: 0.7076
loss: 0.7049, acc: 0.7031
loss: 0.7016, acc: 0.7044
loss: 0.7007, acc: 0.7010
loss: 0.6979, acc: 0.7031
loss: 0.6934, acc: 0.7071
loss: 0.6965, acc: 0.7053
loss: 0.6942, acc: 0.7063
loss: 0.6901, acc: 0.7080
> val_acc: 0.7304, val_f1: 0.5785
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 4
loss: 0.6469, acc: 0.7344
loss: 0.7026, acc: 0.7143
loss: 0.6881, acc: 0.7148
loss: 0.6855, acc: 0.7169
loss: 0.6595, acc: 0.7315
loss: 0.6695, acc: 0.7269
loss: 0.6700, acc: 0.7251
loss: 0.6652, acc: 0.7276
loss: 0.6608, acc: 0.7314
loss: 0.6669, acc: 0.7261
loss: 0.6682, acc: 0.7230
loss: 0.6639, acc: 0.7262
> val_acc: 0.7411, val_f1: 0.5895
>> saved: state_dict/tc_lstm_restaurant_val_acc0.7411
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 5
loss: 0.5836, acc: 0.7594
loss: 0.6337, acc: 0.7328
loss: 0.6106, acc: 0.7521
loss: 0.6214, acc: 0.7484
loss: 0.6146, acc: 0.7481
loss: 0.6286, acc: 0.7401
loss: 0.6347, acc: 0.7362
loss: 0.6325, acc: 0.7383
loss: 0.6371, acc: 0.7337
loss: 0.6395, acc: 0.7319
loss: 0.6372, acc: 0.7332
> val_acc: 0.7366, val_f1: 0.6073
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 6
loss: 0.5211, acc: 0.7917
loss: 0.5391, acc: 0.7812
loss: 0.5358, acc: 0.7873
loss: 0.5695, acc: 0.7648
loss: 0.5894, acc: 0.7561
loss: 0.5886, acc: 0.7550
loss: 0.6010, acc: 0.7453
loss: 0.6024, acc: 0.7447
loss: 0.6074, acc: 0.7445
loss: 0.6104, acc: 0.7454
loss: 0.6137, acc: 0.7426
> val_acc: 0.7411, val_f1: 0.6005
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 7
loss: 0.4816, acc: 0.8281
loss: 0.5487, acc: 0.7891
loss: 0.5439, acc: 0.7912
loss: 0.5853, acc: 0.7725
loss: 0.5807, acc: 0.7649
loss: 0.5840, acc: 0.7632
loss: 0.5936, acc: 0.7606
loss: 0.5974, acc: 0.7552
loss: 0.5974, acc: 0.7550
loss: 0.5956, acc: 0.7551
loss: 0.5971, acc: 0.7546
loss: 0.6008, acc: 0.7542
> val_acc: 0.7339, val_f1: 0.6063
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 8
loss: 0.4910, acc: 0.8164
loss: 0.5362, acc: 0.7847
loss: 0.5376, acc: 0.7801
loss: 0.5654, acc: 0.7706
loss: 0.5550, acc: 0.7741
loss: 0.5568, acc: 0.7764
loss: 0.5625, acc: 0.7739
loss: 0.5570, acc: 0.7756
loss: 0.5661, acc: 0.7720
loss: 0.5694, acc: 0.7698
loss: 0.5706, acc: 0.7703
> val_acc: 0.7312, val_f1: 0.5627
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
epoch: 9
loss: 0.4559, acc: 0.7969
loss: 0.5596, acc: 0.7589
loss: 0.5734, acc: 0.7682
loss: 0.5634, acc: 0.7757
loss: 0.5775, acc: 0.7663
loss: 0.5846, acc: 0.7581
loss: 0.5893, acc: 0.7505
loss: 0.5818, acc: 0.7546
loss: 0.5718, acc: 0.7623
loss: 0.5804, acc: 0.7593
loss: 0.5806, acc: 0.7605
loss: 0.5857, acc: 0.7586
> val_acc: 0.7571, val_f1: 0.6198
>> saved: state_dict/tc_lstm_restaurant_val_acc0.7571
>> test_acc: 0.7571, test_f1: 0.6198
